(this.webpackJsonporganice=this.webpackJsonporganice||[]).push([[0],{229:function(e,t,n){e.exports=n.p+"static/media/dropbox.b53eaec4.svg"},230:function(e,t,n){e.exports=n.p+"static/media/google_drive.f5fd3e02.png"},232:function(e,t,n){e.exports=n(477)},237:function(e,t,n){},278:function(e,t){},280:function(e,t){},312:function(e,t){},313:function(e,t){},392:function(e,t,n){},393:function(e,t,n){},394:function(e,t,n){},395:function(e,t,n){},397:function(e,t,n){},398:function(e,t,n){},406:function(e,t,n){},408:function(e,t,n){},409:function(e,t,n){},411:function(e,t,n){},412:function(e,t,n){},413:function(e,t,n){},414:function(e,t,n){},415:function(e,t,n){},416:function(e,t,n){},417:function(e,t,n){},418:function(e,t,n){},419:function(e,t,n){},420:function(e,t,n){},421:function(e,t,n){},422:function(e,t,n){},423:function(e,t,n){},424:function(e,t,n){},425:function(e,t,n){},426:function(e,t,n){},427:function(e,t,n){},428:function(e,t,n){},429:function(e,t,n){},430:function(e,t,n){},465:function(e,t,n){},466:function(e,t,n){},467:function(e,t,n){},468:function(e,t,n){},469:function(e,t,n){},470:function(e,t,n){},471:function(e,t,n){},472:function(e,t,n){},473:function(e,t,n){},474:function(e,t,n){},475:function(e,t,n){},476:function(e,t,n){},477:function(e,t,n){"use strict";n.r(t);var a={};n.r(a),n.d(a,"setLoadingMessage",(function(){return k})),n.d(a,"hideLoadingMessage",(function(){return w})),n.d(a,"setIsLoading",(function(){return I})),n.d(a,"setDisappearingLoadingMessage",(function(){return C})),n.d(a,"setLastViewedFile",(function(){return S})),n.d(a,"loadStaticFile",(function(){return O})),n.d(a,"unloadStaticFile",(function(){return D})),n.d(a,"setFontSize",(function(){return A})),n.d(a,"setBulletStyle",(function(){return N})),n.d(a,"setShouldTapTodoToAdvance",(function(){return P})),n.d(a,"setAgendaDefaultDeadlineDelayUnit",(function(){return L})),n.d(a,"setAgendaDefaultDeadlineDelayValue",(function(){return j})),n.d(a,"setShouldLiveSync",(function(){return M})),n.d(a,"setShouldSyncOnBecomingVisibile",(function(){return R})),n.d(a,"setShouldStoreSettingsInSyncBackend",(function(){return x})),n.d(a,"setHasUnseenChangelog",(function(){return H})),n.d(a,"setLastSeenChangelogHeader",(function(){return F})),n.d(a,"setCustomKeybinding",(function(){return B})),n.d(a,"restoreBaseSettings",(function(){return U})),n.d(a,"pushModalPage",(function(){return V})),n.d(a,"popModalPage",(function(){return W})),n.d(a,"clearModalStack",(function(){return G})),n.d(a,"activatePopup",(function(){return K})),n.d(a,"closePopup",(function(){return z}));var r={};n.r(r),n.d(r,"displayFile",(function(){return We})),n.d(r,"setLastSyncAt",(function(){return Ge})),n.d(r,"stopDisplayingFile",(function(){return Ke})),n.d(r,"sync",(function(){return ze})),n.d(r,"openHeader",(function(){return Ye})),n.d(r,"toggleHeaderOpened",(function(){return Je})),n.d(r,"selectHeader",(function(){return Xe})),n.d(r,"selectHeaderAndOpenParents",(function(){return qe})),n.d(r,"advanceTodoState",(function(){return $e})),n.d(r,"enterEditMode",(function(){return Qe})),n.d(r,"exitEditMode",(function(){return Ze})),n.d(r,"updateHeaderTitle",(function(){return et})),n.d(r,"updateHeaderDescription",(function(){return tt})),n.d(r,"addHeader",(function(){return nt})),n.d(r,"selectNextSiblingHeader",(function(){return at})),n.d(r,"addHeaderAndEdit",(function(){return rt})),n.d(r,"selectNextVisibleHeader",(function(){return it})),n.d(r,"selectPreviousVisibleHeader",(function(){return ot})),n.d(r,"removeHeader",(function(){return st})),n.d(r,"moveHeaderUp",(function(){return ct})),n.d(r,"moveHeaderDown",(function(){return lt})),n.d(r,"moveHeaderLeft",(function(){return ut})),n.d(r,"moveHeaderRight",(function(){return dt})),n.d(r,"moveSubtreeLeft",(function(){return ht})),n.d(r,"moveSubtreeRight",(function(){return pt})),n.d(r,"focusHeader",(function(){return mt})),n.d(r,"unfocusHeader",(function(){return gt})),n.d(r,"applyOpennessState",(function(){return ft})),n.d(r,"setDirty",(function(){return bt})),n.d(r,"setSelectedTableCellId",(function(){return yt})),n.d(r,"addNewTableRow",(function(){return vt})),n.d(r,"removeTableRow",(function(){return Et})),n.d(r,"addNewTableColumn",(function(){return _t})),n.d(r,"removeTableColumn",(function(){return Tt})),n.d(r,"moveTableRowDown",(function(){return kt})),n.d(r,"moveTableRowUp",(function(){return wt})),n.d(r,"moveTableColumnLeft",(function(){return It})),n.d(r,"moveTableColumnRight",(function(){return Ct})),n.d(r,"updateTableCellValue",(function(){return St})),n.d(r,"insertCapture",(function(){return Ot})),n.d(r,"clearPendingCapture",(function(){return Dt})),n.d(r,"insertPendingCapture",(function(){return At})),n.d(r,"advanceCheckboxState",(function(){return Nt})),n.d(r,"setHeaderTags",(function(){return Pt})),n.d(r,"reorderTags",(function(){return Lt})),n.d(r,"reorderPropertyList",(function(){return jt})),n.d(r,"updateTimestampWithId",(function(){return Mt})),n.d(r,"updatePlanningItemTimestamp",(function(){return Rt})),n.d(r,"addNewPlanningItem",(function(){return xt})),n.d(r,"removePlanningItem",(function(){return Ht})),n.d(r,"updatePropertyListItems",(function(){return Ft})),n.d(r,"setOrgFileErrorMessage",(function(){return Bt})),n.d(r,"setLogEntryStop",(function(){return Ut})),n.d(r,"createLogEntryStart",(function(){return Vt})),n.d(r,"updateLogEntryTime",(function(){return Wt}));var i={};n.r(i),n.d(i,"addNewEmptyCaptureTemplate",(function(){return Yt})),n.d(i,"updateTemplateFieldPathValue",(function(){return Jt})),n.d(i,"addNewTemplateOrgFileAvailability",(function(){return Xt})),n.d(i,"removeTemplateOrgFileAvailability",(function(){return qt})),n.d(i,"addNewTemplateHeaderPath",(function(){return $t})),n.d(i,"removeTemplateHeaderPath",(function(){return Qt})),n.d(i,"deleteTemplate",(function(){return Zt})),n.d(i,"restoreCaptureSettings",(function(){return en})),n.d(i,"reorderCaptureTemplate",(function(){return tn}));var o={};n.r(o),n.d(o,"signOut",(function(){return fr})),n.d(o,"setCurrentFileBrowserDirectoryListing",(function(){return br})),n.d(o,"setIsLoadingMoreDirectoryListing",(function(){return yr})),n.d(o,"getDirectoryListing",(function(){return vr})),n.d(o,"loadMoreDirectoryListing",(function(){return Er})),n.d(o,"pushBackup",(function(){return _r})),n.d(o,"downloadFile",(function(){return Tr}));var s=n(0),c=n.n(s),l=n(60),u=n.n(l),d=(n(237),n(4)),h=n(9),p=n(10),m=n(12),g=n(11),f=n(15),b=n(13),y=n(17),v=n(6),E=n(217),_=n(37),T=n.n(_),k=function(e){return{type:"SET_LOADING_MESSAGE",loadingMessage:e}},w=function(){return{type:"HIDE_LOADING_MESSAGE"}},I=function(e){return{type:"SET_IS_LOADING",isLoading:e}},C=function(e,t){return function(n){n(k(e)),setTimeout((function(){return n(w())}),t)}},S=function(e,t){return{type:"SET_LAST_VIEWED_FILE",lastViewedPath:e,lastViewedContents:t}},O=function(e){return function(t,n){t(S(n().org.present.get("path"),n().org.present.get("contents"))),t(We(null,{changelog:"* Changelog\n\nAll notable changes to this project will be documented in this file.\n\n** <2019-12-17 Tue>\n*** Changed\n    - Improve webdav url input\n      - Thank you [[https://github.com/dotcs][dotcs]] for your [[https://github.com/200ok-ch/organice/pull/139][PR]]!\n*** Fixed\n    - Make \"privacy policy\" sticky to the bottom of the landing page\n      - Thank you [[https://github.com/dotcs][dotcs]] for your [[https://github.com/200ok-ch/organice/pull/140][PR]]!\n\n** <2019-12-15 Sun>\n\n*** Changed\n    - UX: Move Org header actions before selected headline\n    - Thank you [[https://github.com/dotcs][dotcs]] for your [[https://github.com/200ok-ch/organice/pull/136][PR]]!\n\n*** Fixed\n    - Android PWA implementation was broken (issue [[https://github.com/200ok-ch/organice/issues/134][#134]])\n      - It required two more icon sizes\n    - Thank you [[https://github.com/dotcs][dotcs]] for your [[https://github.com/200ok-ch/organice/pull/135][PR]]!\n\n** <2019-12-10 Tue>\n\n*** Added\n\n    - *Docker Support*\n    - The CI/CD workflow now also builds a Docker container which is\n      then published to\n      https://hub.docker.com/repository/docker/twohundredok/organice\n    - Thank you [[https://github.com/dotcs][dotcs]] for your [[https://github.com/200ok-ch/organice/pull/133][PR]]!\n\n** <2019-12-08 Sun>\n\n*** Added\n\n    - As a user, when I'm on a headline with a planning item (schedule\n      or deadline), I want to be able to remove it.\n\n** <2019-11-29 Fri>\n\n*** Fixed\n\n    - Clicking the Timestamp in a TODO within the agenda toggles from\n      the date to a human readable timespan\n\n** <2019-11-27 Wed>\n\n*** Added\n\n    - Instructions on configuring Nextcloud+haproxy to allow WebDAV\n    - Documentation on how to share from Nextcloud using WebDAV\n    - Thank you [[https://github.com/runejuhl][runejuhl]] for your [[https://github.com/200ok-ch/organice/pull/122][PR]]!\n\n** <2019-11-25 Mon>\n\n*** Added\n    - Honor the 'nologrepeat' option\n      - It can be set via =#+STARTUP:= or as a property\n      - Thank you [[https://github.com/jamesnvc][@jamesnvc]] for your [[https://github.com/200ok-ch/organice/pull/119][PR]]!\n\n** <2019-11-22 Fri>\n\n*** Fixed\n\n    - Handle non-clock entries in =:LOGBOOK:= drawers\n      - Fixes [[https://github.com/200ok-ch/organice/issues/111][issue #111]], [[https://github.com/200ok-ch/organice/issues/108][issue #108]] and [[https://github.com/200ok-ch/organice/issues/110][issue #110]]\n      - Thank you [[https://github.com/jamesnvc][@jamesnvc]] for your [[https://github.com/200ok-ch/organice/pull/112][PR]]!\n\n** <2019-11-21 Thu>\n\n*** Fixed\n\n    - Safeguard against potential Dropbox SDK Bug\n      - More information in [[https://github.com/200ok-ch/organice/issues/108][issue #108]]\n\n** <2019-11-19 Tue>\n\n*** Changed\n\n    - Don't put newlines after headers with no content, add newline at EOF\n      - Thank you [[https://github.com/jamesnvc][@jamesnvc]] for your [[https://github.com/200ok-ch/organice/pull/106][PR]]!\n\n** <2019-11-14 Thu>\n\n*** Added\n\n    - *Clocking work time*\n      - Org mode allows you to clock the time you spend on specific\n        tasks in a project:\n        https://orgmode.org/manual/Clocking-Work-Time.html#Clocking-Work-Time\n      - organice is compatible with logbook clocking, now\n      - You can 'clock in' and 'clock out' to a header\n      - Thank you [[https://github.com/jamesnvc][@jamesnvc]] for your [[https://github.com/200ok-ch/organice/pull/103][PR]]!\n\n** <2019-10-31 Thu>\n\n*** Fixed\n    - Keep all in-file settings and content lines from top of file\n      - Thank you [[https://github.com/andersjohansson][@andersjohansson]] for your [[https://github.com/200ok-ch/organice/pull/90][PR]]!\n\n** <2019-10-29 Tue>\n\n*** Added\n    - Show login options as clickable links with cursor pointer\n    - Also improve wording with regards to login options\n      - Thank you [[https://github.com/rodrigomaia17][@rodrigomaia17]] for your [[https://github.com/200ok-ch/organice/pull/88][PR]]!\n\n\n** <2019-10-26 Sat>\n\n*** Added\n    - *WebDAV as a sync backend!*\n      - Thank you [[https://github.com/TristanCacqueray][@TristanCacqueray]] for your [[https://github.com/200ok-ch/organice/pull/82][PR]]!\n\n    - As a user, when I swipe a header, I want the icon to contrast\n      the background, so that better see the action taken\n      - Thank you [[https://github.com/ragone][@ragone]] for your [[https://github.com/200ok-ch/organice/pull/78][PR]]!\n\n    - As a user, when I hover a clickable element, I want my cursor to\n    change, so that I can see that it is clickable.\n      - Thank you [[https://github.com/ragone][@ragone]] for your [[https://github.com/200ok-ch/organice/pull/79][PR]]!\n\n*** Fixed\n    - Do not throw an error when clearing a planning item\n      - Thank you [[https://github.com/ragone][@ragone]] for your [[https://github.com/200ok-ch/organice/pull/81][PR]]!\n\n** <2019-10-02 Wed>\n\n*** Fixed\n\n- On iOS 13, fix the regression which made capture input fields hide\n  under the keyboard\n  - More information and screenshots in the ticket: https://github.com/200ok-ch/organice/issues/46\n  - Turns out this issue is non trivial to fix and requires specific\n    rules for every size of iPhone. I tested against the Xs and 6s. If\n    you have a different form factor and the capture template input\n    screen looks off to you, please send me a screenshot of what it\n    looks like and I'll add the dimensions for your form factor right\n    away!\n\n** <2019-09-28 Sat>\n\n*** Added\n\n- Implemented a =redo= Button next to the =undo= button\n\n** <2019-09-21 Sat>\n\n*** Fixed\n\n- Parser bug which would interpret *bold* statements in the beginning\n  of a line as a header.\n- Parser bug which would delete newlines between headers and items\n\n*** Changed\n\n- @MTrost [[https://github.com/200ok-ch/organice/pull/45][introduced]] a new testing library called [[https://testing-library.com/docs/intro][React Testing\n  Library]] which greatly simplified writing interaction tests.\n\n** <2019-09-19 Thu>\n\n*** Changed\n\n- Constraining to a max width and centering for tablets and bigger\n\n** <2019-09-15 Sun>\n\n*** Fixed\n\n- The 'Sync on application becoming visible' feature works on iOS and\n  Safari\n  - If enabled, the current org file is pulled from the sync backend\n    when the browser tab becomes visible. This prevents you from\n    having a stale file before starting to make changes to it.\n\n** <2019-09-08 Sun>\n*** Added\n\n- Documented how to use organice from a bookmarklet using the capture\n  template feature\n\n** <2019-09-06 Fri>\n*** Fixed\n\n- Removed Google Analytics tracking, because it has no place here\n\n** <2019-09-02 Mon>\n\n*** Added\n\n- Configure Google Drive for the free community version of organice at\n  https://organice.200ok.ch\n- Documented SPA routing for self-hosting\n- Wrote and publicized a Privacy Policy\n\n** <2019-08-27 Tue>\n\n*** Changed\n\n- Color scheme has been ported to the popular [[https://ethanschoonover.com/solarized/][Solarized]] (light mode)\n  - Whilst doing so, CSS variables have been introduced, so that\n    there's not a whole lot of repetition of magic rgb values going on\n  - The logo has been adapted, too\n- The landing page and settings screens have been de-cluttered\n\n** <2019-08-26 Mon>\n\n*** Added\n\n- Continuous deployment: Merging to =master= triggers a build on CI\n  and when successful, it triggers a deploy to https://org.200ok.ch\n- Add a new temporary\u2122 logo: [[file:public/organice.png][organice.png]]\n\n** <2019-08-25 Sun>\n\n*** Added\n\n- Since we want organice to be a community driven project, we have added:\n  - [[file:CODE_OF_CONDUCT.org][Code of conduct]]\n  - [[file:CONTRIBUTING.org][Contributing guidelines]]\n\n- Add [[https://circleci.com/][CircleCI]] to run the tests on every commit\n  - They are also integrated as a check for PRs with the benefit that\n    contributors get automated feedback by running the regression test\n    suite.\n\n- Add [[https://greenkeeper.io][Greenkeeper]] for automated dependency management\n\n- Add [[https://codeclimate.com][Codeclimate]] for automated maintainability analysis\n\n*** Changed\n\n- Upgraded to Node 12.9\n\n** <2019-08-12 Mon>\n\n*** Changed\n\n- The default keybindings (when used from a desktop browser) are now\n  more in line with the defaults in Emacs itself\n\n*** Fixed\n\n- The keybindings work on non-macOS operating systems\n\n** <2019-08-10 Sat>\n\n*** Added\n\n- As a user, when in a directory listing, I want the folders and files\n  to be sorted alphabetically. Furthermore, I only want to see files\n  that organice can open (that is org and org archive files).\n- Note: This is only implemented for the Dropbox back-end at this time.\n\n*** Changed\n\n- Filters files from a directory listing down to org files.\n- Sorts folders atop of files.\n- Sorts both folders and files alphabetically.\n\n\n** <2019-08-05 Mon>\n\n*** Added\n\n- When the browser tab becomes visible, pull the latest version of the\n  Org file\n  - This is rather helpful when the app is used in production. Since\n    the production build supports loading the complete application and\n    org-file from cache, it can be open for a very long time. When the\n    org-file hasn't been pulled in a \"very long time\"\u2122, then chances\n    are non-nil that the file has been changed by another client in\n    the meantime.\n  - Without this change, when the user opens the app after a while,\n    makes changes to the file and wants to sync to the back-end, there\n    might be the message \"Since you last pulled, a newer version of\n    the file has been pushed to the server.\". Now the user has two\n    conflicting versions of the same file and can only chose to keep\n    one (Which in itself is great UX and great error handling for\n    cases in which we do encounter a merge conflict, of course!).\n  - This situation is mitigated with this change. Now the user has the\n    option to enable \"Sync on application becoming visible\" which acts\n    similarly to \"Live Sync\". When the user opts to use this feature,\n    whenever the application get's pulled from the background or\n    started through the service worker, the first thing that happens\n    it that a new version of the org-file is pulled from the server.\n    It's therefore much harder for the user to create conflicts.\n\n** <2019-08-04 Sun>\n\n*** Fixed\n\n- Parser doesn't break indentation of existing files in fewer places\n- Planning Items are formatted as in Emacs Org mode\n- Properties are formatted as in Emacs Org mode\n- Tags are formatted as in Emacs Org mode\n\n\n** <2019-08-03 Sat>\n\n*** Added\n\n- Documented deployment options\n  - People have been asking for tighter access restrictions.\n  - Imo the best answer to that request is to make it as easy as\n    possible to host organice.\n  - There's myriads of good options, of course. I picked to document\n    two that will (potentially) be cost-free to the users and which\n    are very easy and quick to set up: Ftp and Heroku.\n\n*** Fixed\n\n- Tests on =master= were red\n  - Partly due to obsolete tests\n  - Partly because tests weren't updated according to changes in the code\n",sample:'#+TODO: TODO | DONE\n#+TODO: START INPROGRESS STALLED | FINISHED\n\n* This is an actual org file - feel free to play around with it! (Don\'t worry about messing it up - your changes won\'t be saved, so just refresh the page to reset it)\n* For starters, tap on the next header to open it\nThis header has some description text and a couple subheaders. Look through the next few top level headers to learn more about organice.\n** This is a subheader\n** This is a subheader too!\n* Actions\n** Todos [1/4] [25%]\nThis header has a few TODO items as subheaders.\n*** TODO Learn how to use TODOs in organice\nTo advance the todo state of a header, swipe right on it until the background turns green.\n\nTry advancing the todo state of this header a few times!\n**** There\'s also a setting once you\'re signed in to enable tapping on the TODO label itself to advance the todo state. Its off by default because I thought the behavior would be confusing unless explained, but I recommend turning it on!\n*** DONE Check out organice\n*** START Investigate custom TODO states\norganice also supports [[http://orgmode.org/manual/Workflow-states.html#Workflow-states][custom todo states]] (if declared at the top of the file). Swipe right on this header a few times.\n\nNote that when the cycle restarts, it defaults to the first set of todo states. Manually edit the header to get back to a different todo state cycle (more on editing headers below!)\n** Editing headers\nWhen you select a header the "header action drawer" appears. The first two buttons in this drawer edit the header and description respectively. Try editing this header.\n** Tags\nThe next button in the header action drawer will bring up the tag editor.\n\nThis editor lets you add, modify, and reorder tags, as well as giving you easy access to all tags in the file.\n\nTry it out on these headers:\n*** Dogs:\n**** Eloise                                         :cute:middleaged:tiny:\n**** Clooney                                             :cute:young:tiny:\n**** Murphy                                             :cute:young:small:\n**** Starla                                              :cute:old:medium:\n**** Rex                                                 :cute:old:medium:\n**** Maz                                           :cute:middleaged:large:\n** Focusing\nThe next button in the header action drawer "focuses" on a header, hiding all others and promoting it to the top level. Press the button again to "unfocus".\n\nThis is purely visual - your org file isn\'t affected under the hood.\n\nI find this useful for focusing on my "Groceries" list when I go to the grocery store. Give it a shot on this grocery list:\n*** Groceries\n- [ ] Mangoes\n- [ ] Dark chocolate\n- [ ] Carrots\n** Adding and removing headers\nTo add a new header, press the + button in the header action drawer\n\nTo remove a header, swipe left on the header until the background turns red.\n** Moving headers\nTo move a header, click on the four-way arrows button at the bottom of the screen with a header selected. 6 buttons will appear for moving headers.\n\nThe center 4 move the header up, down, left, and right. The 2 outermost buttons move the header and its entire nested subtree.\n\nGive them a try on these nested headers to get a feel for how they operate:\n*** A few of my favorite things:\n**** Food\n***** Chocolate\n****** Dark chocolate\n****** Milk chocolate\n****** Crispy chocolate\n***** Mangoes\n**** Text editors\n***** Emacs\n**** Mountain bikes\n***** Santa Cruz\n***** Trek\n***** Giant\n***** Specialized\n**** Dogs\n***** Eloise\n***** Maz\n***** Starla\n***** Rex\n***** Clooney\n** Syncing\nThe "cloud" button in the lower left hand corner syncs changes to your\nchosen sync service (Dropbox, Google Drive or WebDAV).\n\nIf there\'s a newer version on the server and no local changes, it\'ll pull.\n\nIf there\'s no newer version on the server and there are local changes, it\'ll push.\n\nOtherwise, it\'ll ask what you want to do.\n\nThis button isn\'t enabled in this demo :)\n\nIf you\'d like to automatically push changes as you make them, you can enable "Live sync" in settings.\n** Undo / Redo\n   When you\'re signed in, you\'ll have =undo= and =redo= buttons in the\n   headerbar.\n* Tables\norganice has native support for viewing and editing tables.\n\nTry playing around with this one by first clicking on a cell:\n\n| Dog name | Age | Weight (in lbs) | Parent   | Score (1-10) |\n|----------+-----+-----------------+----------+--------------|\n| Eloise   |   3 |             5.1 | Erin     |           15 |\n|----------+-----+-----------------+----------+--------------|\n| Starla   |  15 |              40 | Sarah S  |           15 |\n|----------+-----+-----------------+----------+--------------|\n| Rex      |  15 |              45 | Sarah S  |           15 |\n|----------+-----+-----------------+----------+--------------|\n| Maz      |   1 |              55 | Brittany |           15 |\n|----------+-----+-----------------+----------+--------------|\n| Clooney  | 0.1 |             4.8 | Sarah R  |           15 |\n|----------+-----+-----------------+----------+--------------|\n| Murphy   | 0.5 |              25 | Jordan   |           15 |\n\n** New action drawer items\nWhen a table cell is selected, a table-specific action drawer appears.\n\nThe leftmost icon allows you to edit a cell.\n\nOn the right side, the top two icons let you add and remove rows. The\nbottom two icons let you add and remove columns.\n\n** Moving rows and columns\nWhen a table cell is selected, the four-way arrow button at the bottom\nof the screen changes to manipulate tables.\n\nPress up and down to move rows, and left and right to move columns.\n* Lists and checkboxes\norganice has native support for displaying plain lists and checkboxes\n\nPlain:\n\n- plain list item 1\n- plain list item 2\n  - sub item 1\n- plain list item 3\n\nOrdered:\n\n1. Item 1\n2. Item 2\n20. [@20] Item 20\n21. Item 21\n\nCheckboxes:\n\n- [-] 1 [1/2]\n  - [ ] 1.1 [0%]\n    - [ ] 1.1.1\n  - [X] 1. 2\n- [X] 2\n\nCurrently, plain lists are mostly display only (except that you can check/uncheck checkboxes). If native support for manipulating plain lists is important to you, please let me know by upvoting [[https://github.com/200ok-ch/organice/issues/26][the issue]] on Github\n* Timestamps\norganice has native support for displaying and editing timestamps.\n\nTry tapping on the timestamps below to get a feel for the editor:\n\n<2018-09-17 Sun>\n\n[2018-09-17 Sun]\n\n[2018-09-17 Sun +1d]\n\n[2018-09-17 Sun 10:00-11:30]\n\n<2018-09-17 Sun>--<2018-09-25 Tue>\n* Property lists\norganice has native support for viewing and editing property lists. To bring up an editor, expand the ~PROPERTIES~ drawer below and tap on any of the properties.\n** Example\n:PROPERTIES:\n:callsign: Maverick\n:eyewear: Aviators\n:launch-date: [1986-05-16 Fri]\n:END:\n* Planning\norganice has native support for adding and editing DEADLINE and SCHEDULED items. It also supports [[https://orgmode.org/manual/Repeated-tasks.html][repeaters]] and [[https://orgmode.org/manual/Deadlines-and-scheduling.html#Deadlines-and-scheduling][delays]]. Check out these examples:\n** An item with a deadline\n   DEADLINE: <2018-10-03 Wed>\n** An item that is scheduled\n   SCHEDULED: <2018-10-18 Thu>\n** An item with both\n   DEADLINE: <2018-10-05 Fri> SCHEDULED: <2018-10-04 Thu>\n** TODO An item with a repeater - try swiping right to advance to the DONE state\n   DEADLINE: <2019-01-03 Thu ++1w>\n   :PROPERTIES:\n   :LAST_REPEAT: [2019-12-08 Sun 11:19]\n   :END:\n   - State "DONE"       from "TODO"       [2019-12-08 Sun 11:19]\n* Capture\norganice supports something like org-capture in the form of customizable, quickly accessible buttons for creating new headers.\n\nClick the button in the bottom right corner of the screen to see some examples. The first button, the lemon, will create a new entry in the "Groceries" list below this. The second button adds an entry to a more deeply nested header.\n\nOnce signed in, you can set up capture templates that specify header paths (and various other configurations). These capture templates can also sync between your devices (if you enable settings sync).\n** Groceries\n** Deeply\n*** Nested\n**** Headers\n***** Work\n****** Too!\n* Agenda\norganice has a basic agenda view that you can access by tapping the calendar button at the bottom of the page.\n\nTap a header in this view to jump to it, and tap on the date to switch to a more readable relative date format.\n\nThese overdue items with deadlines should show up on today\'s entry:\n** TODO check out the organice agenda view\nDEADLINE: <2018-09-10 Mon>\n** TODO install organice to your phones homescreen\nSCHEDULED: <2018-09-17 Mon>\n* Syncing\norganice pulls down your org files from Dropbox, Google Drive or\nWebDAV. Click the "Sign in" button in the upper right hand corner to\nsign in with either of them and authenticate organice.\n\n** Backups\nThe first time you push changes from organice back up to your chosen\nsync service, organice will make a backup of the original file first.\nIt\'ll be named {your-file-name}.organice-bak. Dropbox and Google Drive\nalso both keep a full version history of your files for you, but this\nis an additional precaution in case something goes wrong pushing the\nfile back up.\n\nGenerally, when working with distributed Org files, we\'re recommending\nto put them under version control and to check for bugs and racing\nconditions between clients.\n* organice operates completely client side\nYou don\'t log in to organice directly because organice doesn\'t have a\nback end - it operates completely client side using Dropbox, Google\nDrive or WebDAV as back-ends.\n* Capture URL params and Siri support\norganice supports a flexible mechanism for capturing using URL parameters. This mechanism integrates very nicely with the new [[https://support.apple.com/guide/shortcuts/welcome/ios][Siri Shortcuts]] feature in iOS 12, allowing you to use Siri to execute capture templates.\n\nYou can use [[https://www.icloud.com/shortcuts/14f91f8cf8f547a183a0734396240984][this sample Shortcut]] to get started with this right away in iOS 12. Open the link on your iOS device and click "Get Shortcut". Then open up the Shortcuts app and edit the template by following the directions in the comments. Then record a Siri trigger and you\'re good to go!\n\nAlternatively, you can take advantage of the URL parameters yourself to build your own custom capture mechanism. You can find more details about this in [[https://github.com/200ok-ch/organice/#capture-params-and-siri-support][the README file]].\n'}[e]))}},D=function(){return function(e,t){e(Ke()),t().base.get("lastViewedPath")&&e(We(t().base.get("lastViewedPath"),t().base.get("lastViewedContents")))}},A=function(e){return{type:"SET_FONT_SIZE",newFontSize:e}},N=function(e){return{type:"SET_BULLET_STYLE",newBulletStyle:e}},P=function(e){return{type:"SET_SHOULD_TAP_TODO_TO_ADVANCE",newShouldTapTodoToAdvance:e}},L=function(e){return{type:"SET_AGENDA_DEFAULT_DEADLINE_DELAY_UNIT",newAgendaDefaultDeadlineDelayUnit:e}},j=function(e){return{type:"SET_AGENDA_DEFAULT_DEADLINE_DELAY_VALUE",newAgendaDefaultDeadlineDelayValue:e}},M=function(e){return{type:"SET_SHOULD_LIVE_SYNC",shouldLiveSync:e}},R=function(e){return{type:"SET_SHOULD_SYNC_ON_BECOMING_VISIBLE",shouldSyncOnBecomingVisibile:e}},x=function(e){return function(t,n){if(t({type:"SET_SHOULD_STORE_SETTINGS_IN_SYNC_BACKEND",newShouldStoreSettingsInSyncBackend:e}),!e){var a=n().syncBackend.get("client");switch(a.type){case"Dropbox":case"WebDAV":a.deleteFile("/.organice-config.json").catch((function(e,t){return e?null:alert("There was an error trying to delete the .organice-config.json file: ".concat(t))}));break;case"Google Drive":a.deleteFileByNameAndParent(".organice-config.json","root")}window.previousSettingsFileContents=null}}},H=function(e){return{type:"SET_HAS_UNSEEN_CHANGELOG",newHasUnseenChangelog:e}},F=function(e){return{type:"SET_LAST_SEEN_CHANGELOG_HEADER",newLastSeenChangelogHeader:e}},B=function(e,t){return{type:"SET_CUSTOM_KEYBINDING",keybindingName:e,keybinding:t}},U=function(e){return{type:"RESTORE_BASE_SETTINGS",newSettings:e}},V=function(e){return{type:"PUSH_MODAL_PAGE",modalPage:e}},W=function(){return{type:"POP_MODAL_PAGE"}},G=function(){return{type:"CLEAR_MODAL_STACK"}},K=function(e,t){return{type:"ACTIVATE_POPUP",popupType:e,data:t}},z=function(){return{type:"CLOSE_POPUP"}},Y=n(64),J=n(3),X=n.n(J),q=n(1),$=n(23),Q=n(495),Z=n(218),ee=n(94),te=n(219),ne=n(95),ae=n(221),re=n(478),ie=n(479),oe=n(480),se=n(481),ce=n(482),le=n(483),ue=n(484),de=function(e){var t=e.toJS(),n=t.isActive,a=t.year,r=t.month,i=t.day,o=t.dayName,s=t.startHour,c=t.startMinute,l=t.endHour,u=t.endMinute,d=t.repeaterType,h=t.repeaterValue,p=t.repeaterUnit,m=t.delayType,g=t.delayValue,f=t.delayUnit,b="";return b+=n?"<":"[",b+="".concat(a,"-").concat(r,"-").concat(i),b+=o?" ".concat(o):"",b+=s?" ".concat(s,":").concat(c):"",b+=l?"-".concat(l,":").concat(u):"",b+=d?" ".concat(d).concat(h).concat(p):"",b+=m?" ".concat(m).concat(g).concat(f):"",b+=n?">":"]"},he=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.isActive,n=void 0===t||t,a=e.withStartTime,r=void 0!==a&&a,i=new Date,o={isActive:n,year:Object($.a)(i,"yyyy"),month:Object($.a)(i,"MM"),day:Object($.a)(i,"dd"),dayName:Object($.a)(i,"eee"),startHour:null,startMinute:null,endHour:null,endMinute:null,repeaterType:null,repeaterValue:null,repeaterUnit:null,delayType:null,delayValue:null,delayUnit:null};return r&&(o.startHour=Object($.a)(i,"HH"),o.startMinute=Object($.a)(i,"mm")),o},pe=function(){return"<".concat(Object($.a)(new Date,"yyyy-MM-dd eee"),">")},me=function(e){var t,n=e.toJS(),a=n.year,r=n.month,i=n.day,o=n.startHour,s=n.startMinute,c="".concat(a,"-").concat(r,"-").concat(i);return o&&s?(c+=" ".concat(o.padStart(2,"0"),":").concat(s),t=Object(Q.a)(c,"yyyy-MM-dd HH:mm",new Date)):t=Object(Q.a)(c,"yyyy-MM-dd",new Date),t},ge=function(e,t,n){return{h:Object(Z.a)(e,t),d:Object(ee.a)(e,t),w:Object(te.a)(e,t),m:Object(ne.a)(e,t),y:Object(ae.a)(e,t)}[n]},fe=function(e,t){if(!e.get("repeaterType"))return e;var n=null;switch(e.get("repeaterType")){case"+":n=ge(me(e),e.get("repeaterValue"),e.get("repeaterUnit"));break;case"++":for(n=ge(me(e),e.get("repeaterValue"),e.get("repeaterUnit"));Object(le.a)(n,t);)n=ge(n,e.get("repeaterValue"),e.get("repeaterUnit"));break;case".+":n=ge(new Date,e.get("repeaterValue"),e.get("repeaterUnit"));break;default:return console.error("Unrecognized timestamp repeater type: ".concat(e.get("repeaterType"))),e}return void 0!==(e=e.set("day",Object($.a)(n,"dd")).set("dayName",Object($.a)(n,"eee")).set("month",Object($.a)(n,"MM")).set("year",Object($.a)(n,"yyyy"))).get("startHour")&&null!==e.get("startHour")&&(e=e.set("startHour",Object($.a)(n,"HH")).set("startMinute",Object($.a)(n,"mm"))),e},be=function(e,t){var n=[e,t].map(me),a=Object(d.a)(n,2),r=a[0],i=a[1],o=" ";if(r>i){o="-";var s=[i,r];r=s[0],i=s[1]}var c=Object(ue.a)(i,r),l=Math.floor(c/60);l>=10&&(o="");var u=c%60,h=u>=10?u:"0".concat(u);return"".concat(o).concat(l,":").concat(h)},ye=function(e){return e.map((function(e){switch(e.get("type")){case"text":return e.get("contents");case"link":return e.getIn(["contents","title"])?e.getIn(["contents","title"]):e.getIn(["contents","uri"]);case"table":default:return""}})).join("")},ve=function(e){if(!e)return"";var t=e.map((function(e){return e.get("type")})).unshift(null);return e.zip(t).map((function(e){var t,n=Object(d.a)(e,2),a=n[0],r=n[1],i="";switch(a.get("type")){case"text":i=a.get("contents");break;case"link":i=(t=a).getIn(["contents","title"])?"[[".concat(t.getIn(["contents","uri"]),"][").concat(t.getIn(["contents","title"]),"]]"):"[[".concat(t.getIn(["contents","uri"]),"]]");break;case"fraction-cookie":i="[".concat(a.getIn(["fraction",0])||"","/").concat(a.getIn(["fraction",1])||"","]");break;case"percentage-cookie":i="[".concat(a.get("percentage")||"","%]");break;case"table":i=function(e){var t=e.get("contents").map((function(e){return Math.max.apply(Math,Object(Y.a)(e.get("contents").map((function(e){return(X.a.countBy(e.get("rawContents"))["\n"]||0)+1}))))})).toJS(),n=e.getIn(["contents",0,"contents"]).size,a=X.a.times(n).map((function(t){return Math.max.apply(Math,Object(Y.a)(e.get("contents").map((function(e){var n=e.getIn(["contents",t,"contents"]),a=ye(n).split("\n").map((function(e){return e.trim().length}));return Math.max.apply(Math,Object(Y.a)(a))}))))}));return X.a.dropRight(X.a.flatten(e.get("contents").map((function(e,n){var r=t[n],i=X.a.times(r).map((function(t){return e.get("contents").map((function(e,n){var r=e.get("contents"),i=ye(r).split("\n").map((function(e){return e.trim().length})),o=(e.get("rawContents").split("\n")[t]||"").trim(),s=a[n]-i[t];return o+" ".repeat(s)})).toJS().join(" | ")})).map((function(e){return"| ".concat(e," |")})),o="|"+a.map((function(e){return"-".repeat(e+2)})).join("+")+"|";return i.concat(o)})).toJS())).join("\n")}(a);break;case"list":i=function(e){var t=e.get("bulletCharacter"),n=0;return e.get("items").map((function(a){var r=e.get("isOrdered")||"*"!==t?"":" ",i=ve(a.get("titleLine")),o=ve(a.get("contents")),s=o.split("\n").map((function(e){return e.trim()?"".concat(r,"  ").concat(e):""})).join("\n"),c=null;if(e.get("isOrdered")){var l=++n,u=a.get("forceNumber");if(u&&(n=l=u),c="".concat(l).concat(e.get("numberTerminatorCharacter")),u&&(c+=" [@".concat(u,"]")),a.get("isCheckbox")){var d={checked:"X",unchecked:" ",partial:"-"}[a.get("checkboxState")];c+=" [".concat(d,"]")}c+=" ".concat(i)}else{if(c="".concat(r).concat(t),a.get("isCheckbox")){var h={checked:"X",unchecked:" ",partial:"-"}[a.get("checkboxState")];c+=" [".concat(h,"]")}c+=" ".concat(i)}return o&&(c+="\n".concat(s)),c})).join("\n")}(a);break;case"timestamp":i=function(e){var t=de(e.get("firstTimestamp"));return e.get("secondTimestamp")&&(t+="--".concat(de(e.get("secondTimestamp")))),t}(a);break;default:console.error("Unknown attributed string part type in attributedStringToRawText: ".concat(a.get("type")))}return(["list","table"].includes(r)?"\n":"")+i})).join("")},Ee=function(e,t,n,a){var r="";n.size>0&&(r=n.join("\n")+"\n"),t.get(0).get("default")||(r=r+t.map((function(e){return e.get("configLine")})).join("\n")+"\n"),a.size>0&&(r+=a.join("\n")),r.length>0&&(r+="\n");var i=e.toJS().map((function(e){var t=" ".repeat(e.nestingLevel+1),n="";if(n+="*".repeat(e.nestingLevel),e.titleLine.todoKeyword&&(n+=" ".concat(e.titleLine.todoKeyword)),n+=" ".concat(e.titleLine.rawTitle),e.titleLine.tags.length&&(n+=":".concat(e.titleLine.tags.filter((function(e){return!!e})).join(":"),":")),e.planningItems.length){var a=e.planningItems.map((function(e){return"".concat(e.type,": ").concat(de(Object(q.fromJS)(e.timestamp)))})).join(" ").trimRight();n+="\n".concat(t).concat(a)}if(e.propertyListItems.length){var r=e.propertyListItems.map((function(e){return"".concat(t,":").concat(e.property,": ").concat(ve(Object(q.fromJS)(e.value)))})).join("\n");n+="\n".concat(t,":PROPERTIES:"),n+="\n".concat(r),n+="\n".concat(t,":END:\n")}if(e.logBookEntries.length){var i=e.logBookEntries.map((function(e){return void 0!==e.raw?e.raw?"".concat(t).concat(e.raw):"":null===e.end?"".concat(t,"CLOCK: ").concat(de(Object(q.fromJS)(e.start))):"".concat(t,"CLOCK: ").concat(de(Object(q.fromJS)(e.start)),"--").concat(de(Object(q.fromJS)(e.end))," => ").concat(be(Object(q.fromJS)(e.start),Object(q.fromJS)(e.end)))})).join("\n").trimRight();n+="\n".concat(t,":LOGBOOK:"),n+="\n".concat(i),n+="\n".concat(t,":END:\n")}return e.description.length>0?(e.rawDescription.startsWith("\n")||0===e.rawDescription.length||(n+="\n"),n+=e.rawDescription):n=n.trimRight(),n})).join("\n");return r+i+(i.endsWith("\n")?"":"\n")},_e=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object(q.Map)();if(!e)return["",null];var n={"%t":"<".concat(Object($.a)(new Date,"yyyy-MM-dd eee"),">"),"%T":"<".concat(Object($.a)(new Date,"yyyy-MM-dd eee HH:mm"),">"),"%u":"[".concat(Object($.a)(new Date,"yyyy-MM-dd eee"),"]"),"%U":"[".concat(Object($.a)(new Date,"yyyy-MM-dd eee HH:mm"),"]")};t.entrySeq().forEach((function(e){var t=Object(d.a)(e,2),a=t[0],r=t[1];n["%".concat(a)]=r}));var a=e;X.a.entries(n).forEach((function(e){var t=Object(d.a)(e,2),n=t[0],r=t[1];return a=a.replace(RegExp(n,"g"),r)}));var r=a.includes("%?")?a.indexOf("%?"):null;return[a=a.replace(/%\?/,""),r]},Te=function(){var e=1;return function(){return e++}}(),ke=function(e,t){return e.findIndex((function(e){return e.get("id")===t}))},we=function(e,t){return e.get(ke(e,t))},Ie=function(e,t){var n=we(e,t),a=ke(e,t),r=e.slice(a+1),i=r.findIndex((function(e){return e.get("nestingLevel")<=n.get("nestingLevel")}));return-1===i?r:r.slice(0,i)},Ce=function(e,t){return Ie(e,t).size},Se=function(e,t){var n=we(e,t),a=ke(e,t),r=e.slice(0,a).reverse().find((function(e){return e.get("nestingLevel")<n.get("nestingLevel")}));return r?r.get("id"):null},Oe=function e(t,n,a){var r=t.getIn([n,"propertyListItems"]).find((function(e){return e.get("property")===a}));if(r)return r.get("value");var i=Se(t,t.getIn([n,"id"]));return i?e(t,ke(t,i),a):null},De=function e(t,n){var a=Se(t,n);if(!a)return!0;var r=we(t,a);return r.get("opened")&&e(t,r.get("id"))},Ae=function(e,t){var n=function(e,t){for(var n=we(e,t),a=ke(e,t)-1;a>=0;--a){var r=e.get(a);if(r.get("nestingLevel")===n.get("nestingLevel")-1)return r.get("id");if(r.get("nestingLevel")<n.get("nestingLevel"))return null}return null}(e.get("headers"),t);if(null!==n){var a=ke(e.get("headers"),n);e=e.setIn(["headers",a,"opened"],!0)}return e},Ne=function e(t,n){if(0===n.size)return null;var a=t.find((function(e){return null===Se(t,e.get("id"))&&e.getIn(["titleLine","rawTitle"]).trim()===n.first().trim()}));return a?1===n.size?a:e(Ie(t,a.get("id")),n.skip(1)):null},Pe=function(e,t){return e.get("contents").some((function(e){return e.get("contents").some((function(e){return e.get("id")===t}))}))},Le=function(e,t){return e.find((function(e){return function e(t,n){return t.filter((function(e){return["table","list"].includes(e.get("type"))})).some((function(t){return"table"===t.get("type")?Pe(t,n):t.get("items").some((function(t){return e(t.get("contents"),n)}))}))}(e.get("description"),t)}))},je=function e(t,n){return t.map((function(t,a){return"timestamp"===t.get("type")&&t.get("id")===n?{path:[a],timestampPart:t}:"list"===t.get("type")?t.get("items").map((function(t,r){var i=e(t.get("contents"),n);if(i){var o=i.path,s=i.timestampPart;return{path:[a,"items",r,"contents"].concat(o),timestampPart:s}}var c=e(t.get("titleLine"),n);if(c){var l=c.path,u=c.timestampPart;return{path:[a,"items",r,"titleLine"].concat(l),timestampPart:u}}return null})).filter((function(e){return!!e})).first():"table"===t.get("type")?t.get("contents").map((function(t,r){return t.get("contents").map((function(t,i){var o=e(t.get("contents"),n);if(o){var s=o.path,c=o.timestampPart;return{path:[a,"contents",r,"contents",i,"contents"].concat(s),timestampPart:c}}return null})).filter((function(e){return!!e})).first()})).filter((function(e){return!!e})).first():null})).filter((function(e){return!!e})).first()},Me=function(e,t){return e.map((function(e,n){var a=function e(t,n){return t.map((function(t,a){return"table"===t.get("type")?Pe(t,n)?{path:[a],tablePart:t}:null:"list"===t.get("type")?t.get("items").map((function(t,r){var i=e(t.get("contents"),n);if(i){var o=i.path,s=i.tablePart;return{path:[a,"items",r,"contents"].concat(o),tablePart:s}}return null})).filter((function(e){return!!e})).first():null})).filter((function(e){return!!e})).first()}(e.get("description"),t);if(!a)return null;var r=a.path,i=a.tablePart;return{path:[n,"description"].concat(r),tablePart:i}})).filter((function(e){return!!e})).first()},Re=function(e,t,n){var a=Me(e,t),r=a.path,i=a.tablePart,o=i.get("contents").findIndex((function(e){return e.get("contents").some((function(e){return e.get("id")===t}))})),s=i.getIn(["contents",o,"contents"]).findIndex((function(e){return e.get("id")===t}));return e.updateIn(r.concat(["contents"]),n(o,s))},xe=function(e,t){if(!e)return null;var n=je(e,t);return n?n.timestampPart:null},He=function(e,t){return e.find((function(e){return e.get("keywords").contains(t)}))||e.first()},Fe=Object(q.fromJS)([{description:"Groceries",headerPaths:["Capture","Groceries"],iconName:"lemon",id:Te(),isAvailableInAllOrgFiles:!1,letter:"",orgFilesWhereAvailable:[],shouldPrepend:!1,template:"* TODO %?",isSample:!0},{description:"Deeply nested header",headerPaths:["Capture","Deeply","Nested","Headers","Work","Too!"],iconName:"fighter-jet",id:Te(),isAvailableInAllOrgFiles:!1,letter:"",orgFilesWhereAvailable:[],shouldPrepend:!0,template:"* You can insert timestamps too! %T %?",isSample:!0}]),Be=n(486),Ue=n(487),Ve=n(485),We=function(e,t){return{type:"DISPLAY_FILE",path:e,contents:t}},Ge=function(e){return{type:"SET_LAST_SYNC_AT",lastSyncAt:e}},Ke=function(){return function(e,t){e({type:"STOP_DISPLAYING_FILE"}),e(_.ActionCreators.clearHistory()),e(gt()),e(z()),e(Ge(null))}},ze=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.forceAction,n=void 0===t?null:t,a=e.successMessage,r=void 0===a?"Changes pushed":a,i=e.shouldSuppressMessages,o=void 0!==i&&i;return function(e,t){var a=t().syncBackend.get("client"),i=t().org.present.get("path");null!==i&&(o||e(k("Syncing...")),e(I(!0)),e(Bt(null)),a.getFileContentsAndMetadata(i).then((function(s){var c=s.contents,l=s.lastModifiedAt,u=t().org.present.get("isDirty"),d=Object(Ve.a)(l),h=t().org.present.get("lastSyncAt");Object(Be.a)(h,d)||"push"===n?u?a.updateFile(i,Ee(t().org.present.get("headers"),t().org.present.get("todoKeywordSets"),t().org.present.get("fileConfigLines"),t().org.present.get("linesBeforeHeadings"))).then((function(){o||e(C(r,2e3)),e(I(!1)),e(bt(!1)),e(Ge(Object(Ue.a)(new Date,5)))})).catch((function(t){e(w()),e(I(!1))})):(o||e(C("Nothing to sync",2e3)),e(I(!1))):u&&"pull"!==n?(e(w()),e(I(!1)),e(K("sync-confirmation",{lastServerModifiedAt:d}))):(e(We(i,c)),e(ft()),e(bt(!1)),e(Ge(Object(Ue.a)(new Date,5))),o||e(C("Latest version pulled",2e3)),e(I(!1)))})).catch((function(){e(w()),e(I(!1)),e(Bt("File not found"))})))}},Ye=function(e){return{type:"OPEN_HEADER",headerId:e}},Je=function(e){return{type:"TOGGLE_HEADER_OPENED",headerId:e}},Xe=function(e){return function(t){t({type:"SELECT_HEADER",headerId:e}),e&&t(yt(null))}},qe=function(e){return function(t){t(Xe(e)),t({type:"OPEN_PARENTS_OF_HEADER",headerId:e})}},$e=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return{type:"ADVANCE_TODO_STATE",headerId:e,dirtying:!0}},Qe=function(e){return{type:"ENTER_EDIT_MODE",editModeType:e}},Ze=function(){return{type:"EXIT_EDIT_MODE"}},et=function(e,t){return{type:"UPDATE_HEADER_TITLE",headerId:e,newRawTitle:t,dirtying:!0}},tt=function(e,t){return{type:"UPDATE_HEADER_DESCRIPTION",headerId:e,newRawDescription:t,dirtying:!0}},nt=function(e){return{type:"ADD_HEADER",headerId:e,dirtying:!0}},at=function(e){return{type:"SELECT_NEXT_SIBLING_HEADER",headerId:e}},rt=function(e){return function(t){t(nt(e)),t(at(e)),t(Qe("title"))}},it=function(e){return{type:"SELECT_NEXT_VISIBLE_HEADER",headerId:e}},ot=function(e){return{type:"SELECT_PREVIOUS_VISIBLE_HEADER",headerId:e}},st=function(e){return{type:"REMOVE_HEADER",headerId:e,dirtying:!0}},ct=function(e){return{type:"MOVE_HEADER_UP",headerId:e,dirtying:!0}},lt=function(e){return{type:"MOVE_HEADER_DOWN",headerId:e,dirtying:!0}},ut=function(e){return{type:"MOVE_HEADER_LEFT",headerId:e,dirtying:!0}},dt=function(e){return{type:"MOVE_HEADER_RIGHT",headerId:e,dirtying:!0}},ht=function(e){return{type:"MOVE_SUBTREE_LEFT",headerId:e,dirtying:!0}},pt=function(e){return{type:"MOVE_SUBTREE_RIGHT",headerId:e,dirtying:!0}},mt=function(e){return{type:"FOCUS_HEADER",headerId:e}},gt=function(){return{type:"UNFOCUS_HEADER"}},ft=function(){return{type:"APPLY_OPENNESS_STATE"}},bt=function(e){return{type:"SET_DIRTY",isDirty:e}},yt=function(e){return function(t){t({type:"SET_SELECTED_TABLE_CELL_ID",cellId:e}),e&&t(Xe(null))}},vt=function(){return{type:"ADD_NEW_TABLE_ROW",dirtying:!0}},Et=function(){return{type:"REMOVE_TABLE_ROW",dirtying:!0}},_t=function(){return{type:"ADD_NEW_TABLE_COLUMN",dirtying:!0}},Tt=function(){return{type:"REMOVE_TABLE_COLUMN",dirtying:!0}},kt=function(){return{type:"MOVE_TABLE_ROW_DOWN",dirtying:!0}},wt=function(){return{type:"MOVE_TABLE_ROW_UP",dirtying:!0}},It=function(){return{type:"MOVE_TABLE_COLUMN_LEFT",dirtying:!0}},Ct=function(){return{type:"MOVE_TABLE_COLUMN_RIGHT",dirtying:!0}},St=function(e,t){return{type:"UPDATE_TABLE_CELL_VALUE",cellId:e,newValue:t,dirtying:!0}},Ot=function(e,t,n){return function(a,r){a(z()),a({type:"INSERT_CAPTURE",template:r().capture.get("captureTemplates").concat(Fe).find((function(t){return t.get("id")===e})),content:t,shouldPrepend:n,dirtying:!0})}},Dt=function(){return{type:"CLEAR_PENDING_CAPTURE"}},At=function(){return function(e,t){var n=t().org.present.get("pendingCapture"),a=n.get("captureTemplateName"),r=n.get("captureContent"),i=n.get("customCaptureVariables");e(Dt()),window.history.pushState({},"",window.location.pathname);var o=t().capture.get("captureTemplates").filter((function(e){return e.get("isAvailableInAllOrgFiles")||e.get("orgFilesWhereAvailable").includes(t().org.present.get("path"))})).find((function(e){return e.get("description").trim()===a.trim()}));if(o)if(Ne(t().org.present.get("headers"),o.get("headerPaths"))){var s=_e(o.get("template"),i),c=Object(d.a)(s,2),l=c[0],u=c[1],h=u?"".concat(l.substring(0,u)).concat(r).concat(l.substring(u)):"".concat(l).concat(r);e(Ot(o.get("id"),h,o.get("shouldPrepend"))),e(ze({successMessage:"Item captured"}))}else e(C('Capture failed: "'.concat(o.get("description"),'" header path invalid in this file'),8e3));else e(C('Capture failed: "'.concat(a,'" template not found or not available in this file'),8e3))}},Nt=function(e){return{type:"ADVANCE_CHECKBOX_STATE",listItemId:e,dirtying:!0}},Pt=function(e,t){return{type:"SET_HEADER_TAGS",headerId:e,tags:t,dirtying:!0}},Lt=function(e,t){return{type:"REORDER_TAGS",fromIndex:e,toIndex:t,dirtying:!0}},jt=function(e,t){return function(n,a){return n({type:"REORDER_PROPERTY_LIST",fromIndex:e,toIndex:t,headerId:a().base.getIn(["activePopup","data","headerId"]),dirtying:!0})}},Mt=function(e,t){return{type:"UPDATE_TIMESTAMP_WITH_ID",timestampId:e,newTimestamp:t,dirtying:!0}},Rt=function(e,t,n){return{type:"UPDATE_PLANNING_ITEM_TIMESTAMP",headerId:e,planningItemIndex:t,newTimestamp:n,dirtying:!0}},xt=function(e,t){return{type:"ADD_NEW_PLANNING_ITEM",headerId:e,planningType:t,dirtying:!0}},Ht=function(e,t){return{type:"REMOVE_PLANNING_ITEM",headerId:e,planningItemIndex:t,dirtying:!0}},Ft=function(e,t){return{type:"UPDATE_PROPERTY_LIST_ITEMS",headerId:e,newPropertyListItems:t,dirtying:!0}},Bt=function(e){return{type:"SET_ORG_FILE_ERROR_MESSAGE",message:e}},Ut=function(e,t,n){return{type:"SET_LOG_ENTRY_STOP",headerId:e,entryId:t,time:n,dirtying:!0}},Vt=function(e,t){return{type:"CREATE_LOG_ENTRY_START",headerId:e,time:t,dirtying:!0}},Wt=function(e,t,n,a){return{type:"UPDATE_LOG_ENTRY_TIME",headerId:e,entryIndex:t,entryType:n,newTime:a,dirtying:!0}},Gt=function(e){return function(t){return function(n){return n.dirtying&&e.getState().base.get("shouldLiveSync")&&e.dispatch(ze({shouldSuppressMessages:!0})),t(n)}}},Kt=Object(J.debounce)((function(e){return e.dispatch(ze({shouldSuppressMessages:!0}))}),1e3);var zt=function(e){return function(t){return function(n){var a=function(){var e=["webkit","moz","ms","o"];if("hidden"in document)return"hidden";for(var t=0;t<e.length;t++)if(e[t]+"Hidden"in document)return e[t]+"Hidden";return null}();if(a){var r=a.replace(/[H|h]idden/,"")+"visibilitychange";document.addEventListener(r,(function(){e.getState().syncBackend.get("client")&&e.getState().base.get("shouldSyncOnBecomingVisibile")&&Kt(e)}))}return t(n)}}},Yt=function(){return{type:"ADD_NEW_EMPTY_CAPTURE_TEMPLATE"}},Jt=function(e,t,n){return{type:"UPDATE_TEMPLATE_FIELD_PATH_VALUE",templateId:e,fieldPath:t,newValue:n}},Xt=function(e){return{type:"ADD_NEW_TEMPLATE_ORG_FILE_AVAILABILITY",templateId:e}},qt=function(e,t){return{type:"REMOVE_TEMPLATE_ORG_FILE_AVAILABILITY",templateId:e,orgFileAvailabilityIndex:t}},$t=function(e){return{type:"ADD_NEW_TEMPLATE_HEADER_PATH",templateId:e}},Qt=function(e,t){return{type:"REMOVE_TEMPLATE_HEADER_PATH",templateId:e,headerPathIndex:t}},Zt=function(e){return{type:"DELETE_TEMPLATE",templateId:e}},en=function(e){return{type:"RESTORE_CAPTURE_SETTINGS",newSettings:e}},tn=function(e,t){return{type:"REORDER_CAPTURE_TEMPLATE",fromIndex:e,toIndex:t}},nn=function(){try{return localStorage.setItem("test","test"),"test"===localStorage.getItem("test")}catch(e){return!1}},an=X.a.debounce((function(e,t){switch(e.type){case"Dropbox":case"WebDAV":e.createFile("/.organice-config.json",t).catch((function(e){return alert("There was an error trying to push settings to your sync backend: ".concat(e))}));break;case"Google Drive":e.createFile(".organice-config.json","root",t).catch((function(e){return alert("There was an error trying to push settings to your sync backend: ".concat(e))}))}}),1e3,{maxWait:3e3}),rn=[{category:"base",name:"fontSize",type:"nullable",shouldStoreInConfig:!0},{category:"base",name:"bulletStyle",type:"nullable",shouldStoreInConfig:!0},{category:"base",name:"shouldTapTodoToAdvance",type:"boolean",shouldStoreInConfig:!0},{category:"base",name:"agendaDefaultDeadlineDelayUnit",type:"nullable",shouldStoreInConfig:!0},{category:"base",name:"agendaDefaultDeadlineDelayValue",type:"nullable",shouldStoreInConfig:!0},{category:"base",name:"shouldStoreSettingsInSyncBackend",type:"boolean",shouldStoreInConfig:!0},{category:"base",name:"lastSeenChangelogHeader",type:"nullable",shouldStoreInConfig:!0},{category:"base",name:"customKeybindings",type:"json",shouldStoreInConfig:!0},{category:"base",name:"shouldLiveSync",type:"boolean",shouldStoreInConfig:!0},{category:"base",name:"shouldSyncOnBecomingVisibile",type:"boolean",shouldStoreInConfig:!0},{category:"capture",name:"captureTemplates",type:"json",shouldStoreInConfig:!0,default:new q.List}],on=function(e,t){return t.filter((function(e){return!e.depreacted})).filter((function(e){return"org"===e.category})).map((function(e){return e.name})).map((function(t){return[t,e.org.present.get(t)]})).concat(rn.filter((function(e){return"org"!==e.category})).map((function(t){return"json"===t.type?[t.name,JSON.stringify(e[t.category].get(t.name)||t.default||{})]:[t.name,e[t.category].get(t.name)]})))},sn=function(e){return JSON.stringify(X.a.fromPairs(e.filter((function(e){var t=Object(d.a)(e,2),n=t[0];t[1];return!["lastSeenChangelogHeader"].includes(n)}))),null,2)},cn=function(){if(nn()){var e={syncBackend:Object(q.Map)(),org:{past:[],present:Object(q.Map)(),future:[]},base:Object(q.Map)(),capture:Object(q.Map)()};rn.forEach((function(t){var n=localStorage.getItem(t.name);"nullable"===t.type?"null"===n&&(n=null):"boolean"===t.type?n="true"===n:"json"===t.type&&(n=n?Object(q.fromJS)(JSON.parse(n)):t.default||new q.Map),"org"===t.category?e[t.category].present=e[t.category].present.set(t.name,n):e[t.category]=e[t.category].set(t.name,n)})),e.capture.get("captureTemplates")&&(e.capture=e.capture.update("captureTemplates",(function(e){return e.map((function(e){return e.set("id",Te())}))})));var t=function(){var e=localStorage.getItem("headerOpenness");return e?JSON.parse(e):null}();return t&&(e.org.present=e.org.present.set("opennessState",Object(q.fromJS)(t))),window.previousSettingsFileContents=sn(on(e,rn)),e}},ln=function(e,t){var n=t().syncBackend.get("client");if(n){var a=null;switch(n.type){case"Dropbox":case"WebDAV":a=n.getFileContents("/.organice-config.json");break;case"Google Drive":a=n.getFileContentsByNameAndParent(".organice-config.json","root")}a.then((function(t){try{var n=JSON.parse(t);e(U(n)),e(en(n))}catch(a){}})).catch((function(){}))}},un=function(e){return nn()?function(){var t=e.getState(),n=on(t,rn);if(n.forEach((function(e){var t=Object(d.a)(e,2),n=t[0],a=t[1];return localStorage.setItem(n,a)})),t.base.get("shouldStoreSettingsInSyncBackend")){var a=sn(n);window.previousSettingsFileContents!==a&&an(t.syncBackend.get("client"),a),window.previousSettingsFileContents=a}var r=t.org.present.get("path");if(r&&t.org.present.get("headers")){var i=function e(t){for(var n=[],a=function(a){var i=t.get(a);if(!i.get("opened"))return r=a,"continue";var o=i.getIn(["titleLine","rawTitle"]),s=Ie(t,i.get("id")),c=e(s);c.length>0?c.forEach((function(e){n.push([o].concat(e))})):n.push([o]),a+=s.size,r=a},r=0;r<t.size;++r)a(r);return n}(t.org.present.get("headers")),o={},s=localStorage.getItem("headerOpenness");s&&(o=JSON.parse(s)),o[r]=i,localStorage.setItem("headerOpenness",JSON.stringify(o))}}:function(){}},dn=function(e,t){nn()&&localStorage.setItem(e,t)},hn=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(nn()){var n=localStorage.getItem(e);return t&&"null"===n?null:n}return null},pn=function(e,t){return e.set("loadingMessage",t.loadingMessage)},mn=function(e,t){return e.set("loadingMessage",null)},gn=function(e,t){return e.set("fontSize",t.newFontSize)},fn=function(e,t){return e.set("bulletStyle",t.newBulletStyle)},bn=function(e,t){return e.set("shouldTapTodoToAdvance",t.newShouldTapTodoToAdvance)},yn=function(e,t){return e.set("agendaDefaultDeadlineDelayUnit",t.newAgendaDefaultDeadlineDelayUnit)},vn=function(e,t){return e.set("agendaDefaultDeadlineDelayValue",t.newAgendaDefaultDeadlineDelayValue)},En=function(e,t){return e.set("shouldStoreSettingsInSyncBackend",t.newShouldStoreSettingsInSyncBackend)},_n=function(e,t){return e.set("shouldLiveSync",t.shouldLiveSync)},Tn=function(e,t){return e.set("shouldSyncOnBecomingVisibile",t.shouldSyncOnBecomingVisibile)},kn=function(e,t){return e.set("hasUnseenChangelog",t.newHasUnseenChangelog)},wn=function(e,t){return e.set("lastSeenChangelogHeader",t.newLastSeenChangelogHeader)},In=function(e,t){return e.set("lastViewedPath",t.lastViewedPath).set("lastViewedContents",t.lastViewedContents)},Cn=function(e,t){return e.get("customKeybindings")||(e=e.set("customKeybindings",new q.Map)),e.setIn(["customKeybindings",t.keybindingName],t.keybinding)},Sn=function(e,t){return t.newSettings?function(e,t,n){return rn.filter((function(e){return e.category===n})).filter((function(e){return e.shouldStoreInConfig})).filter((function(e){return"lastSeenChangelogHeader"!==e.name})).forEach((function(n){e="json"===n.type?e.set(n.name,Object(q.fromJS)(JSON.parse(t[n.name]))):e.set(n.name,t[n.name])})),e}(e,t.newSettings,"base"):e},On=function(e,t){return e.update("modalPageStack",(function(e){return e?e.push(t.modalPage):Object(q.List)([t.modalPage])}))},Dn=function(e){return e.update("modalPageStack",(function(e){return e?e.pop():e}))},An=function(e){return e.set("modalPageStack",Object(q.List)())},Nn=function(e,t){return e.set("activePopup",Object(q.fromJS)({type:t.popupType,data:t.data}))},Pn=function(e){return e.set("activePopup",null)},Ln=function(e,t){return e.set("isLoading",t.isLoading)},jn=function(e,t){return e.set("isAuthenticated",!1).set("client",null)},Mn=function(e,t){return e.set("currentFileBrowserDirectoryListing",Object(q.Map)({listing:t.directoryListing,hasMore:t.hasMore,additionalSyncBackendState:t.additionalSyncBackendState}))},Rn=function(e,t){return e.update("currentFileBrowserDirectoryListing",(function(e){return e||Object(q.Map)()})).setIn(["currentFileBrowserDirectoryListing","isLoadingMore"],t.isLoadingMore)},xn=/(\[\[([^\]]*)\]\]|\[\[([^\]]*)\]\[([^\]]*)\]\])|(\[((\d*%)|(\d*\/\d*))\])|(([\s({'"]?)([*/~=_+])([^\s,'](.*)[^\s,'])\11([\s\-.,:!?'")}]?))|(([<[])(\d{4})-(\d{2})-(\d{2})(?: ([^0-9]{1,9}))?(?: ([012]?\d:[0-5]\d))?(?:-([012]?\d:[0-5]\d))?(?: ((?:\+)|(?:\+\+)|(?:\.\+)|(?:-)|(?:--))(\d+)(h|d|w|m|y))?(?: ((?:\+)|(?:\+\+)|(?:\.\+)|(?:-)|(?:--))(\d+)(h|d|w|m|y))?[>\]](?:--([<[])(\d{4})-(\d{2})-(\d{2})(?: ([^0-9]{1,9}))?(?: ([012]?\d:[0-5]\d))?(?:-([012]?\d:[0-5]\d))?(?: ((?:\+)|(?:\+\+)|(?:\.\+)|(?:-)|(?:--))(\d+)(h|d|w|m|y))?(?: ((?:\+)|(?:\+\+)|(?:\.\+)|(?:-)|(?:--))(\d+)(h|d|w|m|y))?[>\]])?)/g,Hn=/([<[])(\d{4})-(\d{2})-(\d{2})(?: ([^0-9]{1,9}))?(?: ([012]?\d:[0-5]\d))?(?:-([012]?\d:[0-5]\d))?(?: ((?:\+)|(?:\+\+)|(?:\.\+)|(?:-)|(?:--))(\d+)(h|d|w|m|y))?(?: ((?:\+)|(?:\+\+)|(?:\.\+)|(?:-)|(?:--))(\d+)(h|d|w|m|y))?[>\]]/,Fn=function(e,t){var n=t.map((function(t){return e[t]})),a=Object(d.a)(n,13),r=a[0],i=a[1],o=a[2],s=a[3],c=a[4],l=a[5],u=a[6],h=a[7],p=a[8],m=a[9],g=a[10],f=a[11],b=a[12];if(!i)return null;var y,v,E,_,T,k,w=l?l.split(":"):[],I=Object(d.a)(w,2),C=I[0],S=I[1],O=u?u.split(":"):[],D=Object(d.a)(O,2),A=D[0],N=D[1];return["+","++",".+"].includes(h)?(y=h,v=p,E=m):["-","--"].includes(h)&&(_=h,T=p,k=m),["+","++",".+"].includes(g)?(y=g,v=f,E=b):["-","--"].includes(g)&&(_=g,T=f,k=b),{isActive:"<"===r,year:i,month:o,day:s,dayName:c,startHour:C,startMinute:S,endHour:A,endMinute:N,repeaterType:y,repeaterValue:v,repeaterUnit:E,delayType:_,delayValue:T,delayUnit:k}},Bn=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.shouldAppendNewline,a=void 0!==n&&n,r=(t.excludeCookies,[]),i=xn.exec(e);i;){if(i[2])r.push({type:"link",rawText:i[0],uri:i[2],index:i.index});else if(i[3]&&i[4])r.push({type:"link",rawText:i[0],uri:i[3],title:i[4],index:i.index});else if(i[7]){var o=i[7].match(/(\d*)%/);r.push({type:"percentage-cookie",rawText:i[0],percentage:o[1],index:i.index})}else if(i[8]){var s=i[8].match(/(\d*)\/(\d*)/);r.push({type:"fraction-cookie",rawText:i[0],fraction:[s[1],s[2]],index:i.index})}else if(i[11]){var c={"~":"inline-code","*":"bold","/":"italic","+":"strikethrough",_:"underline","=":"verbatim"}[i[11]],l=i[10].length;r.push({type:"inline-markup",rawText:i[0].substring(l,i[12].length+2+l),index:i.index+l,content:i[12],markupType:c})}else if(i[15]){var u=Fn(i,X.a.range(16,29)),d=Fn(i,X.a.range(29,42));r.push({type:"timestamp",rawText:i[0],index:i.index,firstTimestamp:u,secondTimestamp:d})}i=xn.exec(e)}var h=[],p=0;if(r.forEach((function(t){var n=t.index;if(n!==p){var a=e.substring(p,n);h.push({type:"text",contents:a})}if("link"===t.type){var r={id:Te(),type:"link",contents:{uri:t.uri}};t.title&&(r.contents.title=t.title),h.push(r)}else"percentage-cookie"===t.type?h.push({id:Te(),type:"percentage-cookie",percentage:t.percentage}):"fraction-cookie"===t.type?h.push({id:Te(),type:"fraction-cookie",fraction:t.fraction}):"inline-markup"===t.type?h.push({id:Te(),type:"inline-markup",content:t.content,markupType:t.markupType}):"timestamp"===t.type&&h.push({id:Te(),type:"timestamp",firstTimestamp:t.firstTimestamp,secondTimestamp:t.secondTimestamp});p=t.index+t.rawText.length})),p!==e.length||a){var m=e.substring(p,e.length)+(a?"\n":"");h.push({type:"text",contents:m})}return h},Un=function(e){var t={id:Te(),type:"table",contents:[[]],columnProperties:[]};e.map((function(e){return e.trim()})).forEach((function(e){if(e.startsWith("|-"))t.contents.push([]);else{var n=X.a.last(t.contents),a=e.substr(1,e.length-2).split("|");0===n.length?a.forEach((function(e){return n.push(e)})):a.forEach((function(e,t){n[t]+="\n".concat(e)}))}})),t.contents=t.contents.map((function(e){return{id:Te(),contents:e.map((function(e){return{id:Te(),contents:Bn(e,{excludeCookies:!0}),rawContents:e}}))}})),0===X.a.last(t.contents).contents.length&&(t.contents=t.contents.slice(0,t.contents.length-1));var n=Math.max.apply(Math,Object(Y.a)(t.contents.map((function(e){return e.contents.length}))));return t.contents.forEach((function(e){e.contents.length<n&&X.a.times(n-e.contents.length,(function(){e.contents.push({id:Te(),contents:[],rawContents:""})}))})),t},Vn=function e(t){for(var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=n.excludeContentElements,r=void 0!==a&&a,i=t.split("\n"),o=/^\s*([-+*]|(\d+(\.|\)))) (.*)/,s=null,c=X.a.flatten(i.map((function(e,t){var n=e.match(/^( *)/)[0].length;return null!==s&&(n>s||!e.trim())?[{type:"raw-list-content",line:e}]:(s=null,e.match(o)&&!r?(s=n,[{type:"raw-list-header",line:e}]):e.trim().startsWith("|")&&!r?[{type:"raw-table",line:e}]:Bn(e,{shouldAppendNewline:t!==i.length-1,excludeCookies:!0}))}))),l=[],u=0;u<c.length;++u){var d=c[u];if("raw-table"===d.type){var h=X.a.takeWhile(c.slice(u),(function(e){return"raw-table"===e.type})).map((function(e){return e.line}));l.push(Un(h)),u+=h.length-1}else"raw-list-header"===d.type?function(){var t=d.line.match(/^( *)/)[0].length,n=X.a.takeWhile(c.slice(u+1),(function(e){return"raw-list-content"===e.type})).map((function(e){return e.line})).map((function(e){return e.startsWith(" ".repeat(t+2))?e.substr(t+2):e.substr(t+1)}));""===n[n.length-1]&&(n[n.length-1]=" ");var a=e(n.join("\n")).toJS();u+=n.length;var r=!!d.line.match(/^\s*\d+[.)]/),i=d.line.match(o)[4],s=null;i.match(/^\s*\[@\d+\]/)&&(s=i.match(/^\s*\[@(\d+)\]/)[1],i=i.replace(/^\s*\[@\d+\]\s*/,""));var h=null,p=!!i.match(/^\s*\[[ X-]\]/);p&&(h={" ":"unchecked",X:"checked","-":"partial"}[i.match(/^\s*\[([ X-])\]/)[1]],i=i.replace(/^\s*\[[ X-]\]\s*/,""));var m={id:Te(),titleLine:Bn(i),contents:a,forceNumber:s,isCheckbox:p,checkboxState:h},g=l.length-1;g>=0&&"list"===l[g].type?l[g].items.push(m):l.push({type:"list",id:Te(),items:[m],bulletCharacter:d.line.trim()[0],numberTerminatorCharacter:r?d.line.match(/\s*\d+([.)])/)[1]:null,isOrdered:r})}():l.push(d)}return Object(q.fromJS)(l)},Wn=function(e){var t=function(e){var t=Yn(/(DEADLINE|SCHEDULED|CLOSED):\s*/,Hn),n=RegExp("("+t.toString().substring(1,t.toString().length-1)+")?"),a=Yn(/^\s*/,n,/\s*/,n,/\s*/,n,/\s*/),r=e.match(a),i=Object(q.fromJS)([2,17,32].map((function(e){var t=r[e];return t?{type:t,timestamp:Fn(r,X.a.range(e+1,e+1+13)),id:Te()}:null})).filter((function(e){return!!e})));return i.size>0?{planningItems:i,strippedDescription:e.split("\n").filter((function(e){return!e.includes(r[0].trim())})).join("\n")}:{planningItems:Object(q.fromJS)([]),strippedDescription:e}}(e),n=function(e){var t=e.split("\n"),n=t.findIndex((function(e){return":PROPERTIES:"===e.trim()})),a=t.findIndex((function(e){return":END:"===e.trim()}));return-1!==n&&-1!==a&&e.trim().startsWith(":PROPERTIES:")?{propertyListItems:Object(q.fromJS)(t.slice(n+1,a).map((function(e){var t=e.match(/:([^\s]*):(?: (.*))?/);if(!t)return null;var n=t[2]?Bn(t[2]):null;return{property:t[1],value:n,id:Te()}})).filter((function(e){return!!e}))),strippedDescription:t.slice(a+1).join("\n")}:{propertyListItems:Object(q.List)(),strippedDescription:e}}(t.strippedDescription),a=function(e){var t=e.split("\n"),n=t.findIndex((function(e){return":LOGBOOK:"===e.trim()})),a=t.findIndex((function(e){return":END:"===e.trim()}));if(-1===n||-1===a||!e.trim().startsWith(":LOGBOOK:"))return{logBookEntries:Object(q.List)(),strippedDescription:e};var r=Yn(/^CLOCK: /,Hn,/$/),i=Yn(/^CLOCK: /,Hn,"/--/",Hn,/\s*=>\s*\S+$/);return{logBookEntries:Object(q.fromJS)(t.slice(n+1,a).map((function(e){var t=e.trim().match(i);if(t)return{start:Fn(t,X.a.range(1,14)),end:Fn(t,X.a.range(14,31)),id:Te()};var n=e.trim().match(r);return n?{start:Fn(n,X.a.range(1,14)),end:null,id:Te()}:{raw:e.trimLeft(),id:Te()}}))),strippedDescription:t.slice(a+1).join("\n")}}(n.strippedDescription);return{planningItems:t.planningItems,propertyListItems:n.propertyListItems,strippedDescription:a.strippedDescription,logBookEntries:a.logBookEntries}},Gn=Object(q.fromJS)([{keywords:["TODO","DONE"],completedKeywords:["DONE"],default:!0}]),Kn=function(e,t){var n=t.flatMap((function(e){return e.get("keywords")})).filter((function(t){return e.startsWith(t+" ")})).first(),a=e;n&&(a=a.substr(n.length+1));var r=[];if(a.trimRight().endsWith(":")){var i=a.trimRight().split(" "),o=i[i.length-1];/^:[^\s]+:$/.test(o)&&(a=a.substr(0,a.length-o.length),r=o.split(":").filter((function(e){return""!==e})))}var s=Bn(a);return Object(q.fromJS)({title:s,rawTitle:a,todoKeyword:n,tags:r})},zn=function(e,t,n){0===n.size&&(n=Gn);var a=Kn(e,n);return Object(q.fromJS)({titleLine:a,rawDescription:"",description:[],opened:!1,id:Te(),nestingLevel:t,planningItems:[],propertyListItems:[],logBookEntries:[]})},Yn=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce((function(e,t){return RegExp(e.toString().substring(1,e.toString().length-1)+t.toString().substring(1,t.toString().length-1))}))},Jn=function(e){var t=new q.List,n=e.split("\n"),a=new q.List,r=new q.List,i=new q.List;return n.forEach((function(e){if(e.match(/^\*+\ /)){var n=e.indexOf(" ");-1===n&&(n=e.length);var o=e.substr(n+1);t=t.push(zn(o,n,a))}else if(0===t.size)if(e.startsWith("#+TODO: ")||e.startsWith("#+TYP_TODO: ")){var s=e.substr(e.indexOf(":")+2).split(/\s/),c=s.filter((function(e){return"|"!==e})),l=s.indexOf("|"),u=l>=0?c.slice(l):[];a=a.push(Object(q.fromJS)({keywords:c,completedKeywords:u,configLine:e,default:!1}))}else e.startsWith("#+")?r=r.push(e):i=i.push(e);else t=t.updateIn([t.size-1,"rawDescription"],(function(t){return e||t?0===t.length?e:t+"\n"+e:"\n"}))})),0===a.size&&(a=Gn),t=t.map((function(e){var t=Wn(e.get("rawDescription")),n=t.planningItems,a=t.propertyListItems,r=t.strippedDescription,i=t.logBookEntries;return e.set("rawDescription",r).set("description",Vn(r)).set("planningItems",n).set("propertyListItems",a).set("logBookEntries",i)})),Object(q.fromJS)({headers:t,todoKeywordSets:a,fileConfigLines:r,linesBeforeHeadings:i})},Xn=function(e,t){var n=Jn(t.contents);return e.set("path",t.path).set("contents",t.contents).set("headers",n.get("headers")).set("todoKeywordSets",n.get("todoKeywordSets")).set("fileConfigLines",n.get("fileConfigLines")).set("linesBeforeHeadings",n.get("linesBeforeHeadings"))},qn=function(e){return e.set("path",null).set("contents",null).set("headers",null).set("todoKeywordSets",null).set("fileConfigLines",null).set("linesBeforeHeadings",null)},$n=function(e,t){var n=e.get("headers"),a=ke(n,t.headerId);return e.setIn(["headers",a,"opened"],!0)},Qn=function(e,t){var n=e.get("headers"),a=ke(n,t.headerId),r=we(n,t.headerId).get("opened");if(r&&e.get("focusedHeaderId")===t.headerId)return e;r&&Ie(n,t.headerId).forEach((function(t){e=e.setIn(["headers",a+t+1,"opened"],!1)}));return e.setIn(["headers",a,"opened"],!r)},Zn=function(e,t){return e.set("selectedHeaderId",t.headerId)},ea=function(e,t){for(var n=e.get("headers"),a=t.headerId,r=Se(n,a);r;){var i=ke(n,r);n=n.setIn([i,"opened"],!0),r=Se(n,r)}return e.set("headers",n)},ta=function(e,t){var n=t.filter((function(e){return e})).length,a=t.length;return e.map((function(e){switch(e.get("type")){case"fraction-cookie":return e.set("fraction",Object(q.List)([n,a]));case"percentage-cookie":return e.set("percentage",Math.floor(n/a*100));default:return e}}))},na=function(e,t){for(var n=e.get("headers"),a=ke(n,t),r=Ie(n,t),i=[],o=0;o<r.size;++o){var s=r.get(o);i.push(s),o+=Ie(n,s.get("id")).size}var c=i.map((function(e){return e.getIn(["titleLine","todoKeyword"])})).filter((function(e){return!!e})).map((function(t){return He(e.get("todoKeywordSets"),t).get("completedKeywords").contains(t)}));return 0===c.length&&(c=n.get(a).get("description").filter((function(e){return"list"===e.get("type")})).flatMap((function(e){return e.get("items")})).filter((function(e){return e.get("isCheckbox")})).map((function(e){return"checked"===e.get("checkboxState")})).toJS()),e.updateIn(["headers",a,"titleLine","title"],(function(e){return ta(e,c)})).updateIn(["headers",a,"titleLine"],(function(e){return e.set("rawTitle",ve(e.get("title")))}))},aa=function(e,t){var n=Se(e.get("headers"),t);return n?na(e,n):e},ra=function(e,t){var n=t.headerId||e.get("selectedHeaderId");if(!n)return e;var a=e.get("headers"),r=we(a,n),i=ke(a,n),o=r.getIn(["titleLine","todoKeyword"]),s=He(e.get("todoKeywordSets"),o),c=s.get("keywords").indexOf(o)+1,l=s.get("keywords").get(c)||"";return e=function(e,t,n,a,r,i){a=e.get("completedKeywords").includes(t)&&n.size>0?function(e,t,n,a,r,i){if(e.forEach((function(e){var a=Object(d.a)(e,2),r=a[0],i=a[1];t=t.setIn(["headers",n,"planningItems",i,"timestamp"],fe(r.get("timestamp"),new Date))})),!function(e){var t=e.state,n=e.headerIndex,a=t.get("fileConfigLines").some((function(e){return e.match(/^#\+STARTUP:.*nologrepeat.*/)})),r=Oe(t.get("headers"),n,"LOGGING");return!!(a||r&&r.some((function(e){return"text"===e.get("type")&&e.get("contents").match(/\s*nologrepeat\s*/)})))}({state:t=t.setIn(["headers",n,"titleLine","todoKeyword"],a.get("keywords").first()),headerIndex:n})){var o=he({isActive:!1,withStartTime:!0}),s=[{type:"timestamp",id:Te(),firstTimestamp:o,secondTimestamp:null}];t=(t=t.updateIn(["headers",n,"propertyListItems"],(function(e){return e.some((function(e){return"LAST_REPEAT"===e.get("property")}))?e.map((function(e){return"LAST_REPEAT"===e.get("property")?e.set("value",Object(q.fromJS)(s)):e})):e.push(Object(q.fromJS)({property:"LAST_REPEAT",value:s,id:Te()}))}))).updateIn(["headers",n],(function(e){var t=e.get("rawDescription");return t.startsWith("\n")&&(t=t.slice(1)),t='\n- State "'.concat(r,'"       from "').concat(i,'"       ').concat(de(Object(q.fromJS)(o)),"\n")+t,e.set("rawDescription",t).set("description",Vn(t))}))}return t}(n,a,r,e,t,i):a.setIn(["headers",r,"titleLine","todoKeyword"],t);return a}(s,l,r.get("planningItems").map((function(e,t){return[e,t]})).filter((function(e){return!!Object(d.a)(e,1)[0].getIn(["timestamp","repeaterType"])})),e,i,o),e=aa(e,n)},ia=function(e,t){return e.set("editMode",t.editModeType)},oa=function(e){return e.set("editMode",null)},sa=function(e,t){var n=e.get("headers"),a=ke(n,t.headerId),r=Kn(t.newRawTitle,e.get("todoKeywordSets"));return e=e.setIn(["headers",a,"titleLine"],r),aa(e,t.headerId)},ca=function(e,t){var n=e.get("headers"),a=ke(n,t.headerId);return e.updateIn(["headers",a],(function(e){var n=Wn(t.newRawDescription),a=n.planningItems,r=n.propertyListItems,i=n.strippedDescription;return e.set("rawDescription",i).set("description",Vn(i)).set("planningItems",a).set("propertyListItems",r)}))},la=function(e,t){var n=e.get("headers"),a=we(n,t.headerId),r=ke(n,t.headerId),i=Ie(n,t.headerId),o=zn("",a.get("nestingLevel"),e.get("todoKeywordSets"));return t.headerId===e.get("focusedHeaderId")&&(e=e.set("focusedHeaderId",null)),e.update("headers",(function(e){return e.insert(r+i.size+1,o)}))},ua=function(e,t){var n=e.get("headers"),a=we(n,t.headerId),r=ke(n,t.headerId),i=Ie(n,t.headerId),o=n.get(r+i.size+1);return o&&o.get("nestingLevel")===a.get("nestingLevel")?e.set("selectedHeaderId",o.get("id")):e},da=function(e){var t=e.get("headers");if(void 0===e.get("selectedHeaderId"))return e.set("selectedHeaderId",t.getIn([0,"id"]));var n=function(e,t){return e.slice(t+1).find((function(t){return De(e,t.get("id"))}))}(t,ke(t,e.get("selectedHeaderId")));return n?e.set("selectedHeaderId",n.get("id")):e},ha=function(e){var t=e.get("headers"),n=function(e,t){return e.slice(0,t).reverse().find((function(t){return De(e,t.get("id"))}))}(t,ke(t,e.get("selectedHeaderId")));return n?e.set("selectedHeaderId",n.get("id")):e},pa=function(e,t){var n=e.get("headers"),a=ke(n,t.headerId),r=1+Ie(n,t.headerId).size,i=Se(n,t.headerId);return X.a.times(r).forEach((function(){n=n.delete(a)})),t.headerId===e.get("focusedHeaderId")&&(e=e.set("focusedHeaderId",null)),e=e.set("headers",n),i&&(e=na(e,i)),e},ma=function(e,t){var n=e.get("headers"),a=ke(n,t.headerId),r=function(e,t){for(var n=e.getIn([t,"nestingLevel"]),a=t-1;a>=0;--a){var r=e.get(a);if(r.get("nestingLevel")<n)return null;if(r.get("nestingLevel")===n)return a}return null}(n,a);if(null===r)return e;var i=Ie(n,t.headerId);return X.a.times(1+i.size).forEach((function(){n=(n=n.insert(r,n.get(a+i.size))).delete(a+i.size+1)})),e.set("headers",n)},ga=function(e,t){var n=e.get("headers"),a=we(n,t.headerId),r=ke(n,t.headerId),i=Ie(n,t.headerId),o=r+i.size+1,s=n.get(o);if(s.get("nestingLevel")<a.get("nestingLevel"))return e;var c=Ie(n,s.get("id"));return X.a.times(1+c.size).forEach((function(){n=(n=n.insert(r,n.get(o+c.size))).delete(o+c.size+1)})),e.set("headers",n)},fa=function(e,t){var n=e.get("headers"),a=ke(n,t.headerId),r=Se(n,t.headerId);return e=$a(e=Qa({state:e,headerIndex:a},"-"),r,t)},ba=function(e,t){var n=e.get("headers"),a=ke(n,t.headerId),r=Se(n,t.headerId);return e=Qa({state:e,headerIndex:a},"+"),e=$a(e=Ae(e,t.headerId),r,t)},ya=function(e,t){var n=e.get("headers"),a=we(n,t.headerId),r=ke(n,t.headerId),i=Se(n,t.headerId);return 1===a.get("nestingLevel")?e:e=$a(e=Qa({state:e,headerIndex:r,subheaders:Ie(n,t.headerId)},"-"),i,t)},va=function(e,t){var n=e.get("headers"),a=ke(n,t.headerId),r=Se(n,t.headerId);return e=$a(e=Qa({state:e,headerIndex:a,subheaders:Ie(n,t.headerId)},"+"),r,t),Ae(e,t.headerId)},Ea=function(e,t){return e.set("focusedHeaderId",t.headerId)},_a=function(e){return e.set("focusedHeaderId",null)},Ta=function(e){var t=e.get("opennessState");if(!t)return e;var n=t.get(e.get("path"));if(!n||0===n.size)return e;var a=e.get("headers");return n.forEach((function(e){a=function e(t,n){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(0===n.size)return t;var r=n.first(),i=t.findIndex((function(e){var t=e.getIn(["titleLine","rawTitle"]),n=e.get("nestingLevel");return t===r&&n<=a}));if(-1===i)return t;t=t.update(i,(function(e){return e.set("opened",!0)}));var o=Ie(t,t.getIn([i,"id"]));return o=e(o,n.rest(),a+1),t=t.take(i+1).concat(o).concat(t.takeLast(t.size-(i+1+o.size)))}(a,e)})),e.set("headers",a)},ka=function(e,t){return e.set("isDirty",t.isDirty)},wa=function(e,t){return e.set("selectedTableCellId",t.cellId)},Ia=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=e.get("headers");n||(n=Le(a,t));var r=ke(a,n.get("id"));return e.updateIn(["headers",r],(function(e){return e.set("rawDescription",ve(e.get("description")))}))},Ca=function(e){var t=e.get("selectedTableCellId");return t?(e=e.update("headers",(function(e){return Re(e,t,(function(e){return function(t){return t.insert(e+1,function(e){return e.get(0).set("id",Te()).update("contents",(function(e){return e.map((function(e){return e.set("id",Te()).set("contents",new q.List).set("rawContents","")}))}))}(t))}}))})),Ia(e,t)):e},Sa=function(e){var t=e.get("selectedTableCellId");if(!t)return e;var n=Le(e.get("headers"),t);return e=(e=e.update("headers",(function(e){return Re(e,t,(function(e){return function(t){return t.delete(e)}}))}))).set("selectedTableCellId",null),Ia(e,t,n)},Oa=function(e){var t=e.get("selectedTableCellId");return t?(e=e.update("headers",(function(e){return Re(e,t,(function(e,t){return function(e){return e.map((function(e){return e.update("contents",(function(e){return e.insert(t+1,Object(q.fromJS)({id:Te(),contents:[],rawContents:""}))}))}))}}))})),Ia(e,t)):e},Da=function(e){var t=e.get("selectedTableCellId");if(!t)return e;var n=Le(e.get("headers"),t);return e=(e=e.update("headers",(function(e){return Re(e,t,(function(e,t){return function(e){return e.map((function(e){return e.update("contents",(function(e){return e.delete(t)}))}))}}))}))).set("selectedTableCellId",null),Ia(e,t,n)},Aa=function(e){var t=e.get("selectedTableCellId");return t?(e=e.update("headers",(function(e){return Re(e,t,(function(e){return function(t){return e+1===t.size?t:t.insert(e,t.get(e+1)).delete(e+2)}}))})),Ia(e,t)):e},Na=function(e){var t=e.get("selectedTableCellId");return t?(e=e.update("headers",(function(e){return Re(e,t,(function(e){return function(t){return 0===e?t:t.insert(e-1,t.get(e)).delete(e+1)}}))})),Ia(e,t)):e},Pa=function(e){var t=e.get("selectedTableCellId");return t?(e=e.update("headers",(function(e){return Re(e,t,(function(e,t){return function(e){return 0===t?e:e.map((function(e){return e.update("contents",(function(e){return 0===e.size?e:e.insert(t-1,e.get(t)).delete(t+1)}))}))}}))})),Ia(e,t)):e},La=function(e){var t=e.get("selectedTableCellId");return t?(e=e.update("headers",(function(e){return Re(e,t,(function(e,t){return function(e){return t+1>=e.getIn([0,"contents"]).size?e:e.map((function(e){return e.update("contents",(function(e){return 0===e.size?e:e.insert(t,e.get(t+1)).delete(t+2)}))}))}}))})),Ia(e,t)):e},ja=function(e,t){return e=e.update("headers",(function(e){return Re(e,t.cellId,(function(e,n){return function(a){return a.updateIn([e,"contents",n],(function(e){return e.set("rawContents",t.newValue).set("contents",Object(q.fromJS)(Bn(t.newValue,{excludeCookies:!0})))}))}}))})),Ia(e,t.cellId)},Ma=function(e,t){var n=e.get("headers"),a=t.template,r=t.content,i=t.shouldPrepend,o=Ne(n,a.get("headerPaths"));if(!o)return e;var s=function(e,t){var n=e.split("\n")[0].replace(/^\**\s*/,""),a=e.split("\n").slice(1).join("\n"),r=Wn(a),i=r.planningItems,o=r.propertyListItems,s=r.strippedDescription,c=r.logBookEntries;return zn(n,1,t).set("rawDescription",s).set("description",Vn(s)).set("planningItems",i).set("propertyListItems",o).set("logBookEntries",c)}(r,e.get("todoKeywordSets")).set("nestingLevel",o.get("nestingLevel")+1),c=ke(n,o.get("id")),l=Ce(n,o.get("id")),u=c+1+(i?0:l);return e=e.update("headers",(function(e){return e.insert(u,s)})),e=na(e,o.get("id"))},Ra=function(e){return e.set("pendingCapture",null)},xa=function(e,t){var n,a,r=(n=e.get("headers"),a=t.listItemId,n.map((function(e,t){var n=function e(t,n){return t.map((function(t,a){return"list"===t.get("type")?t.get("items").map((function(t,r){if(t.get("id")===n)return{path:[a,"items",r],listItemPart:t};var i=e(t.get("contents"),n);if(i){var o=i.path,s=i.listItemPart;return{path:[a,"items",r,"contents"].concat(o),listItemPart:s}}return null})).filter((function(e){return!!e})).first():null})).filter((function(e){return!!e})).first()}(e.get("description"),a);if(!n)return null;var r=n.path,i=n.listItemPart;return{path:[t,"description"].concat(r),listItemPart:i}})).filter((function(e){return!!e})).first()),i=r.path,o=r.listItemPart;if(o.get("contents").filter((function(e){return"list"===e.get("type")})).some((function(e){return e.get("items").some((function(e){return e.get("isCheckbox")}))})))return e;var s={checked:"unchecked",unchecked:"checked",partial:"unchecked"}[o.get("checkboxState")];e=function e(t,n){var a=n.slice(0,n.length-4),r=t.getIn(a);if(!r.has("checkboxState"))return t;var i=r.get("contents").filter((function(e){return"list"===e.get("type")})).flatMap((function(e){return e.get("items").filter((function(e){return e.get("isCheckbox")})).map((function(e){return e.get("checkboxState")}))}));t=i.every((function(e){return"checked"===e}))?t.setIn(a.concat(["checkboxState"]),"checked"):i.every((function(e){return"unchecked"===e}))?t.setIn(a.concat(["checkboxState"]),"unchecked"):t.setIn(a.concat(["checkboxState"]),"partial");var o=i.map((function(e){switch(e){case"checked":return!0;case"unchecked":case"partial":default:return!1}})).toJS();return t=t.updateIn(a.concat("titleLine"),(function(e){return ta(e,o)})),r.get("isCheckbox")?e(t,a):t}(e=e.setIn(["headers"].concat(i).concat(["checkboxState"]),s),["headers"].concat(i));var c=i[0];return e=(e=na(e,e.getIn(["headers",c,"id"]))).updateIn(["headers",c],(function(e){return e.set("rawDescription",ve(e.get("description")))}))},Ha=function(e,t){return e.set("lastSyncAt",t.lastSyncAt)},Fa=function(e,t){var n=e.get("headers"),a=ke(n,t.headerId);return-1===a?e:e.setIn(["headers",a,"titleLine","tags"],t.tags)},Ba=function(e,t){var n=e.get("selectedHeaderId");if(!n)return e;var a=ke(e.get("headers"),n);return e.updateIn(["headers",a,"titleLine","tags"],(function(e){return e.splice(t.fromIndex,1).splice(t.toIndex,0,e.get(t.fromIndex))}))},Ua=function(e,t){var n=t.headerId;if(!n)return e;var a=ke(e.get("headers"),n);return e.updateIn(["headers",a,"propertyListItems"],(function(e){return e.splice(t.fromIndex,1).splice(t.toIndex,0,e.get(t.fromIndex))}))},Va=function(e,t){var n,a,r=(n=e.get("headers"),a=t.timestampId,n.map((function(e,t){var n=je(e.getIn(["titleLine","title"]),a);if(n){var r=n,i=r.path,o=r.timestampPart;return{path:[t,"titleLine","title"].concat(i),timestampPart:o}}if(n=je(e.get("description"),a)){var s=n,c=s.path,l=s.timestampPart;return{path:[t,"description"].concat(c),timestampPart:l}}return(n=e.get("propertyListItems").map((function(e,n){if(!e.get("value"))return null;var r=je(e.get("value"),a);if(r){var i=r.path,o=r.timestampPart;return{path:[t,"propertyListItems",n,"value"].concat(i),timestampPart:o}}return null})).filter((function(e){return!!e})).first())||null})).filter((function(e){return!!e})).first());if(!r)return e;var i=r.path,o=i[0];return e.setIn(["headers"].concat(i),t.newTimestamp).updateIn(["headers",o],(function(e){return e.set("rawDescription",ve(e.get("description")))})).updateIn(["headers",o],(function(e){return e.setIn(["titleLine","rawTitle"],ve(e.getIn(["titleLine","title"])))}))},Wa=function(e,t){var n=t.headerId,a=t.planningItemIndex,r=t.newTimestamp,i=ke(e.get("headers"),n);return e.setIn(["headers",i,"planningItems",a,"timestamp"],r)},Ga=function(e,t){var n=ke(e.get("headers"),t.headerId),a=Object(q.fromJS)({id:Te(),type:t.planningType,timestamp:he()});return e.updateIn(["headers",n,"planningItems"],(function(e){return e?e.push(a):Object(q.List)([a])}))},Ka=function(e,t){var n=ke(e.get("headers"),t.headerId),a=t.planningItemIndex;return e.removeIn(["headers",n,"planningItems",a])},za=function(e,t){var n=ke(e.get("headers"),t.headerId);return e.setIn(["headers",n,"propertyListItems"],t.newPropertyListItems)},Ya=function(e,t){var n=t.headerId,a=t.entryId,r=t.time,i=ke(e.get("headers"),n),o=e.getIn(["headers",i,"logBookEntries"]).findIndex((function(e){return e.get("id")===a}));return e.setIn(["headers",i,"logBookEntries",o,"end"],Object(q.fromJS)(r))},Ja=function(e,t){var n=t.headerId,a=t.time,r=ke(e.get("headers"),n),i=Object(q.fromJS)({id:Te(),start:a,end:null});return e.updateIn(["headers",r,"logBookEntries"],(function(e){return e?e.unshift(i):Object(q.List)([i])}))},Xa=function(e,t){var n=t.headerId,a=t.entryIndex,r=t.entryType,i=t.newTime,o=ke(e.get("headers"),n);return e.setIn(["headers",o,"logBookEntries",a,r],Object(q.fromJS)(i))},qa=function(e,t){return e.set("orgFileErrorMessage",t.message)};function $a(e,t,n){return e=na(e,t),e=aa(e,n.headerId)}function Qa(e){var t=e.state,n=e.headerIndex,a=e.subheaders,r=void 0===a?[]:a,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"-";return t=t.updateIn(["headers",n,"nestingLevel"],o()),r.forEach((function(e,a){t=t.updateIn(["headers",n+a+1,"nestingLevel"],o())})),t;function o(){return function(e){return"-"===i?Math.max(e-1,1):e+1}}}var Za=function(e,t){return e.findIndex((function(e){return e.get("id")===t}))},er=function(e){return e.get("captureTemplates")||(e=e.set("captureTemplates",new q.List)),e.update("captureTemplates",(function(e){return e.push(Object(q.fromJS)({id:Te(),description:"",letter:"",iconName:"",isAvailableInAllOrgFiles:!0,orgFilesWhereAvailable:[""],headerPaths:[""],shouldPrepend:!1,template:""}))}))},tr=function(e,t){var n=Za(e.get("captureTemplates"),t.templateId);return e.setIn(["captureTemplates",n].concat(t.fieldPath),t.newValue)},nr=function(e,t){var n=Za(e.get("captureTemplates"),t.templateId);return e.updateIn(["captureTemplates",n,"orgFilesWhereAvailable"],(function(e){return e.push("")}))},ar=function(e,t){var n=Za(e.get("captureTemplates"),t.templateId);return e.updateIn(["captureTemplates",n,"orgFilesWhereAvailable"],(function(e){return e.delete(t.orgFileAvailabilityIndex)}))},rr=function(e,t){var n=Za(e.get("captureTemplates"),t.templateId);return e.updateIn(["captureTemplates",n,"headerPaths"],(function(e){return e.push("")}))},ir=function(e,t){var n=Za(e.get("captureTemplates"),t.templateId);return e.updateIn(["captureTemplates",n,"headerPaths"],(function(e){return e.delete(t.headerPathIndex)}))},or=function(e,t){var n=Za(e.get("captureTemplates"),t.templateId);return e.update("captureTemplates",(function(e){return e.delete(n)}))},sr=function(e,t){return t.newSettings?function(e,t){var n=Object(q.fromJS)(JSON.parse(t.captureTemplates)).map((function(e){return e.set("id",Te())}));return e.set("captureTemplates",n)}(e,t.newSettings):e},cr=function(e,t){return e.update("captureTemplates",(function(e){return e.splice(t.fromIndex,1).splice(t.toIndex,0,e.get(t.fromIndex))}))},lr=Object(v.c)({base:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new q.Map,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_LOADING_MESSAGE":return pn(e,t);case"HIDE_LOADING_MESSAGE":return mn(e);case"SET_FONT_SIZE":return gn(e,t);case"SET_BULLET_STYLE":return fn(e,t);case"SET_SHOULD_TAP_TODO_TO_ADVANCE":return bn(e,t);case"SET_AGENDA_DEFAULT_DEADLINE_DELAY_UNIT":return yn(e,t);case"SET_AGENDA_DEFAULT_DEADLINE_DELAY_VALUE":return vn(e,t);case"SET_SHOULD_STORE_SETTINGS_IN_SYNC_BACKEND":return En(e,t);case"SET_SHOULD_LIVE_SYNC":return _n(e,t);case"SET_SHOULD_SYNC_ON_BECOMING_VISIBLE":return Tn(e,t);case"SET_HAS_UNSEEN_CHANGELOG":return kn(e,t);case"SET_LAST_SEEN_CHANGELOG_HEADER":return wn(e,t);case"SET_LAST_VIEWED_FILE":return In(e,t);case"SET_CUSTOM_KEYBINDING":return Cn(e,t);case"RESTORE_BASE_SETTINGS":return Sn(e,t);case"PUSH_MODAL_PAGE":return On(e,t);case"POP_MODAL_PAGE":return Dn(e);case"CLEAR_MODAL_STACK":return An(e);case"ACTIVATE_POPUP":return Nn(e,t);case"CLOSE_POPUP":return Pn(e);case"SET_IS_LOADING":return Ln(e,t);default:return e}},syncBackend:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new q.Map,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SIGN_OUT":return jn(e);case"SET_CURRENT_FILE_BROWSER_DIRECTORY_LISTING":return Mn(e,t);case"SET_IS_LOADING_MORE_DIRECTORY_LISTING":return Rn(e,t);default:return e}},org:T()((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new q.Map,t=arguments.length>1?arguments[1]:void 0;switch(t.dirtying&&(e=e.set("isDirty",!0)),t.type){case"DISPLAY_FILE":return Xn(e,t);case"STOP_DISPLAYING_FILE":return qn(e);case"TOGGLE_HEADER_OPENED":return Qn(e,t);case"OPEN_HEADER":return $n(e,t);case"SELECT_HEADER":return Zn(e,t);case"OPEN_PARENTS_OF_HEADER":return ea(e,t);case"ADVANCE_TODO_STATE":return ra(e,t);case"ENTER_EDIT_MODE":return ia(e,t);case"EXIT_EDIT_MODE":return oa(e);case"UPDATE_HEADER_TITLE":return sa(e,t);case"UPDATE_HEADER_DESCRIPTION":return ca(e,t);case"ADD_HEADER":return la(e,t);case"SELECT_NEXT_SIBLING_HEADER":return ua(e,t);case"SELECT_NEXT_VISIBLE_HEADER":return da(e);case"SELECT_PREVIOUS_VISIBLE_HEADER":return ha(e);case"REMOVE_HEADER":return pa(e,t);case"MOVE_HEADER_UP":return ma(e,t);case"MOVE_HEADER_DOWN":return ga(e,t);case"MOVE_HEADER_LEFT":return fa(e,t);case"MOVE_HEADER_RIGHT":return ba(e,t);case"MOVE_SUBTREE_LEFT":return ya(e,t);case"MOVE_SUBTREE_RIGHT":return va(e,t);case"APPLY_OPENNESS_STATE":return Ta(e);case"SET_DIRTY":return ka(e,t);case"FOCUS_HEADER":return Ea(e,t);case"UNFOCUS_HEADER":return _a(e);case"SET_SELECTED_TABLE_CELL_ID":return wa(e,t);case"ADD_NEW_TABLE_ROW":return Ca(e);case"REMOVE_TABLE_ROW":return Sa(e);case"ADD_NEW_TABLE_COLUMN":return Oa(e);case"REMOVE_TABLE_COLUMN":return Da(e);case"MOVE_TABLE_ROW_DOWN":return Aa(e);case"MOVE_TABLE_ROW_UP":return Na(e);case"MOVE_TABLE_COLUMN_LEFT":return Pa(e);case"MOVE_TABLE_COLUMN_RIGHT":return La(e);case"UPDATE_TABLE_CELL_VALUE":return ja(e,t);case"INSERT_CAPTURE":return Ma(e,t);case"CLEAR_PENDING_CAPTURE":return Ra(e);case"ADVANCE_CHECKBOX_STATE":return xa(e,t);case"SET_LAST_SYNC_AT":return Ha(e,t);case"SET_HEADER_TAGS":return Fa(e,t);case"REORDER_TAGS":return Ba(e,t);case"REORDER_PROPERTY_LIST":return Ua(e,t);case"UPDATE_TIMESTAMP_WITH_ID":return Va(e,t);case"UPDATE_PLANNING_ITEM_TIMESTAMP":return Wa(e,t);case"ADD_NEW_PLANNING_ITEM":return Ga(e,t);case"REMOVE_PLANNING_ITEM":return Ka(e,t);case"UPDATE_PROPERTY_LIST_ITEMS":return za(e,t);case"SET_ORG_FILE_ERROR_MESSAGE":return qa(e,t);case"SET_LOG_ENTRY_STOP":return Ya(e,t);case"CREATE_LOG_ENTRY_START":return Ja(e,t);case"UPDATE_LOG_ENTRY_TIME":return Xa(e,t);default:return e}}),{filter:Object(_.includeAction)(["ADD_HEADER","REMOVE_HEADER","MOVE_HEADER_UP","MOVE_HEADER_DOWN","MOVE_HEADER_LEFT","MOVE_HEADER_RIGHT","MOVE_SUBTREE_LEFT","MOVE_SUBTREE_RIGHT","ADVANCE_TODO_STATE","EDIT_HEADER_TITLE","EDIT_HEADER_DESCRIPTION","ADD_NEW_TABLE_ROW","ADD_NEW_TABLE_COLUMN","MOVE_TABLE_ROW_DOWN","MOVE_TABLE_ROW_UP","MOVE_TABLE_COLUMN_LEFT","MOVE_TABLE_COLUMN_RIGHT","INSERT_CAPTURE"])}),capture:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new q.Map,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_NEW_EMPTY_CAPTURE_TEMPLATE":return er(e);case"UPDATE_TEMPLATE_FIELD_PATH_VALUE":return tr(e,t);case"ADD_NEW_TEMPLATE_ORG_FILE_AVAILABILITY":return nr(e,t);case"REMOVE_TEMPLATE_ORG_FILE_AVAILABILITY":return ar(e,t);case"ADD_NEW_TEMPLATE_HEADER_PATH":return rr(e,t);case"REMOVE_TEMPLATE_HEADER_PATH":return ir(e,t);case"DELETE_TEMPLATE":return or(e,t);case"RESTORE_CAPTURE_SETTINGS":return sr(e,t);case"REORDER_CAPTURE_TEMPLATE":return cr(e,t);default:return e}}}),ur=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||v.d,dr=function(e){return Object(v.e)(lr,e,ur(Object(v.a)(E.a,Gt,zt)))},hr=function(){!function(){if(nn){var e=localStorage.getItem("accessToken");e&&(localStorage.setItem("dropboxAccessToken",e),localStorage.removeItem("accessToken"))}}(),function(){if(nn){var e=localStorage.getItem("shouldStoreSettingsInDropbox");e&&(localStorage.setItem("shouldStoreSettingsInSyncBackend",e),localStorage.removeItem("shouldStoreSettingsInDropbox"))}}()},pr=function(e){var t=Object.create(null);return"string"!==typeof e?t:(e=e.trim().replace(/^(\?|#|&)/,""))?(e.split("&").forEach((function(e){var n=e.replace(/\+/g," ").split("="),a=n.shift(),r=n.length>0?n.join("="):void 0;a=decodeURIComponent(a),r=void 0===r?null:decodeURIComponent(r),void 0===t[a]?t[a]=r:Array.isArray(t[a])?t[a].push(r):t[a]=[t[a],r]})),t):t},mr=n(22),gr=n(34),fr=function(){return function(e,t){switch(t().syncBackend.get("client",{}).type){case"WebDAV":["Endpoint","Username","Password"].forEach((function(e){dn("webdav"+e,null)}));break;case"Dropbox":dn("dropboxAccessToken",null);break;case"Google Drive":gapi.auth2.getAuthInstance().signOut()}dn("authenticatedSyncService",null),e({type:"SIGN_OUT"}),e(G()),e(w())}},br=function(e,t,n){return{type:"SET_CURRENT_FILE_BROWSER_DIRECTORY_LISTING",directoryListing:e,hasMore:t,additionalSyncBackendState:n}},yr=function(e){return{type:"SET_IS_LOADING_MORE_DIRECTORY_LISTING",isLoadingMore:e}},vr=function(e){return function(t,n){t(k("Getting listing...")),n().syncBackend.get("client").getDirectoryListing(e).then((function(e){var n=e.listing,a=e.hasMore,r=e.additionalSyncBackendState;t(br(n,a,r)),t(w())})).catch((function(e){alert("There was an error retrieving files!"),console.error(e),t(w())}))}},Er=function(){return function(e,t){e(yr(!0));var n=t().syncBackend.get("client"),a=t().syncBackend.get("currentFileBrowserDirectoryListing");n.getMoreDirectoryListing(a.get("additionalSyncBackendState")).then((function(t){var n=t.listing,r=t.hasMore,i=t.additionalSyncBackendState,o=a.get("listing").concat(n);e(br(o,r,i)),e(yr(!1))}))}},_r=function(e,t){return function(n,a){var r=a().syncBackend.get("client");switch(r.type){case"Dropbox":case"WebDAV":r.createFile("".concat(e,".organice-bak"),t);break;case"Google Drive":e=e.startsWith("/")?e.substr(1):e,r.duplicateFile(e,(function(e){return"".concat(e,".organice-bak")}))}}},Tr=function(e){return function(t,n){t(k("Downloading file...")),n().syncBackend.get("client").getFileContents(e).then((function(n){t(bt(!1)),t(w()),t(_r(e,n)),t(Ge(Object(Ue.a)(new Date,5))),t(We(e,n)),t(ft()),t(_.ActionCreators.clearHistory())})).catch((function(){t(w()),t(I(!1)),t(Bt("File not found"))}))}},kr=n(97),wr=function(e){var t=new kr.Dropbox({accessToken:e,fetch:fetch}),n=function(e){var t=function(e){return e.filter((function(e){return"folder"===e[".tag"]||e.name.match(/org$|org_archive$/)})).sort((function(e,t){return"folder"===e[".tag"]&&"file"===t[".tag"]?-1:e.name>t.name?1:-1}))}(e);return Object(q.fromJS)(t.map((function(e){return{id:e.id,name:e.name,isDirectory:"folder"===e[".tag"],path:e.path_display}})))},a=function(e,n){return new Promise((function(a,r){return t.filesUpload({path:e,contents:n,mode:{".tag":"overwrite"},autorename:!0}).then(a).catch(r)}))},r=function(e){return new Promise((function(n,a){return t.filesDownload({path:e}).then((function(e){var t=new FileReader;t.addEventListener("loadend",(function(){return n({contents:t.result,lastModifiedAt:e.server_modified})})),t.readAsText(e.fileBlob)})).catch((function(e){var t=function(){try{return"not_found"===JSON.parse(e.error).error.path[".tag"]}catch(t){return!1}}();("string"===typeof e&&e.match(/missing required field 'path'/)||t)&&a()}))}))};return{type:"Dropbox",isSignedIn:function(){return new Promise((function(e){return e(!0)}))},getDirectoryListing:function(e){return new Promise((function(a,r){t.filesListFolder({path:e}).then((function(e){return a({listing:n(e.entries),hasMore:e.has_more,additionalSyncBackendState:Object(q.Map)({cursor:e.cursor})})})).catch(r)}))},getMoreDirectoryListing:function(e){var a=e.get("cursor");return new Promise((function(e,r){return t.filesListFolderContinue({cursor:a}).then((function(t){return e({listing:n(t.entries),hasMore:t.has_more,additionalSyncBackendState:Object(q.Map)({cursor:t.cursor})})}))}))},updateFile:a,createFile:a,getFileContentsAndMetadata:r,getFileContents:function(e){return Object(J.isEmpty)(e)?Promise.reject("No path given"):new Promise((function(t,n){return r(e).then((function(e){var n=e.contents;return t(n)})).catch(n)}))},deleteFile:function(e){return new Promise((function(n,a){return t.filesDelete({path:e}).then(n).catch((function(e){return a("path_lookup"===e.error.error[".tag"],e)}))}))}}},Ir=function(){var e=function(){var e=!1,t=!1,n=[];return function(){return new Promise((function(a,r){e?a(window.gapi):window.gapi&&!t?(t=!0,new Promise((function(e,t){return window.gapi.load("client:auth2",(function(){window.location.hash=window.initialHash,window.gapi.client.init({client_id:Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_GOOGLE_DRIVE_CLIENT_ID,discoveryDocs:["https://www.googleapis.com/discovery/v1/apis/drive/v3/rest"],scope:"https://www.googleapis.com/auth/drive.file"}).then(e)}))})).then((function(){e=!0,n.forEach((function(e){return e(window.gapi)})),a(window.gapi)}))):n.push(a)}))}}();window.gapi?e():window.handleGoogleDriveClientLoad=e;var t=function(e){return Object(q.fromJS)(e.map((function(e){return{id:e.id,name:e.name,isDirectory:"application/vnd.google-apps.folder"===e.mimeType,path:"/".concat(e.id)}})))},n=function(n){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=new Promise((function(r,i){e().then((function(e){e.client.drive.files.list({pageSize:30,fields:"nextPageToken, files(id, name, mimeType, parents)",q:"'".concat(""===n?"root":n,"' in parents and trashed = false"),pageToken:a}).then((function(e){r({listing:t(e.result.files),hasMore:!!e.result.nextPageToken,additionalSyncBackendState:Object(q.Map)({currentDirectoryId:n,nextPageToken:e.result.nextPageToken})})})).catch(i)}))})),i=new Promise((function(t,a){""===n?t(null):e().then((function(e){return e.client.drive.files.get({fileId:n,fields:"parents"})})).then((function(e){e.result.parents?t(e.result.parents[0]):t(null)})).catch(a)})),o=new Promise((function(t,n){window.rootFolderId?t(window.rootFolderId):e().then((function(e){return e.client.drive.files.get({fileId:"root",fields:"id"})})).then((function(e){window.rootFolderId=e.result.id,t(e.result.id)})).catch(n)}));return new Promise((function(e,t){Promise.all([r,i,o]).then((function(t){var n=Object(d.a)(t,3),a=n[0],r=n[1],i=r===n[2]?"":r;a.additionalSyncBackendState=a.additionalSyncBackendState.set("parentId",i),e(a)}))}))},a=function(t,n){return new Promise((function(a,r){e().then((function(e){return e.client.drive.files.list({pageSize:1,fields:"files(id)",q:"'".concat(n,"' in parents and trashed = false and name = '").concat(t,"'")})})).then((function(e){return a(e.result.files.length>0?e.result.files[0].id:null)})).catch(r)}))},r=function(t,n){return t=t.startsWith("/")?t.substr(1):t,e().then((function(e){fetch("https://www.googleapis.com/upload/drive/v3/files/".concat(t,"?uploadType=media"),{method:"PATCH",headers:{Authorization:"Bearer ".concat(e.auth.getToken().access_token)},body:n})}))},i=function(t){return new Promise((function(n,a){e().then((function(e){t=t.startsWith("/")?t.substr(1):t;var r=new Promise((function(n){e.client.drive.files.get({fileId:t,alt:"media"}).then((function(e){return n(decodeURIComponent(escape(e.body)))})).catch((function(e){e.body&&"notFound"===JSON.parse(e.body).error.errors[0].reason&&a()}))})),i=new Promise((function(n){e.client.drive.files.get({fileId:t,fields:"modifiedTime"}).then((function(e){n(e.result.modifiedTime)})).catch((function(e){e.body&&"notFound"===JSON.parse(e.body).error.errors[0].reason&&a()}))}));Promise.all([r,i]).then((function(e){var t=Object(d.a)(e,2),a=t[0],r=t[1];n({contents:a,lastModifiedAt:r})}))}))}))},o=function(e){return new Promise((function(t,n){return i(e).then((function(e){var n=e.contents;return t(n)})).catch(n)}))};return{type:"Google Drive",isSignedIn:function(){return new Promise((function(t,n){return e().then((function(e){return t(e.auth2.getAuthInstance().isSignedIn.get())}))}))},getDirectoryListing:function(e){return n(e.startsWith("/")?e.substr(1):e)},getMoreDirectoryListing:function(e){var t=e.get("currentDirectoryId"),a=e.get("nextPageToken");return n(t,a)},updateFile:r,createFile:function(t,n,i){return new Promise((function(o,s){a(t,n).then((function(a){return a?r(a,i).then(o).catch(s):e().then((function(e){e.client.drive.files.create({name:t,parents:n}).then((function(e){return r(e.result.id,i)})).then(o).catch(s)}))})).catch(s)}))},duplicateFile:function(t,n){return new Promise((function(r,i){e().then((function(e){e.client.drive.files.get({fileId:t,fields:"name, parents"}).then((function(o){if(o.result.name){var s=n(o.result.name),c=o.result.parents[0];a(s,c).then((function(n){var a=function(){e.client.drive.files.copy({fileId:t,parents:c,name:s}).then((function(e){r()})).catch(i)};n?e.client.drive.files.delete({fileId:n}).then(a).catch(i):a()}))}else i()}))}))}))},getFileContentsAndMetadata:i,getFileContents:o,getFileContentsByNameAndParent:function(e,t){return new Promise((function(n,r){return a(e,t).then((function(e){e?o(e).then(n):r()}))}))},deleteFileByNameAndParent:function(t,n){return new Promise((function(a,r){e().then((function(e){return e.client.drive.files.list({pageSize:1,fields:"files(id)",q:"'".concat(n,"' in parents and trashed = false and name = '").concat(t,"'")}).then((function(t){t.result.files.length>0?e.client.drive.files.delete({fileId:t.result.files[0].id}).then(a).catch(r):a()}))}))}))}}},Cr=n(222),Sr=function(e,t,n){var a=Object(Cr.createClient)(e,{username:t,password:n}),r=function(e){var t=function(e){return e.filter((function(e){return"directory"===e.type||e.basename.match(/org$|org_archive$/)})).sort((function(e,t){return"directory"===e.type&&"directory"!==t.type?-1:e.basename>t.basename?1:-1}))}(e);return Object(q.fromJS)(t.map((function(e){return{id:e.filename,name:e.basename,isDirectory:"directory"===e.type,path:e.filename}})))},i=function(e){return new Promise((function(t,n){a.getDirectoryContents(e).then((function(e){return t({listing:r(e)})})).catch(n)}))},o=function(e,t){return new Promise((function(n,r){return a.putFileContents(e,t,{overwrite:!0}).then(n).catch(r)}))},s=function(n){return new Promise((function(r,i){return a.stat(n).then((function(e){a.getFileContents(n,{format:"text"}).then((function(t){r({contents:t,lastModifiedAt:new Date(Date.parse(e.lastmod)).toISOString()})})).catch((function(e){console.error(n,": get file failed",e),i()}))})).catch((function(a){a&&a.response&&-1!==[401,403].indexOf(a.response.status)&&alert(t+"@"+e+": "+a.response.statusText),console.error(n,": get stat failed",a),i()}))}))};return{type:"WebDAV",isSignedIn:function(){return new Promise((function(e){i("/").then((function(){e(!0)})).catch((function(t){console.log("Login didn't work"),e(!1)}))}))},getDirectoryListing:i,getMoreDirectoryListing:function(e){return new Promise((function(e,t){return e()}))},updateFile:o,createFile:o,getFileContentsAndMetadata:s,getFileContents:function(e){return Object(J.isEmpty)(e)?Promise.reject("No path given"):new Promise((function(t,n){return s(e).then((function(e){var n=e.contents;return t(n)})).catch(n)}))},deleteFile:function(e){return new Promise((function(t,n){return a.deleteFile(e).then(t).catch((function(t){t&&t.response&&404===t.response.status||(console.error(e,": delete failed",t),n())}))}))}}},Or=(n(392),n(48)),Dr=(n(393),n(7)),Ar=n.n(Dr),Nr=(n(394),function(){return c.a.createElement("div",{className:"privacy-policy-container"},c.a.createElement("h1",null,"Privacy Policy"),c.a.createElement("p",null,"Last updated: September 6nd, 2019"),c.a.createElement("p",null,c.a.createElement("a",{href:"https://200ok.ch/"},"200ok llc")," operates the https://organice.200ok.ch website and mobile apps."),c.a.createElement("p",null,"This page is used to inform website visitors regarding our policies with the collection, use, and disclosure of Personal Information if anyone decided to use our Service."),c.a.createElement("p",null,"If you choose to use our Service, then you agree to the collection and use of information in relation with this policy. The Personal Information that we collect are used for providing and improving the Service. We will not use or share your information with anyone except as described in this Privacy Policy."),c.a.createElement("p",null,c.a.createElement("strong",null,"Information Collection and Use")),c.a.createElement("p",null,"For a better experience while using our Service, we may require you to provide us with certain personally identifiable information, including but not limited to your name, phone number, and postal address. The information that we collect will be used to contact or identify you."),c.a.createElement("p",null,c.a.createElement("strong",null,"Log Data")),c.a.createElement("p",null,"We want to inform you that whenever you visit our Service, we collect information that your browser sends to us that is called Log Data. This Log Data may include information such as your computer\u2019s Internet Protocol (\u201cIP\u201d) address, browser version, pages of our Service that you visit, the time and date of your visit, the time spent on those pages, and other statistics."),c.a.createElement("p",null,c.a.createElement("strong",null,"Cookies")),c.a.createElement("p",null,"Cookies are files with small amount of data that is commonly used an anonymous unique identifier. These are sent to your browser from the website that you visit and are stored on your computer\u2019s hard drive."),c.a.createElement("p",null,"Our website uses these \u201ccookies\u201d to collection information and to improve our Service. You have the option to either accept or refuse these cookies, and know when a cookie is being sent to your computer. If you choose to refuse our cookies, you may not be able to use some portions of our Service."),c.a.createElement("p",null,c.a.createElement("strong",null,"Service Providers")),c.a.createElement("p",null,"We may employ third-party companies and individuals due to the following reasons:"),c.a.createElement("ul",null,c.a.createElement("li",null,"To facilitate our Service;"),c.a.createElement("li",null,"To provide the Service on our behalf;"),c.a.createElement("li",null,"To perform Service-related services; or"),c.a.createElement("li",null,"To assist us in analyzing how our Service is used.")),c.a.createElement("p",null,"We want to inform our Service users that these third parties have access to your Personal Information. The reason is to perform the tasks assigned to them on our behalf. However, they are obligated not to disclose or use the information for any other purpose."),c.a.createElement("p",null,c.a.createElement("strong",null,"Security")),c.a.createElement("p",null,"We value your trust in providing us your Personal Information, thus we are striving to use commercially acceptable means of protecting it. But remember that no method of transmission over the internet, or method of electronic storage is 100% secure and reliable, and we cannot guarantee its absolute security."),c.a.createElement("p",null,c.a.createElement("strong",null,"Links to Other Sites")),c.a.createElement("p",null,"Our Service may contain links to other sites. If you click on a third-party link, you will be directed to that site. Note that these external sites are not operated by us. Therefore, we strongly advise you to review the Privacy Policy of these websites. We have no control over, and assume no responsibility for the content, privacy policies, or practices of any third-party sites or services."),c.a.createElement("p",null,c.a.createElement("strong",null,"Children\u2019s Privacy")),c.a.createElement("p",null,"Our Services do not address anyone under the age of 13. We do not knowingly collect personal identifiable information from children under 13. In the case we discover that a child under 13 has provided us with personal information, we immediately delete this from our servers. If you are a parent or guardian and you are aware that your child has provided us with personal information, please contact us so that we will be able to do necessary actions."),c.a.createElement("p",null,c.a.createElement("strong",null,"Changes to This Privacy Policy")),c.a.createElement("p",null,"We may update our Privacy Policy from time to time. Thus, we advise you to review this page periodically for any changes. We will notify you of any changes by posting the new Privacy Policy on this page. These changes are effective immediately, after they are posted on this page."),c.a.createElement("p",null,c.a.createElement("strong",null,"Contact us")),c.a.createElement("p",null,"If you have any questions about this Privacy Policy, please"," ",c.a.createElement("a",{href:"mailto:info@200ok.ch"},"contact us"),"."))}),Pr=n(98),Lr=n.n(Pr),jr=(n(395),function(e){function t(e){var n;return Object(h.a)(this,t),n=Object(m.a)(this,Object(g.a)(t).call(this,e)),X.a.bindAll(Object(f.a)(n),["handleChangelogClick","handleSettingsClick","handleModalPageDoneClick","handleSettingsSubPageBackClick","handleUndoClick","handleRedoClick","handleHelpClick"]),n}return Object(b.a)(t,e),Object(p.a)(t,[{key:"getPathRoot",value:function(){return this.props.location.pathname.split("/")[1]}},{key:"renderFileBrowserBackButton",value:function(){var e=this.props,t=e.location.pathname;if("Google Drive"===e.syncBackendType)return c.a.createElement("div",null);var n=t.substr("/files".length);if(n.endsWith("/")&&(n=n.substring(0,n.length-1)),""===n)return c.a.createElement("div",null);var a=n.split("/"),r=a[a.length-2],i=a.slice(0,a.length-1).join("/");return c.a.createElement(mr.b,{to:"/files".concat(i),className:"header-bar__back-button"},c.a.createElement("i",{className:"fas fa-chevron-left"}),c.a.createElement("span",{className:"header-bar__back-button__directory-path"},r,"/"))}},{key:"renderOrgFileBackButton",value:function(){var e=this.props.location.pathname.substr("/file".length);e.endsWith("/")&&(e=e.substring(0,e.length-1));var t=e.split("/"),n=t.slice(0,t.length-1).join("/");return c.a.createElement(mr.b,{to:"/files".concat(n),className:"header-bar__back-button"},c.a.createElement("i",{className:"fas fa-chevron-left"}),c.a.createElement("span",{className:"header-bar__back-button__directory-path"},"File browser"))}},{key:"renderLogo",value:function(){return c.a.createElement("div",{className:"header-bar__logo-container"},c.a.createElement("img",{className:"header-bar__logo",src:Lr.a,alt:"Logo",width:"30",height:"30"}),c.a.createElement("h2",{className:"header-bar__app-name"},"organice"))}},{key:"renderSampleFileBackButton",value:function(){return c.a.createElement(mr.b,{to:"/",className:"header-bar__back-button"},c.a.createElement("i",{className:"fas fa-chevron-left"}),c.a.createElement("span",{className:"header-bar__back-button__directory-path"},"Home"))}},{key:"renderSignInBackButton",value:function(){return c.a.createElement(mr.b,{to:"/",className:"header-bar__back-button"},c.a.createElement("i",{className:"fas fa-chevron-left"}),c.a.createElement("span",{className:"header-bar__back-button__directory-path"},"Home"))}},{key:"handleSettingsSubPageBackClick",value:function(){this.props.base.popModalPage()}},{key:"renderSettingsSubPageBackButton",value:function(){return c.a.createElement("div",{className:"header-bar__back-button",onClick:this.handleSettingsSubPageBackClick},c.a.createElement("i",{className:"fas fa-chevron-left"}),c.a.createElement("span",{className:"header-bar__back-button__directory-path"},"Settings"))}},{key:"renderBackButton",value:function(){switch(this.props.activeModalPage){case"changelog":case"keyboard_shortcuts_editor":case"capture_templates_editor":case"sample":return this.renderSettingsSubPageBackButton();case"settings":return c.a.createElement("div",null)}switch(this.getPathRoot()){case"":return this.renderLogo();case"files":return this.renderFileBrowserBackButton();case"file":return this.renderOrgFileBackButton();case"sample":return this.renderSampleFileBackButton();case"sign_in":return this.renderSignInBackButton();default:return c.a.createElement("div",null)}}},{key:"renderTitle",value:function(){var e=function(e){return c.a.createElement("div",{className:"header-bar__title"},e)};switch(this.props.activeModalPage){case"changelog":return e("Changelog");case"settings":return e("Settings");case"keyboard_shortcuts_editor":return e("Shortcuts");case"capture_templates_editor":return e("Capture");case"sample":return e("Sample")}switch(this.getPathRoot()){case"sample":return e("Sample");case"sign_in":return e("Sign in")}return e("")}},{key:"handleChangelogClick",value:function(){this.props.base.pushModalPage("changelog")}},{key:"handleSettingsClick",value:function(){this.props.base.pushModalPage("settings")}},{key:"handleModalPageDoneClick",value:function(){this.props.base.clearModalStack()}},{key:"handleUndoClick",value:function(){this.props.isUndoEnabled&&this.props.undo.undo()}},{key:"handleRedoClick",value:function(){this.props.isRedoEnabled&&this.props.undo.redo()}},{key:"handleHelpClick",value:function(){this.props.base.pushModalPage("settings"),this.props.base.pushModalPage("sample")}},{key:"renderActions",value:function(){var e=this.props,t=e.isAuthenticated,n=e.hasUnseenChangelog,a=e.activeModalPage,r=e.path,i=e.isUndoEnabled,o=e.isRedoEnabled;if(a)return c.a.createElement("div",{className:"header-bar__actions",onClick:this.handleModalPageDoneClick},"Done");var l=Ar()("fas fa-undo header-bar__actions__item",{"header-bar__actions__item--disabled":!i}),u=Ar()("fas fa-redo header-bar__actions__item",{"header-bar__actions__item--disabled":!o}),d=Ar()("fas fa-cogs header-bar__actions__item",{"settings-icon--has-unseen-changelog":n});return c.a.createElement("div",{className:"header-bar__actions"},!t&&"sign_in"!==this.getPathRoot()&&c.a.createElement(mr.b,{to:"/sign_in"},c.a.createElement("div",{className:"header-bar__actions__item",title:"Sign in"},"Sign in")),!t&&c.a.createElement("a",{href:"https://github.com/200ok-ch/organice",target:"_blank",rel:"noopener noreferrer"},c.a.createElement("i",{className:"fab fa-github header-bar__actions__item"})),t&&!a&&!!r&&c.a.createElement(s.Fragment,null,c.a.createElement("i",{className:l,onClick:this.handleUndoClick,title:"Undo"}),c.a.createElement("i",{className:u,onClick:this.handleRedoClick,title:"Redo"}),c.a.createElement("i",{className:"fas fa-question-circle header-bar__actions__item",onClick:this.handleHelpClick,title:"Help"})),t&&c.a.createElement("i",{className:d,onClick:this.handleSettingsClick,title:"Settings"}))}},{key:"render",value:function(){var e=Ar()("header-bar",{"header-bar--with-logo":""===this.getPathRoot()});return c.a.createElement("div",{className:e},this.renderBackButton(),this.renderTitle(),this.renderActions())}}]),t}(s.PureComponent)),Mr=Object(Or.h)(Object(y.b)((function(e,t){return{isAuthenticated:e.syncBackend.get("isAuthenticated"),hasUnseenChangelog:e.base.get("hasUnseenChangelog"),activeModalPage:e.base.get("modalPageStack",Object(q.List)()).last(),path:e.org.present.get("path"),isUndoEnabled:e.org.past.length>0,isRedoEnabled:e.org.future.length>0,syncBackendType:e.syncBackend.get("client")&&e.syncBackend.get("client").type}}),(function(e){return{base:Object(v.b)(a,e),undo:Object(v.b)(_.ActionCreators,e)}}))(jr)),Rr=(n(397),function(){return c.a.createElement("main",{className:"landing-container-wrapper"},c.a.createElement("div",{className:"landing-container"},c.a.createElement("h1",{className:"landing-app-name"},"organice"),c.a.createElement("img",{className:"landing-logo",src:Lr.a,alt:"Logo"}),c.a.createElement("h2",{className:"landing-tagline"},"organice organizes Org files nicely!"),c.a.createElement("h2",{className:"landing-tagline"},"Syncs with Dropbox,",c.a.createElement("br",null)," Google Drive and WebDAV."),c.a.createElement(mr.b,{to:"/sample"},c.a.createElement("div",{className:"btn landing-button view-sample-button"},"View sample")),c.a.createElement(mr.b,{to:"/sign_in"},c.a.createElement("div",{className:"btn landing-button"},"Sign in"))),c.a.createElement("footer",null,c.a.createElement(mr.b,{to:"/privacy-policy"},"Privacy Policy")))}),xr=(n(398),Object(y.b)((function(e,t){var n=e.syncBackend.get("currentFileBrowserDirectoryListing");return{syncBackendType:e.syncBackend.get("client").type,listing:n?n.get("listing"):null,hasMore:!!n&&n.get("hasMore"),isLoadingMore:!!n&&n.get("isLoadingMore"),additionalSyncBackendState:!!n&&n.get("additionalSyncBackendState")}}),(function(e){return{syncBackend:Object(v.b)(o,e)}}))((function(e){var t=e.path,n=e.listing,a=e.hasMore,r=e.isLoadingMore,i=e.syncBackendType,o=e.syncBackend,l=e.additionalSyncBackendState;Object(s.useEffect)((function(){return o.getDirectoryListing(t)}),[o,t]);var u=""===t;return c.a.createElement("div",{className:"file-browser-container"},"Dropbox"===i&&c.a.createElement("h3",{className:"file-browser__header"},"Directory: ",u?"/":t),c.a.createElement("ul",{className:"file-browser__file-list"},!u&&c.a.createElement(mr.b,{to:"/files".concat(function(){switch(i){case"Dropbox":case"WebDAV":var e=t.split("/");return e.slice(0,e.length-1).join("/");case"Google Drive":return l.get("parentId")?"/"+l.get("parentId"):null;default:return null}}())},c.a.createElement("li",{className:"file-browser__file-list__element"},c.a.createElement("i",{className:"fas fa-folder file-browser__file-list__icon--directory"})," ..")),(n||[]).map((function(e){var t=e.get("isDirectory"),n=e.get("name").endsWith(".organice-bak"),a=e.get("name").endsWith(".org"),r=".organice-config.json"===e.get("name"),i=Ar()("file-browser__file-list__icon fas",{"fa-folder":t,"file-browser__file-list__icon--directory":t,"fa-file":!t&&!n&&!r,"file-browser__file-list__icon--not-org":!a,"fa-copy":n,"fa-cogs":r});return e.get("isDirectory")?c.a.createElement(mr.b,{to:"/files".concat(e.get("path")),key:e.get("id")},c.a.createElement("li",{className:"file-browser__file-list__element"},c.a.createElement("i",{className:i})," ",e.get("name"),"/")):c.a.createElement(mr.b,{to:"/file".concat(e.get("path")),key:e.get("id")},c.a.createElement("li",{className:"file-browser__file-list__element"},c.a.createElement("i",{className:i})," ",e.get("name")))})),a&&(r?c.a.createElement("li",{className:"file-browser__file-list__loading-more-container"},c.a.createElement("i",{className:"fas fa-spinner fa-lg fa-spin"})):c.a.createElement("li",{className:"file-browser__file-list__element file-browser__file-list__element--load-more-row",onClick:function(){return o.loadMoreDirectoryListing()}},"Load more..."))))}))),Hr=n(18),Fr=(n(406),function(e){var t=e.message,n=Object(s.useState)(!0),a=Object(d.a)(n,2),r=a[0],i=a[1],o=Object(s.useState)(t),l=Object(d.a)(o,2),u=l[0],h=l[1];Object(s.useEffect)((function(){t&&(h(t),i(!0))}),[t]);var p=function(){return i(!1)};if(!r)return null;var m={opacity:Object(Hr.spring)(t?.9:0,{stiffness:300})};return c.a.createElement(Hr.Motion,{style:m,onRest:function(){t||(i(!1),h(null))}},(function(e){return c.a.createElement("div",{className:"loading-indicator",style:e,onClick:p},u)}))}),Br=n(224),Ur=(n(408),n(409),n(231)),Vr=n(52),Wr=(n(411),n(412),n(413),n(414),n(415),function(e){var t=e.subPartDataAndHandlers,n=t.onEnterTableEditMode,a=t.onAddNewTableRow,r=t.onRemoveTableRow,i=t.onAddNewTableColumn,o=t.onRemoveTableColumn;return c.a.createElement("div",{className:"table-action-drawer-container"},c.a.createElement("div",{className:" table-action-drawer__edit-icon-container",onClick:n},c.a.createElement("i",{className:"fas fa-pencil-alt fa-lg"})),c.a.createElement("div",{className:"table-action-drawer__sub-icon-container",onClick:a},c.a.createElement("i",{className:"fas fa-plus fa-lg table-action-drawer__main-icon"}),c.a.createElement("i",{className:"fas fa-columns fa-sm table-action-drawer__sub-icon table-action-drawer__sub-icon--rotated"})),c.a.createElement("div",{className:"table-action-drawer__sub-icon-container",onClick:r},c.a.createElement("i",{className:"fas fa-times fa-lg table-action-drawer__main-icon"}),c.a.createElement("i",{className:"fas fa-columns fa-sm table-action-drawer__sub-icon table-action-drawer__sub-icon--rotated"})),c.a.createElement("div",{className:"table-action-drawer__sub-icon-container",onClick:i},c.a.createElement("i",{className:"fas fa-plus fa-lg table-action-drawer__main-icon"}),c.a.createElement("i",{className:"fas fa-columns fa-sm table-action-drawer__sub-icon"})),c.a.createElement("div",{className:"table-action-drawer__sub-icon-container",onClick:o},c.a.createElement("i",{className:"fas fa-times fa-lg table-action-drawer__main-icon"}),c.a.createElement("i",{className:"fas fa-columns fa-sm table-action-drawer__sub-icon"})))}),Gr=function(e){function t(e){var n;return Object(h.a)(this,t),n=Object(m.a)(this,Object(g.a)(t).call(this,e)),X.a.bindAll(Object(f.a)(n),["handleCellSelect","handleTextareaBlur","handleCellChange","handleInsertTimestamp","handleTextareaRef"]),n.state={rawCellValues:n.generateCellValueMap(e.table),shouldIgnoreBlur:!1},n}return Object(b.a)(t,e),Object(p.a)(t,[{key:"componentDidUpdate",value:function(e){var t=this.props.subPartDataAndHandlers,n=t.onTableCellValueUpdate,a=t.selectedTableCellId,r=t.inTableEditMode,i=this.state.rawCellValues;e.subPartDataAndHandlers.inTableEditMode&&!r&&i.has(a)&&n(a,i.get(a)),this.props.table!==e.table&&this.setState({rawCellValues:this.generateCellValueMap(this.props.table)})}},{key:"generateCellValueMap",value:function(e){return Object(q.Map)(e.get("contents").map((function(e){return e.get("contents").map((function(e){return[e.get("id"),e.get("rawContents")]}))})).flatten())}},{key:"handleCellSelect",value:function(e){var t=this;return function(){return t.props.subPartDataAndHandlers.onTableCellSelect(e)}}},{key:"handleTextareaBlur",value:function(){var e=this;setTimeout((function(){e.state.shouldIgnoreBlur?e.setState({shouldIgnoreBlur:!1}):e.props.subPartDataAndHandlers.onExitTableEditMode()}),0)}},{key:"handleCellChange",value:function(e){var t=this.state.rawCellValues,n=this.props.subPartDataAndHandlers.selectedTableCellId;this.setState({rawCellValues:t.set(n,e.target.value)})}},{key:"handleInsertTimestamp",value:function(){this.setState({shouldIgnoreBlur:!0});var e=this.state.rawCellValues,t=this.props.subPartDataAndHandlers.selectedTableCellId,n=e.get(t),a=this.textarea.selectionStart;this.setState({rawCellValues:e.set(t,n.substring(0,a)+pe()+n.substring(this.textarea.selectionEnd||a))}),this.textarea.focus()}},{key:"handleTextareaRef",value:function(e){this.textarea=e}},{key:"render",value:function(){var e=this,t=this.props,n=t.table,a=t.subPartDataAndHandlers,r=a.selectedTableCellId,i=a.inTableEditMode,o=a.shouldDisableActions,l=this.state.rawCellValues,u=n.get("contents").some((function(e){return e.get("contents").some((function(e){return e.get("id")===r}))}));return c.a.createElement(s.Fragment,null,c.a.createElement("table",{className:"table-part"},c.a.createElement("tbody",null,n.get("contents").map((function(t){return c.a.createElement("tr",{key:t.get("id")},t.get("contents").map((function(t){var n=t.get("id")===r,a=Ar()("table-part__cell",{"table-part__cell--selected":n});return c.a.createElement("td",{className:a,key:t.get("id"),onClick:e.handleCellSelect(t.get("id"))},n&&i?c.a.createElement("div",{className:"table-cell__edit-container"},c.a.createElement("textarea",{autoFocus:!0,className:"textarea",rows:"3",value:l.get(t.get("id")),onBlur:e.handleTextareaBlur,onChange:e.handleCellChange,ref:e.handleTextareaRef}),c.a.createElement("div",{className:"table-cell__insert-timestamp-button",onClick:e.handleInsertTimestamp},c.a.createElement("i",{className:"fas fa-plus insert-timestamp-icon"}),"Insert timestamp")):t.get("contents").size>0?c.a.createElement($r,{parts:t.get("contents"),subPartDataAndHandlers:e.props.subPartDataAndHandlers}):"   ")})))})))),c.a.createElement(Vr.UnmountClosed,{isOpened:u&&!o},c.a.createElement(Wr,{subPartDataAndHandlers:this.props.subPartDataAndHandlers})))}}]),t}(s.PureComponent),Kr=(n(416),function(e,t,n){return{r:parseInt((t.r-e.r)*n+e.r,10),g:parseInt((t.g-e.g)*n+e.g,10),b:parseInt((t.b-e.b)*n+e.b,10),a:(t.a-e.a)*n+e.a}}),zr=function(e,t,n,a){return{r:e,g:t,b:n,a:a}},Yr=function(e){return"rgba(".concat(e.r,", ").concat(e.g,", ").concat(e.b,", ").concat(e.a,")")},Jr=(n(417),function(e){var t=e.state,n=e.onClick,a=zr(255,255,255,1),r=zr(238,232,213,1),i={colorFactor:Object(Hr.spring)({checked:1,partial:1,unchecked:0}[t],{stiffness:300})};return c.a.createElement(Hr.Motion,{style:i},(function(e){var i=Yr(Kr(a,r,e.colorFactor));return c.a.createElement("div",{className:"checkbox",onClick:n,style:{backgroundColor:i}},c.a.createElement("div",{className:"checkbox__inner-container"},"checked"===t&&c.a.createElement("i",{className:"fas fa-check"}),"partial"===t&&c.a.createElement("i",{className:"fas fa-minus"})))}))}),Xr=function(e){var t=e.part,n=e.subPartDataAndHandlers,a=function(){return t.get("items").map((function(e){var t,a=Ar()({"list-part__checkbox-container":e.get("isCheckbox")});return c.a.createElement("li",{key:e.get("id"),value:e.get("forceNumber")},c.a.createElement("span",{className:a,onClick:e.get("isCheckbox")?(t=e.get("id"),function(){return n.onCheckboxClick(t)}):null},e.get("isCheckbox")&&c.a.createElement(Jr,{state:e.get("checkboxState")}),c.a.createElement($r,{parts:e.get("titleLine"),subPartDataAndHandlers:n})),c.a.createElement("br",null),c.a.createElement($r,{parts:e.get("contents"),subPartDataAndHandlers:n}))}))};return t.get("isOrdered")?c.a.createElement("ol",{className:"attributed-string__list-part attributed-string__list-part--ordered"},a()):c.a.createElement("ul",{className:"attributed-string__list-part"},a())},qr=(n(418),function(e){var t=e.part,n=e.subPartDataAndHandlers,a=n.onTimestampClick,r=n.shouldDisableActions,i=t.get("firstTimestamp"),o=t.get("secondTimestamp");return c.a.createElement("span",{className:"attributed-string__timestamp-part",onClick:function(){return r?void 0:a(t.get("id"))}},!!i&&de(i),!!o&&c.a.createElement(s.Fragment,null,"--",de(o)))}),$r=function(e){var t,n=e.parts,a=e.subPartDataAndHandlers;return c.a.createElement("span",null,n.map((function(e){switch(e.get("type")){case"text":return e.get("contents");case"link":var n=e.getIn(["contents","uri"]),r=e.getIn(["contents","title"])||n;return c.a.createElement("a",{key:e.get("id"),href:n,target:"_blank",rel:"noopener noreferrer"},r);case"percentage-cookie":return t=Ar()("attributed-string__cookie-part",{"attributed-string__cookie-part--complete":100===parseInt(e.get("percentage"),10)}),c.a.createElement("span",{key:e.get("id"),className:t},"[",e.get("percentage"),"%]");case"fraction-cookie":return t=Ar()("attributed-string__cookie-part",{"attributed-string__cookie-part--complete":""!==e.getIn(["fraction",0])&&e.getIn(["fraction",0])===e.getIn(["fraction",1])}),c.a.createElement("span",{key:e.get("id"),className:t},"[",e.getIn(["fraction",0]),"/",e.getIn(["fraction",1]),"]");case"table":return c.a.createElement(Gr,{key:e.get("id"),table:e,subPartDataAndHandlers:a});case"list":return c.a.createElement(Xr,{key:e.get("id"),part:e,subPartDataAndHandlers:a});case"inline-markup":return t=Ar()("attributed-string__inline-markup","attributed-string__inline-markup--".concat(e.get("markupType"))),c.a.createElement("span",{key:e.get("id"),className:t},e.get("content"));case"timestamp":return c.a.createElement(qr,{key:e.get("id"),part:e,subPartDataAndHandlers:a});default:return console.error("Unrecognized attributed string part type! ".concat(e.get("type"))),""}})))},Qr=function(e){function t(e){var n;return Object(h.a)(this,t),n=Object(m.a)(this,Object(g.a)(t).call(this,e)),X.a.bindAll(Object(f.a)(n),["handleRef","handleTitleSpanRef","handleTextareaRef","handleTitleClick","handleTextareaBlur","handleTitleChange","handleTitleFieldClick","handleTodoClick","handleTimestampClick","handleInsertTimestamp"]),n.state={titleValue:n.calculateRawTitle(e.header),containerWidth:null,shouldIgnoreBlur:!1},n}return Object(b.a)(t,e),Object(p.a)(t,[{key:"storeContainerWidth",value:function(){this.containerDiv&&this.setState({containerWidth:this.containerDiv.offsetWidth})}},{key:"componentDidMount",value:function(){this.storeContainerWidth()}},{key:"componentDidUpdate",value:function(e){var t=this,n=this.props.header;e.inEditMode&&!this.props.inEditMode&&this.props.org.updateHeaderTitle(n.get("id"),this.state.titleValue),e.header!==this.props.header&&this.setState({titleValue:this.calculateRawTitle(this.props.header)},(function(){return t.storeContainerWidth()}))}},{key:"handleRef",value:function(e){this.containerDiv=e}},{key:"handleTitleSpanRef",value:function(e){this.titleSpan=e}},{key:"handleTextareaRef",value:function(e){this.textarea=e}},{key:"calculateRawTitle",value:function(e){var t=e.getIn(["titleLine","todoKeyword"]),n=e.getIn(["titleLine","tags"]),a=e.getIn(["titleLine","rawTitle"]);return t&&(a="".concat(t," ").concat(a)),n&&n.size>0&&(a="".concat(a," :").concat(n.join(":"),":")),a}},{key:"handleTitleClick",value:function(e){var t=this.props,n=t.header,a=t.hasContent,r=t.isSelected,i=t.onClick;i?i():(!a||n.get("opened")&&!r||this.props.org.toggleHeaderOpened(n.get("id")),this.props.org.selectHeader(n.get("id")))}},{key:"handleTodoClick",value:function(e){var t=this.props,n=t.header,a=t.shouldTapTodoToAdvance,r=t.onClick;r?(r(),e.stopPropagation()):(this.props.org.selectHeader(n.get("id")),a&&this.props.org.advanceTodoState())}},{key:"handleTextareaBlur",value:function(e){var t=this;setTimeout((function(){t.state.shouldIgnoreBlur?t.setState({shouldIgnoreBlur:!1}):t.props.org.exitEditMode()}),0)}},{key:"handleTitleChange",value:function(e){var t=e.target.value,n=t[t.length-1];this.state.titleValue!==t.substring(0,t.length-1)||"\n"!==n?this.setState({titleValue:t}):this.props.org.exitEditMode()}},{key:"handleTitleFieldClick",value:function(e){e.stopPropagation()}},{key:"handleTimestampClick",value:function(e){this.props.base.activatePopup("timestamp-editor",{timestampId:e})}},{key:"handleInsertTimestamp",value:function(e){this.setState({shouldIgnoreBlur:!0});var t=this.state.titleValue,n=this.textarea.selectionStart;this.setState({titleValue:t.substring(0,n)+pe()+t.substring(this.textarea.selectionEnd||n)}),this.textarea.focus(),e.stopPropagation()}},{key:"render",value:function(){var e=this.props,t=e.header,n=e.color,a=e.hasContent,r=e.inEditMode,i=e.shouldDisableActions,o=e.shouldDisableExplicitWidth,s=this.state.containerWidth,l=t.getIn(["titleLine","todoKeyword"]),u={color:n,wordBreak:"break-word"};return c.a.createElement("div",{className:"title-line",onClick:this.handleTitleClick,ref:this.handleRef,style:{width:o?"":s}},!r&&l?c.a.createElement("span",{className:Ar()("todo-keyword","todo-keyword--".concat(l.toLowerCase())),onClick:this.handleTodoClick},l):"",r?c.a.createElement("div",{className:"title-line__edit-container"},c.a.createElement("textarea",{autoFocus:!0,className:"textarea",rows:"3",ref:this.handleTextareaRef,value:this.state.titleValue,onBlur:this.handleTextareaBlur,onChange:this.handleTitleChange,onClick:this.handleTitleFieldClick}),c.a.createElement("div",{className:"title-line__insert-timestamp-button",onClick:this.handleInsertTimestamp},c.a.createElement("i",{className:"fas fa-plus insert-timestamp-icon"}),"Insert timestamp")):c.a.createElement("div",null,c.a.createElement("span",{style:u,ref:this.handleTitleSpanRef},c.a.createElement($r,{parts:t.getIn(["titleLine","title"]),subPartDataAndHandlers:{onTimestampClick:this.handleTimestampClick,shouldDisableActions:i}}),!t.get("opened")&&a?"...":""),t.getIn(["titleLine","tags"]).size>0&&c.a.createElement("div",null,t.getIn(["titleLine","tags"]).toSet().toList().filter((function(e){return!!e})).map((function(e){return c.a.createElement("div",{className:"header-tag",key:e},e)})))))}}]),t}(s.PureComponent),Zr=Object(y.b)((function(e,t){return{inEditMode:"title"===e.org.present.get("editMode")&&e.org.present.get("selectedHeaderId")===t.header.get("id"),shouldTapTodoToAdvance:e.base.get("shouldTapTodoToAdvance"),isSelected:e.org.present.get("selectedHeaderId")===t.header.get("id")}}),(function(e){return{org:Object(v.b)(r,e),base:Object(v.b)(a,e)}}))(Qr),ei=(n(419),n(420),function(e){function t(e){var n;return Object(h.a)(this,t),n=Object(m.a)(this,Object(g.a)(t).call(this,e)),X.a.bindAll(Object(f.a)(n),["handleTimestampClick"]),n}return Object(b.a)(t,e),Object(p.a)(t,[{key:"handleTimestampClick",value:function(e){var t=this;return function(){return t.props.onClick(e)}}},{key:"render",value:function(){var e=this,t=this.props.planningItems;return 0===t.size?null:c.a.createElement("div",null,t.map((function(t,n){return c.a.createElement("div",{key:t.get("id"),className:"planning-items__item-container"},c.a.createElement("div",{className:"planning-item__type"},t.get("type"),": "),c.a.createElement("div",{className:"planning-item__timestamp",onClick:e.handleTimestampClick(n)},de(t.get("timestamp"))))})))}}]),t}(s.PureComponent)),ti=(n(421),function(e){var t=e.propertyListItems,n=e.shouldDisableActions,a=e.onTimestampClick,r=e.onEdit,i=Object(s.useState)(!0),o=Object(d.a)(i,2),l=o[0],u=o[1];return 0===t.size?null:c.a.createElement("div",{className:"property-list-container"},c.a.createElement("div",{className:"property-list__property",onClick:function(){return u(!l)}},":PROPERTIES:",l?"...":""),!l&&c.a.createElement(s.Fragment,null,t.map((function(e){return c.a.createElement("div",{className:"property-list__item-container",key:e.get("id")},c.a.createElement("div",{className:"property-list__property",onClick:n?null:r},":",e.get("property"),":"),c.a.createElement("div",{className:"property-list__value"},c.a.createElement($r,{parts:e.get("value")||[],subPartDataAndHandlers:{onTimestampClick:a,shouldDisableActions:n}})))})),c.a.createElement("div",{className:"property-list__property",onClick:r},":END:")))}),ni=(n(422),function(e){var t=e.logBookEntries,n=e.onTimestampClick,a=e.shouldDisableActions,r=Object(s.useState)(!0),i=Object(d.a)(r,2),o=i[0],l=i[1],u=function(e,t){return function(){return a?void 0:n(e,t)}};return 0===t.size?null:c.a.createElement("div",{className:"logbook-entries-container"},c.a.createElement("div",{className:"logbook-entries__logbook",onClick:function(){return l(!o)}},":LOGBOOK:",o?"...":""),!o&&c.a.createElement(s.Fragment,null,t.map((function(e,t){return void 0!==e.get("raw")?c.a.createElement("div",{className:"logbook-entries__item-container",key:e.get("id")},e.get("raw")||" "):c.a.createElement("div",{className:"logbook-entries__item-container",key:e.get("id")},c.a.createElement("span",{className:"logbook-entries__item-clock"},"CLOCK:"),c.a.createElement("span",{className:"logbook-entries__item-start",onClick:u(t,"start")},de(e.get("start"))),null===e.get("end")?"":c.a.createElement(s.Fragment,null,"--",c.a.createElement("span",{className:"logbook-entries__item-end",onClick:u(t,"end")},de(e.get("end"))),c.a.createElement("span",{className:"logbook-entries__item-duration"},"=> ",be(e.get("start"),e.get("end")))))})),c.a.createElement("div",{className:"logbook-entries__logbook"},":END:")))}),ai=function(e){function t(e){var n;return Object(h.a)(this,t),n=Object(m.a)(this,Object(g.a)(t).call(this,e)),X.a.bindAll(Object(f.a)(n),["handleRef","handleTextareaRef","handleDescriptionChange","handleTextareaBlur","handleTableCellSelect","handleExitTableEditMode","handleTableCellValueUpdate","handleEnterTableEditMode","handleAddNewTableRow","handleRemoveTableRow","handleAddNewTableColumn","handleRemoveTableColumn","handleCheckboxClick","handleTimestampClick","handleLogEntryTimestampClick","handleInsertTimestamp","handlePlanningItemTimestampClick","handlePropertyListEdit"]),n.state={descriptionValue:n.calculateRawDescription(e.header),containerWidth:null,shouldIgnoreBlur:!1},n}return Object(b.a)(t,e),Object(p.a)(t,[{key:"storeContainerWidth",value:function(){this.containerDiv&&this.setState({containerWidth:this.containerDiv.offsetWidth})}},{key:"componentDidMount",value:function(){this.storeContainerWidth()}},{key:"componentDidUpdate",value:function(e){var t=this,n=this.props.header;e.inEditMode&&!this.props.inEditMode&&this.props.org.updateHeaderDescription(n.get("id"),this.state.descriptionValue),e.header!==this.props.header&&this.setState({descriptionValue:this.calculateRawDescription(this.props.header)},(function(){return t.storeContainerWidth()}))}},{key:"calculateRawDescription",value:function(e){var t=e.get("planningItems"),n=e.get("propertyListItems"),a=e.get("logBookEntries"),r=t.map((function(e){return"".concat(e.get("type"),": ").concat(de(e.get("timestamp")))})).join(" "),i="";n.size>0&&(i+=":PROPERTIES:\n",i+=n.map((function(e){return":".concat(e.get("property"),": ").concat(ve(e.get("value")))})).join("\n"),i+="\n:END:");var o="";a.size>0&&(o+=":LOGBOOK:\n",o+=a.map((function(e){return void 0!==e.get("raw")?e.get("raw"):null===e.get("end")?"CLOCK: ".concat(de(e.get("start"))):"CLOCK: ".concat(de(e.get("start")),"--").concat(de(e.get("end")))})).join("\n"),o+="\n:END:");var s=[r,i,o].filter((function(e){return 0!==e.length})).join("\n");return s+(0===s.length?"":"\n")+e.get("rawDescription")}},{key:"handleTextareaRef",value:function(e){this.textarea=e}},{key:"handleRef",value:function(e){this.containerDiv=e}},{key:"handleDescriptionChange",value:function(e){this.setState({descriptionValue:e.target.value})}},{key:"handleTextareaBlur",value:function(){var e=this;setTimeout((function(){e.state.shouldIgnoreBlur?e.setState({shouldIgnoreBlur:!1}):e.props.org.exitEditMode()}),0)}},{key:"handleTableCellSelect",value:function(e){this.props.org.setSelectedTableCellId(e)}},{key:"handleExitTableEditMode",value:function(){this.props.org.exitEditMode()}},{key:"handleTableCellValueUpdate",value:function(e,t){this.props.org.updateTableCellValue(e,t)}},{key:"handleEnterTableEditMode",value:function(){this.props.org.enterEditMode("table")}},{key:"handleAddNewTableRow",value:function(){this.props.org.addNewTableRow()}},{key:"handleRemoveTableRow",value:function(){this.props.org.removeTableRow()}},{key:"handleAddNewTableColumn",value:function(){this.props.org.addNewTableColumn()}},{key:"handleRemoveTableColumn",value:function(){this.props.org.removeTableColumn()}},{key:"handleCheckboxClick",value:function(e){this.props.org.advanceCheckboxState(e)}},{key:"handleTimestampClick",value:function(e){this.props.base.activatePopup("timestamp-editor",{timestampId:e})}},{key:"handleLogEntryTimestampClick",value:function(e){var t=this;return function(n,a){return t.props.base.activatePopup("timestamp-editor",{headerId:e,logEntryIndex:n,entryType:a})}}},{key:"handleInsertTimestamp",value:function(){this.setState({shouldIgnoreBlur:!0});var e=this.state.descriptionValue,t=this.textarea.selectionStart;this.setState({descriptionValue:e.substring(0,t)+pe()+e.substring(this.textarea.selectionEnd||t)}),this.textarea.focus()}},{key:"handlePlanningItemTimestampClick",value:function(e){var t=this;return function(n){return t.props.base.activatePopup("timestamp-editor",{headerId:e,planningItemIndex:n})}}},{key:"handlePropertyListEdit",value:function(){var e=this.props.header;this.props.base.activatePopup("property-list-editor",{headerId:e.get("id")})}},{key:"render",value:function(){var e=this.props,t=e.header,n=e.inEditMode,a=e.selectedTableCellId,r=e.inTableEditMode,i=e.shouldDisableActions,o=this.state.containerWidth;return t.get("opened")?c.a.createElement("div",{className:"header-content-container nice-scroll",ref:this.handleRef,style:{width:o}},n?c.a.createElement("div",{className:"header-content__edit-container"},c.a.createElement("textarea",{autoFocus:!0,className:"textarea",rows:"8",ref:this.handleTextareaRef,value:this.state.descriptionValue,onBlur:this.handleTextareaBlur,onChange:this.handleDescriptionChange}),c.a.createElement("div",{className:"header-content__insert-timestamp-button",onClick:this.handleInsertTimestamp},c.a.createElement("i",{className:"fas fa-plus insert-timestamp-icon"}),"Insert timestamp")):c.a.createElement(s.Fragment,null,c.a.createElement(ei,{planningItems:t.get("planningItems"),onClick:this.handlePlanningItemTimestampClick(t.get("id"))}),c.a.createElement(ti,{propertyListItems:t.get("propertyListItems"),onTimestampClick:this.handleTimestampClick,shouldDisableActions:i,onEdit:this.handlePropertyListEdit}),c.a.createElement(ni,{logBookEntries:t.get("logBookEntries"),onTimestampClick:this.handleLogEntryTimestampClick(t.get("id")),shouldDisableActions:i}),c.a.createElement($r,{parts:t.get("description"),subPartDataAndHandlers:{onTableCellSelect:this.handleTableCellSelect,selectedTableCellId:a,inTableEditMode:r,onExitTableEditMode:this.handleExitTableEditMode,onTableCellValueUpdate:this.handleTableCellValueUpdate,onEnterTableEditMode:this.handleEnterTableEditMode,onAddNewTableRow:this.handleAddNewTableRow,onRemoveTableRow:this.handleRemoveTableRow,onAddNewTableColumn:this.handleAddNewTableColumn,onRemoveTableColumn:this.handleRemoveTableColumn,onCheckboxClick:this.handleCheckboxClick,onTimestampClick:this.handleTimestampClick,shouldDisableActions:i}}))):c.a.createElement("div",null)}}]),t}(s.PureComponent),ri=Object(y.b)((function(e,t){return{inEditMode:"description"===e.org.present.get("editMode")&&e.org.present.get("selectedHeaderId")===t.header.get("id"),isSelected:e.org.present.get("selectedHeaderId")===t.header.get("id"),selectedTableCellId:e.org.present.get("selectedTableCellId"),inTableEditMode:"table"===e.org.present.get("editMode")}}),(function(e){return{org:Object(v.b)(r,e),base:Object(v.b)(a,e)}}))(ai),ii=(n(423),function(e){function t(){return Object(h.a)(this,t),Object(m.a)(this,Object(g.a)(t).apply(this,arguments))}return Object(b.a)(t,e),Object(p.a)(t,[{key:"iconWithFFClickCatcher",value:function(e,t){return c.a.createElement("div",{onClick:t,className:"header-action-drawer__ff-click-catcher-container"},c.a.createElement("div",{className:"header-action-drawer__ff-click-catcher"}),c.a.createElement("i",{className:e}))}},{key:"render",value:function(){var e=this.props,t=e.onEnterTitleEditMode,n=e.onEnterDescriptionEditMode,a=e.onTagsClick,r=e.isFocused,i=e.onFocus,o=e.onUnfocus,s=e.onAddNewHeader,l=e.onDeadlineClick,u=e.onClockInOutClick,d=e.onScheduledClick,h=e.hasActiveClock;return c.a.createElement("div",{className:"header-action-drawer-container"},c.a.createElement("div",{className:"header-action-drawer__row"},this.iconWithFFClickCatcher("fas fa-pencil-alt fa-lg",t),c.a.createElement("span",{className:"header-action-drawer__separator"}),this.iconWithFFClickCatcher("fas fa-edit fa-lg",n),c.a.createElement("span",{className:"header-action-drawer__separator"}),this.iconWithFFClickCatcher("fas fa-tags fa-lg",a),c.a.createElement("span",{className:"header-action-drawer__separator"}),r?this.iconWithFFClickCatcher("fas fa-expand fa-lg",o):this.iconWithFFClickCatcher("fas fa-compress fa-lg",i),c.a.createElement("span",{className:"header-action-drawer__separator"}),this.iconWithFFClickCatcher("fas fa-plus fa-lg",s)),c.a.createElement("div",{className:"header-action-drawer__row"},c.a.createElement("div",{className:"header-action-drawer__deadline-scheduled-button",onClick:l},"Deadline"),c.a.createElement("span",{className:"header-action-drawer__separator"}),c.a.createElement("div",{className:"header-action-drawer__deadline-scheduled-button",onClick:u},"Clock ",h?"Out":"In"),c.a.createElement("span",{className:"header-action-drawer__separator"}),c.a.createElement("div",{className:"header-action-drawer__deadline-scheduled-button",onClick:d},"Scheduled")))}}]),t}(s.PureComponent)),oi=function(e){function t(e){var n;return Object(h.a)(this,t),(n=Object(m.a)(this,Object(g.a)(t).call(this,e))).SWIPE_ACTION_ACTIVATION_DISTANCE=80,n.FREE_DRAG_ACTIVATION_DISTANCE=10,X.a.bindAll(Object(f.a)(n),["handleRef","handleMouseDown","handleMouseMove","handleMouseUp","handleMouseOut","handleTouchMove","handleTouchStart","handleTouchEnd","handleTouchCancel","handleHeaderClick","handleEnterTitleEditMode","handleEnterDescriptionEditMode","handleShowTagsModal","handleFocus","handleUnfocus","handleAddNewHeader","handleRest","handleDeadlineClick","handleClockInOutClick","handleScheduledClick"]),n.state={isDraggingFreely:!1,dragStartX:null,dragStartY:null,currentDragX:null,containerWidth:null,isPlayingRemoveAnimation:!1,heightBeforeRemove:null},n}return Object(b.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){this.containerDiv&&this.setState({containerWidth:this.containerDiv.offsetWidth})}},{key:"handleRef",value:function(e){this.containerDiv=e,this.props.onRef(e)}},{key:"handleDragStart",value:function(e,t,n){this.props.shouldDisableActions||this.props.inEditMode||e.target.closest(".table-part")||this.setState({dragStartX:t,dragStartY:n})}},{key:"handleDragMove",value:function(e,t){var n=this.state,a=n.dragStartX,r=n.dragStartY;null!==a&&(this.state.isDraggingFreely||Math.abs(e-a)>=this.FREE_DRAG_ACTIVATION_DISTANCE&&this.setState({isDraggingFreely:!0}),Math.abs(t-r)>=this.SWIPE_ACTION_ACTIVATION_DISTANCE/2?this.setState({dragStartX:null}):this.setState({currentDragX:e}))}},{key:"handleDragEnd",value:function(){var e=this.state,t=e.dragStartX,n=e.currentDragX;if(t&&n){var a=n-t;a>=this.SWIPE_ACTION_ACTIVATION_DISTANCE&&this.props.org.advanceTodoState(this.props.header.get("id")),-1*a>=this.SWIPE_ACTION_ACTIVATION_DISTANCE&&this.setState({isPlayingRemoveAnimation:!0,heightBeforeRemove:this.containerDiv.offsetHeight})}this.setState({dragStartX:null,currentDragX:null,isDraggingFreely:!1})}},{key:"handleDragCancel",value:function(){this.setState({dragStartX:null,currentDragX:null,isDraggingFreely:!1})}},{key:"handleMouseDown",value:function(e){this.handleDragStart(e,e.clientX,e.clientY)}},{key:"handleMouseMove",value:function(e){this.handleDragMove(e.clientX,e.clientY)}},{key:"handleMouseUp",value:function(){this.handleDragEnd()}},{key:"handleMouseOut",value:function(){this.handleDragCancel()}},{key:"handleTouchStart",value:function(e){this.handleDragStart(e,e.changedTouches[0].clientX,e.changedTouches[0].clientY)}},{key:"handleTouchMove",value:function(e){this.handleDragMove(e.changedTouches[0].clientX,e.changedTouches[0].clientY)}},{key:"handleTouchEnd",value:function(){this.handleDragEnd()}},{key:"handleTouchCancel",value:function(){this.handleDragCancel()}},{key:"handleHeaderClick",value:function(e){var t=e.target.classList;if(t.contains("header")||t.contains("header__bullet")){var n=this.props,a=n.header,r=n.hasContent,i=n.isSelected;!r||a.get("opened")&&!i||this.props.org.toggleHeaderOpened(a.get("id")),this.props.org.selectHeader(a.get("id"))}}},{key:"handleEnterTitleEditMode",value:function(){this.props.org.enterEditMode("title")}},{key:"handleEnterDescriptionEditMode",value:function(){this.props.org.openHeader(this.props.header.get("id")),this.props.org.enterEditMode("description")}},{key:"handleShowTagsModal",value:function(){this.props.base.activatePopup("tags-editor")}},{key:"handleFocus",value:function(){this.props.org.focusHeader(this.props.header.get("id"))}},{key:"handleUnfocus",value:function(){this.props.org.unfocusHeader()}},{key:"handleAddNewHeader",value:function(){this.props.org.addHeaderAndEdit(this.props.header.get("id"))}},{key:"handleRest",value:function(){this.state.isPlayingRemoveAnimation&&this.props.org.removeHeader(this.props.header.get("id"))}},{key:"handleDeadlineAndScheduledClick",value:function(e){var t=this.props.header,n=t.get("planningItems",[]).findIndex((function(t){return t.get("type")===e}));-1===n?(this.props.org.addNewPlanningItem(t.get("id"),e),this.props.base.activatePopup("timestamp-editor",{headerId:t.get("id"),planningItemIndex:t.get("planningItems").size})):this.props.base.activatePopup("timestamp-editor",{headerId:t.get("id"),planningItemIndex:n}),this.props.org.openHeader(t.get("id"))}},{key:"handleDeadlineClick",value:function(){this.handleDeadlineAndScheduledClick("DEADLINE")}},{key:"handleClockInOutClick",value:function(){var e=this.props.header,t=e.get("logBookEntries",[]),n=t.findIndex((function(e){return null===e.get("end")})),a=he({isActive:!1,withStartTime:!0});-1!==n?this.props.org.setLogEntryStop(e.get("id"),t.getIn([n,"id"]),a):this.props.org.createLogEntryStart(e.get("id"),a)}},{key:"handleScheduledClick",value:function(){this.handleDeadlineAndScheduledClick("SCHEDULED")}},{key:"render",value:function(){var e=this,t=this.props,n=t.header,a=t.color,r=t.hasContent,i=t.isSelected,o=t.bulletStyle,s=t.focusedHeader,l=t.isFocused,u=t.shouldDisableActions,d=s?n.get("nestingLevel")-s.get("nestingLevel")+1:n.get("nestingLevel"),h=this.state,p=h.dragStartX,m=h.currentDragX,g=h.isDraggingFreely,f=h.isPlayingRemoveAnimation,b=h.containerWidth,y={paddingLeft:20*d,marginLeft:p&&m&&g?m-p:f?Object(Hr.spring)(-1*b,{stiffness:300}):Object(Hr.spring)(0,{stiffness:300}),heightFactor:f?Object(Hr.spring)(0,{stiffness:300}):1},v=Ar()("header",{"header--selected":i,"header--removing":f}),E=n.get("logBookEntries").filter((function(e){return void 0===e.get("raw")})),_=0!==E.size&&0!==E.filter((function(e){return!e.get("end")})).size;return c.a.createElement(Hr.Motion,{style:y,onRest:this.handleRest},(function(t){var s=t.marginLeft,d=s>=e.SWIPE_ACTION_ACTIVATION_DISTANCE,h=-1*s>=e.SWIPE_ACTION_ACTIVATION_DISTANCE,p=zr(211,211,211,1),m=zr(0,128,0,1),g=zr(255,0,0,1),b=zr(0,0,0,1),y=zr(255,255,255,1),E={width:t.marginLeft,backgroundColorFactor:Object(Hr.spring)(d?1:0,{stiffness:300})},T={width:-1*t.marginLeft,backgroundColorFactor:Object(Hr.spring)(h?1:0,{stiffness:300})},k=t.heightFactor,w=Object(Ur.a)(t,["heightFactor"]);return f&&(w.height=e.state.heightBeforeRemove*k),c.a.createElement("div",{className:v,style:w,ref:e.handleRef,onClick:e.handleHeaderClick,onMouseDown:e.handleMouseDown,onMouseMove:e.handleMouseMove,onMouseUp:e.handleMouseUp,onMouseOut:e.handleMouseOut,onTouchStart:e.handleTouchStart,onTouchMove:e.handleTouchMove,onTouchEnd:e.handleTouchEnd,onTouchCancel:e.handleTouchCancel},c.a.createElement(Hr.Motion,{style:E},(function(e){var t={width:e.width,backgroundColor:Yr(Kr(p,m,e.backgroundColorFactor))},n={display:s>30?"":"none",color:Yr(Kr(b,y,e.backgroundColorFactor))};return c.a.createElement("div",{className:"left-swipe-action-container",style:t},c.a.createElement("i",{className:"fas fa-check swipe-action-container__icon swipe-action-container__icon--left",style:n}))})),c.a.createElement(Hr.Motion,{style:T},(function(e){var t={width:e.width,backgroundColor:Yr(Kr(p,g,e.backgroundColorFactor))},n={display:-1*s>30?"":"none",color:Yr(Kr(b,y,e.backgroundColorFactor))};return c.a.createElement("div",{className:"right-swipe-action-container",style:t},c.a.createElement("i",{className:"fas fa-times swipe-action-container__icon swipe-action-container__icon--right",style:n}))})),c.a.createElement(Vr.UnmountClosed,{isOpened:i&&!u,springConfig:{stiffness:300},style:{marginRight:T.width}},c.a.createElement(ii,{onEnterTitleEditMode:e.handleEnterTitleEditMode,onEnterDescriptionEditMode:e.handleEnterDescriptionEditMode,isFocused:l,onTagsClick:e.handleShowTagsModal,onFocus:e.handleFocus,onUnfocus:e.handleUnfocus,onAddNewHeader:e.handleAddNewHeader,onDeadlineClick:e.handleDeadlineClick,onClockInOutClick:e.handleClockInOutClick,onScheduledClick:e.handleScheduledClick,hasActiveClock:_})),c.a.createElement("div",{style:{marginLeft:-16,color:a},className:"header__bullet"},"Fancy"===o?"\u25cf":"*"),c.a.createElement(Zr,{header:n,color:a,hasContent:r,isSelected:i,shouldDisableActions:u}),c.a.createElement(ri,{header:n,shouldDisableActions:u}))}))}}]),t}(s.PureComponent),si=Object(y.b)((function(e,t){var n=e.org.present.get("focusedHeaderId")?we(e.org.present.get("headers"),e.org.present.get("focusedHeaderId")):null;return{bulletStyle:e.base.get("bulletStyle"),focusedHeader:n,isFocused:!!n&&n.get("id")===t.header.get("id"),inEditMode:!!e.org.present.get("editMode")}}),(function(e){return{org:Object(v.b)(r,e),base:Object(v.b)(a,e)}}))(oi),ci=function(e){function t(e){var n;return Object(h.a)(this,t),(n=Object(m.a)(this,Object(g.a)(t).call(this,e))).headerRefs={},X.a.bindAll(Object(f.a)(n),["handleHeaderRef"]),n}return Object(b.a)(t,e),Object(p.a)(t,[{key:"componentDidUpdate",value:function(e){if(e.selectedHeaderId!==this.props.selectedHeaderId){var t=this.headerRefs[this.props.selectedHeaderId];if(t){var n=t.getBoundingClientRect(),a=document.documentElement.clientHeight;(n.top>.9*a||n.bottom<0)&&t.scrollIntoView()}}}},{key:"handleHeaderRef",value:function(e){var t=this;return function(n){return t.headerRefs[e]=n}}},{key:"render",value:function(){var e=this,t=this.props,n=t.headers,a=t.selectedHeaderId,r=t.focusedHeaderId,i=t.shouldDisableActions,o=n.map((function(e){return{header:e,displayed:!1,hasContent:!!e.get("rawDescription")||0!==e.get("planningItems").size||0!==e.get("propertyListItems").size||0!==e.get("logBookEntries").size}})).toArray();if(o.forEach((function(e,t){var n=e.header.get("nestingLevel");o.slice(0,t).every((function(e){return e.header.get("nestingLevel")>=n}))&&(e.displayed=!0);for(var a=o.slice(t+1),r=0;r<a.length;++r){var i=a[r];if(i.header.get("nestingLevel")<=n)break;e.hasContent=!0,i.displayed=e.header.get("opened")&&e.displayed}})),r){var s=o.findIndex((function(e){return e.header.get("id")===r}));o.slice(0,s).forEach((function(e){return e.displayed=!1}));var l=Ce(n,r);o.slice(s+l+1).forEach((function(e){return e.displayed=!1}))}var u=["var(--blue)","var(--green)","var(--cyan)","var(--yellow)","var(--blue)","var(--green)","var(--cyan)","var(--yellow)"],d=o.filter((function(e){return e.displayed})),h=Ar()("header-list-container",{"header-list-container--focused":!!r});return c.a.createElement("div",{className:h},d.map((function(t,n){var r=t.header,o=u[(r.get("nestingLevel")-1)%u.length];return c.a.createElement(si,{key:r.get("id"),header:r,color:o,hasContent:t.hasContent,isSelected:r.get("id")===a,onRef:e.handleHeaderRef(r.get("id")),shouldDisableActions:i})})))}}]),t}(s.PureComponent),li=Object(y.b)((function(e,t){return{headers:e.org.present.get("headers"),selectedHeaderId:e.org.present.get("selectedHeaderId"),focusedHeaderId:e.org.present.get("focusedHeaderId")}}),(function(e){return{}}))(ci),ui=n(49),di=(n(424),n(53)),hi=(n(425),function(e){function t(e){var n;return Object(h.a)(this,t),n=Object(m.a)(this,Object(g.a)(t).call(this,e)),X.a.bindAll(Object(f.a)(n),["handleClick"]),n}return Object(b.a)(t,e),Object(p.a)(t,[{key:"handleClick",value:function(){var e=this.props,t=e.onClick;e.isDisabled||t()}},{key:"render",value:function(){var e,t=this.props,n=t.iconName,a=t.subIconName,r=t.isDisabled,i=t.shouldRotateSubIcon,o=t.letter,s=t.additionalClassName,l=t.style,u=t.tooltip,d=t.shouldSpinSubIcon,h=t.onRef,p=Ar()("btn","btn--circle","action-drawer__btn",s||"",(e={fas:!o,"fa-lg":!o},Object(di.a)(e,"fa-".concat(n),!o),Object(di.a)(e,"action-drawer__btn--with-sub-icon",!!a),Object(di.a)(e,"btn--disabled",r),Object(di.a)(e,"action-drawer__btn--letter",!!o),e)),m=Ar()("fas","fa-xs","fa-".concat(a),"action-drawer__btn__sub-icon",{"action-drawer__btn__sub-icon--rotated":i,"fa-spin":d});return c.a.createElement("button",{className:p,onClick:this.handleClick,style:l,title:u,ref:h},!!o&&o,!!a&&c.a.createElement("i",{className:m}))}}]),t}(s.PureComponent)),pi=Object(y.b)((function(e,t){return{inEditMode:!!e.org.present.get("editMode"),selectedHeaderId:e.org.present.get("selectedHeaderId"),isDirty:e.org.present.get("isDirty"),isFocusedHeaderActive:!!e.org.present.get("focusedHeaderId"),selectedTableCellId:e.org.present.get("selectedTableCellId"),captureTemplates:e.capture.get("captureTemplates",new q.List),path:e.org.present.get("path"),isLoading:e.base.get("isLoading")}}),(function(e){return{org:Object(v.b)(r,e),capture:Object(v.b)(i,e),base:Object(v.b)(a,e)}}))((function(e){var t=e.org,n=e.selectedHeaderId,a=e.base,r=e.staticFile,i=e.captureTemplates,o=e.path,l=e.selectedTableCellId,u=e.inEditMode,h=e.isLoading,p=e.shouldDisableSyncButtons,m=Object(s.useState)(!1),g=Object(d.a)(m,2),f=g[0],b=g[1],y=Object(s.useState)(!1),v=Object(d.a)(y,2),E=v[0],_=v[1];Object(s.useEffect)((function(){return document.querySelector("html").style.paddingBottom="90px",function(){return document.querySelector("html").style.paddingBottom="0px"}}));var T=Object(s.useRef)(null),k=Object(s.useMemo)((function(){return T.current?T.current.getBoundingClientRect():null}),[T]),w=function(){return n?t.moveHeaderUp(n):t.moveTableRowUp()},I=function(){return n?t.moveHeaderDown(n):t.moveTableRowDown()},C=function(){return n?t.moveHeaderLeft(n):t.moveTableColumnLeft()},S=function(){return n?t.moveHeaderRight(n):t.moveTableColumnRight()},O=function(){return t.moveSubtreeLeft(n)},D=function(){return t.moveSubtreeRight(n)},A=function(){return"sample"===r?Fe:i.filter((function(e){return e.get("isAvailableInAllOrgFiles")||e.get("orgFilesWhereAvailable").map((function(e){return e.trim().startsWith("/")?e.trim():"/"+e.trim()})).includes((o||"").trim())}))},N=function(){return b(!f)},P=function(){E||0!==A().size?_(!E):alert("You don't have any capture templates set up for this file! Add some in Settings > Capture Templates")};return c.a.createElement("div",{className:"action-drawer-container nice-scroll"},u?c.a.createElement("button",{className:"btn action-drawer__done-btn",onClick:function(){return t.exitEditMode()}},"Done"):c.a.createElement(s.Fragment,null,c.a.createElement(hi,{iconName:"cloud",subIconName:"sync-alt",shouldSpinSubIcon:h,isDisabled:p,onClick:function(){return t.sync()},style:{opacity:f||E?0:1},tooltip:"Sync changes"}),function(){var e={opacity:E?0:1};f||(e.boxShadow="none");var t=0;k&&(t=window.screen.width/2-(k.x+k.width/2));var n={centerXOffset:Object(Hr.spring)(f?t:0,{stiffness:300}),topRowYOffset:Object(Hr.spring)(f?150:0,{stiffness:300}),bottomRowYOffset:Object(Hr.spring)(f?80:0,{stiffness:300}),firstColumnXOffset:Object(Hr.spring)(f?70:0,{stiffness:300}),secondColumnXOffset:Object(Hr.spring)(f?140:0,{stiffness:300})};return c.a.createElement(Hr.Motion,{style:n},(function(t){return c.a.createElement("div",{className:"action-drawer__arrow-buttons-container",style:{left:t.centerXOffset}},c.a.createElement(hi,{additionalClassName:"action-drawer__arrow-button",iconName:"arrow-up",subIconName:l?"table":null,isDisabled:!1,onClick:w,style:Object(ui.a)({},e,{bottom:t.topRowYOffset}),tooltip:l?"Move row up":"Move header up"}),c.a.createElement(hi,{additionalClassName:"action-drawer__arrow-button",iconName:"arrow-down",subIconName:l?"table":null,isDisabled:!1,onClick:I,style:Object(ui.a)({},e,{bottom:t.bottomRowYOffset}),tooltip:l?"Move row down":"Move header down"}),c.a.createElement(hi,{additionalClassName:"action-drawer__arrow-button",iconName:"arrow-left",subIconName:l?"table":null,isDisabled:!1,onClick:C,style:Object(ui.a)({},e,{bottom:t.bottomRowYOffset,right:t.firstColumnXOffset}),tooltip:l?"Move column left":"Move header left"}),c.a.createElement(hi,{additionalClassName:"action-drawer__arrow-button",iconName:"arrow-right",subIconName:l?"table":null,isDisabled:!1,onClick:S,style:Object(ui.a)({},e,{bottom:t.bottomRowYOffset,left:t.firstColumnXOffset}),tooltip:l?"Move column right":"Move header right"}),!l&&c.a.createElement(s.Fragment,null,c.a.createElement(hi,{additionalClassName:"action-drawer__arrow-button",iconName:"chevron-left",isDisabled:!1,onClick:O,style:Object(ui.a)({},e,{bottom:t.bottomRowYOffset,right:t.secondColumnXOffset}),tooltip:"Move entire subtree left"}),c.a.createElement(hi,{additionalClassName:"action-drawer__arrow-button",iconName:"chevron-right",isDisabled:!1,onClick:D,style:Object(ui.a)({},e,{bottom:t.bottomRowYOffset,left:t.secondColumnXOffset}),tooltip:"Move entire subtree right"})),c.a.createElement(hi,{iconName:f?"times":"arrows-alt",subIconName:l?"table":null,additionalClassName:"action-drawer__main-arrow-button",isDisabled:!1,onClick:N,style:{opacity:E?0:1},tooltip:f?"Hide movement buttons":"Show movement buttons",onRef:T}))}))}(),c.a.createElement(hi,{iconName:"calendar-alt",shouldSpinSubIcon:h,isDisabled:!1,onClick:function(){return a.activatePopup("agenda")},style:{opacity:f||E?0:1},tooltip:"Show agenda"}),function(){var e=A(),t={position:"absolute",zIndex:0,left:0,opacity:f?0:1};E||(t.boxShadow="none");var n={opacity:f?0:1,position:"relative",zIndex:1},r={bottom:Object(Hr.spring)(E?70:0,{stiffness:300})};return c.a.createElement(Hr.Motion,{style:r},(function(r){return c.a.createElement("div",{className:"action-drawer__capture-buttons-container"},c.a.createElement(hi,{iconName:E?"times":"list-ul",isDisabled:!1,onClick:P,style:n,tooltip:E?"Hide capture templates":"Show capture templates"}),e.map((function(e,n){return c.a.createElement(hi,{key:e.get("id"),letter:e.get("letter"),iconName:e.get("iconName"),isDisabled:!1,onClick:(i=e.get("id"),function(){_(!1),a.activatePopup("capture",{templateId:i})}),style:Object(ui.a)({},t,{bottom:r.bottom*(n+1)}),tooltip:'Activate "'.concat(e.get("description"),'" capture template')});var i})))}))}()))})),mi=n(225),gi=n.n(mi).a.getParser(window.navigator.userAgent).satisfies({mobile:{safari:">=13"}}),fi=!!window.matchMedia&&window.matchMedia("(max-device-width: 812px) and (-webkit-device-pixel-ratio : 3)").matches,bi=!!window.matchMedia&&window.matchMedia("(min-device-width: 375px) and (-webkit-device-pixel-ratio : 2)").matches,yi="standalone"in window.navigator&&window.navigator.standalone;function vi(){return[90,-90].includes(window.orientation)}n(426),n(427);var Ei=function(e){var t=e.isEnabled,n=e.onToggle,a=zr(255,255,255,1),r=zr(238,232,213,1),i={colorFactor:Object(Hr.spring)(t?1:0,{stiffness:300})},o={marginLeft:Object(Hr.spring)(t?42:0,{stiffness:300})};return c.a.createElement(Hr.Motion,{style:i},(function(e){var t=Yr(Kr(a,r,e.colorFactor));return c.a.createElement("div",{className:"switch",style:{backgroundColor:t},onClick:n},c.a.createElement(Hr.Motion,{style:o},(function(e){return c.a.createElement("div",{className:"switch__grabber",style:e})})))}))},_i=(n(428),function(e){var t=e.children,n=e.shouldIncludeCloseButton,a=e.onClose,r=Object(s.useState)(!1),i=Object(d.a)(r,2),o=i[0],l=i[1],u=Object(s.useState)(null),h=Object(d.a)(u,2),p=h[0],m=h[1];Object(s.useLayoutEffect)((function(){l(!0)}),[]);var g=Object(s.useRef)(),f=Object(s.useRef)(),b=Object(s.useRef)();Object(s.useLayoutEffect)((function(){b.current=f.current.offsetHeight}));var y=function(e){return e.stopPropagation()},v=function(){return l(!1)},E=function(e){return g.current=e.targetTouches[0].clientY},_=function(e){if(!e.target.classList.contains("drag-handle")){var t=g.current>e.targetTouches[0].clientY;t&&f.current.scrollHeight-f.current.scrollTop<=f.current.clientHeight?e.preventDefault():t||0!==f.current.scrollTop||(e.preventDefault(),m(e.targetTouches[0].clientY-g.current))}};Object(s.useEffect)((function(){var e=function(e){return l(p<=.3*b.current),void m(null)};if(f.current){f.current.addEventListener("touchstart",E),f.current.addEventListener("touchmove",_),f.current.addEventListener("touchend",e),f.current.addEventListener("touchcancel",e);var t=f.current;return function(){t.removeEventListener("touchstart",E),t.removeEventListener("touchmove",_),t.removeEventListener("touchend",e),t.removeEventListener("touchcancel",e)}}return null}),[f,p]);var T=Ar()("drawer-outer-container",{"drawer-outer-container--visible":o}),k={offsetY:p||Object(Hr.spring)(o?0:b.current||window.innerHeight,{stiffness:300})};return c.a.createElement(Hr.Motion,{style:k,onRest:function(){return!o&&a?a():void 0}},(function(e){var r={transform:"translateY(".concat(e.offsetY,"px)")};return c.a.createElement("div",{className:T,onClick:a?v:null},c.a.createElement("div",{onClick:y,className:"drawer-inner-container nice-scroll",ref:f,style:r},c.a.createElement("div",{className:"drawer__grabber"}),n&&c.a.createElement("button",{className:"fas fa-times fa-lg drawer__close-button",onClick:v}),t))}))}),Ti=function(e){var t=e.template,n=e.onCapture,a=e.headers,r=e.onClose,i=Object(s.useMemo)((function(){return _e(t.get("template"))}),[t]),o=Object(d.a)(i,2),l=o[0],u=o[1],h=Object(s.useMemo)((function(){return Ne(a,t.get("headerPaths"))}),[a,t]),p=Object(s.useState)(l),m=Object(d.a)(p,2),g=m[0],f=m[1],b=Object(s.useState)(t.get("shouldPrepend")),y=Object(d.a)(b,2),v=y[0],E=y[1],_=Object(s.useRef)(null);Object(s.useEffect)((function(){_.current&&_.current.focus(),_.current.setSelectionRange(u,u)}),[_,u]);return c.a.createElement(_i,{onClose:r},c.a.createElement("div",{className:"capture-modal-header"},c.a.createElement(hi,{letter:t.get("letter"),iconName:t.get("iconName"),isDisabled:!1,onClick:function(){},style:{marginRight:20}}),c.a.createElement("span",null,t.get("description"))),c.a.createElement("div",{className:"capture-modal-header-path"},t.get("headerPaths").join(" > ")),h?c.a.createElement(s.Fragment,null,c.a.createElement("textarea",{className:"textarea capture-modal-textarea",rows:"4",value:g,onChange:function(e){return f(e.target.value)},autoFocus:!0,ref:_}),c.a.createElement("div",{className:"capture-modal-button-container"},c.a.createElement("div",{className:"capture-modal-prepend-container"},c.a.createElement("span",{className:"capture-modal-prepend-label"},"Prepend:"),c.a.createElement(Ei,{isEnabled:v,onToggle:function(){return E(!v)}})),c.a.createElement("button",{className:"btn capture-modal-button",onClick:function(){return n(t.get("id"),g,v)}},"Capture")),gi&&c.a.createElement("div",{style:{minHeight:gi?yi?vi()?"9em":fi?"23em":bi?"19em":"auto":vi()?"9em":fi?"18em":bi?"18em":"auto":"auto"}})):c.a.createElement("div",{className:"capture-modal-error-message"},"The specified header path doesn't exist in this org file!"),c.a.createElement("br",null))},ki=(n(429),n(494)),wi=function(e){var t=e.lastServerModifiedAt,n=e.onPull,a=e.onPush,r=e.onCancel;return c.a.createElement(_i,null,c.a.createElement("h2",{className:"sync-confirmation-modal__header"},"Sync conflict"),"Since you last pulled, a newer version of the file has been pushed to the server. The newer version is from:",c.a.createElement("br",null),c.a.createElement("br",null),c.a.createElement("div",{className:"sync-confirmation-modal__last-sync-time"},Object($.a)(t,"MMMM do, yyyy [at] h:mm:ss a"),c.a.createElement("br",null),"(",Object(ki.a)(t)," ago)"),c.a.createElement("div",{className:"sync-confirmation-modal__buttons-container"},c.a.createElement("button",{className:"btn sync-confirmation-modal__button",onClick:n},"Pull latest version from server"),c.a.createElement("button",{className:"btn sync-confirmation-modal__button",onClick:a},"Overwrite server version"),c.a.createElement("button",{className:"btn sync-confirmation-modal__button",onClick:r},"Cancel sync")),c.a.createElement("br",null))},Ii=(n(430),function(e){function t(e){var n;return Object(h.a)(this,t),n=Object(m.a)(this,Object(g.a)(t).call(this,e)),X.a.bindAll(Object(f.a)(n),["handleRemoveTag","handleAddNewTag","handleTagChange"]),n.state={allTags:e.allTags},n}return Object(b.a)(t,e),Object(p.a)(t,[{key:"componentDidUpdate",value:function(e){var t=e.header.getIn(["titleLine","tags"]),n=this.props.header.getIn(["titleLine","tags"]);t.size===n.size-1&&""===n.last()&&this.lastTextfield&&this.lastTextfield.focus()}},{key:"handleTagChange",value:function(e){var t=this;return function(n){var a=t.props.header.getIn(["titleLine","tags"]);t.props.onChange(a.set(e,n.target.value.replace(/(\s+|:)/g,"")))}}},{key:"handleRemoveTag",value:function(e){var t=this;return function(){var n=t.props.header.getIn(["titleLine","tags"]);t.props.onChange(n.delete(e))}}},{key:"handleAddNewTag",value:function(){var e=this.props.header.getIn(["titleLine","tags"]);this.props.onChange(e.push(""))}},{key:"handleExistingTagClick",value:function(e){var t=this;return function(){var n=t.props.header.getIn(["titleLine","tags"]);n.includes(e)?t.props.onChange(n.filter((function(t){return t!==e}))):t.props.onChange(n.push(e))}}},{key:"render",value:function(){var e=this,t=this.props,n=t.header,a=t.onClose,r=this.state.allTags,i=n.getIn(["titleLine","tags"]);return c.a.createElement(_i,{onClose:a},c.a.createElement("h2",{className:"drawer-modal__title"},"Edit tags"),0===i.size?c.a.createElement("div",{className:"no-tags-message"},"This header doesn't have any tags.",c.a.createElement("br",null),c.a.createElement("br",null),"Click the ",c.a.createElement("i",{className:"fas fa-plus"})," button to add a new one, or choose from the list of all of your tags below."):c.a.createElement(gr.c,{droppableId:"tags-editor-droppable",type:"TAG"},(function(t,n){return c.a.createElement("div",Object.assign({className:"tags-container",ref:t.innerRef},t.droppableProps),c.a.createElement(s.Fragment,null,i.map((function(t,n){return c.a.createElement(gr.b,{draggableId:"tag--".concat(n),index:n,key:n},(function(a,r){return c.a.createElement("div",Object.assign({className:Ar()("tag-container",{"tag-container--dragging":r.isDragging}),ref:a.innerRef},a.draggableProps),c.a.createElement("input",{type:"text",className:"textfield tag-container__textfield",value:t,onChange:e.handleTagChange(n),ref:function(t){return e.lastTextfield=t}}),c.a.createElement("div",{className:"tag-container__actions-container"},c.a.createElement("i",{className:"fas fa-times fa-lg",onClick:e.handleRemoveTag(n)}),c.a.createElement("i",Object.assign({className:"fas fa-bars fa-lg tag-container__drag-handle drag-handle"},a.dragHandleProps))))}))})),t.placeholder))})),c.a.createElement("div",{className:"tags-editor__add-new-container"},c.a.createElement("button",{className:"fas fa-plus fa-lg btn btn--circle",onClick:this.handleAddNewTag})),c.a.createElement("hr",{className:"tags-editor__separator"}),c.a.createElement("h2",{className:"tags-editor__title"},"All tags"),c.a.createElement("div",{className:"all-tags-container"},r.filter((function(e){return!!e})).map((function(t){var n=Ar()("all-tags__tag",{"all-tags__tag--in-use":i.includes(t)});return c.a.createElement("div",{className:n,key:t,onClick:e.handleExistingTagClick(t)},t)}))))}}]),t}(s.PureComponent)),Ci=(n(465),n(466),n(467),function(e){var t=e.buttons,n=e.selectedButton,a=e.useEqualWidthTabs,r=e.onSelect,i=function(e){return function(){return r(e)}},o=Ar()("tab-buttons",{"tab-buttons--equal-width-tabs":a}),s={gridTemplateColumns:a?"repeat(".concat(t.length,", 1fr)"):null};return c.a.createElement("div",{className:o,style:s},t.map((function(e){var t=Ar()("tab-buttons__btn",{"tab-buttons__btn--selected":e===n});return c.a.createElement("div",{key:e,className:t,onClick:i(e)},e)})))}),Si=function(e){function t(e){var n;return Object(h.a)(this,t),n=Object(m.a)(this,Object(g.a)(t).call(this,e)),X.a.bindAll(Object(f.a)(n),["handleActiveToggle","handleDateChange","handleAddRepeater","handleRemoveRepeater","handleRepeaterTypeChange","handleRepeaterValueChange","handleRepeaterUnitChange","handleAddDelay","handleRemoveDelay","handleDelayTypeChange","handleDelayValueChange","handleDelayUnitChange"]),n}return Object(b.a)(t,e),Object(p.a)(t,[{key:"handleActiveToggle",value:function(){this.props.onChange(this.props.timestamp.update("isActive",(function(e){return!e})))}},{key:"handleDateChange",value:function(e,t){if(X.a.isEmpty(e.target.value))X.a.isNumber(t)&&this.props.org.removePlanningItem(this.props.selectedHeaderId,t),this.props.onClose();else{var n=this.props,a=n.onChange,r=n.timestamp,i=Object($.a)(Object(Ve.a)(e.target.value),"yyyy MM dd eee").split(" "),o=Object(d.a)(i,4),s=o[0],c=o[1],l=o[2],u=o[3];a(r.set("year",s).set("month",c).set("day",l).set("dayName",u))}}},{key:"handleAddTime",value:function(e){var t=this;return function(){var n=t.props,a=n.onChange,r=n.timestamp,i="start"===e?["startHour","startMinute"]:["endHour","endMinute"],o=Object(d.a)(i,2),s=o[0],c=o[1],l=Object($.a)(new Date,"HH:mm").split(":"),u=Object(d.a)(l,2),h=u[0],p=u[1];a(r.set(s,h).set(c,p))}}},{key:"handleRemoveTime",value:function(e){var t=this;return function(){var n=t.props,a=n.onChange,r=n.timestamp,i="start"===e?["startHour","startMinute"]:["endHour","endMinute"],o=Object(d.a)(i,2),s=o[0],c=o[1];a(r.set(s,null).set(c,null))}}},{key:"handleTimeChange",value:function(e){var t=this;return function(n){var a=t.props,r=a.onChange,i=a.timestamp,o="start"===e?["startHour","startMinute"]:["endHour","endMinute"],s=Object(d.a)(o,2),c=s[0],l=s[1],u=n.target.value.split(":"),h=Object(d.a)(u,2),p=h[0],m=h[1];p=p.startsWith("0")?p.substring(1):p,r(i.set(c,p).set(l,m))}}},{key:"handleAddRepeater",value:function(){var e=this.props;(0,e.onChange)(e.timestamp.set("repeaterType","+").set("repeaterValue",1).set("repeaterUnit","h"))}},{key:"handleRemoveRepeater",value:function(){var e=this.props;(0,e.onChange)(e.timestamp.set("repeaterType",null).set("repeaterValue",null).set("repeaterUnit",null))}},{key:"handleRepeaterTypeChange",value:function(e){var t=this.props;(0,t.onChange)(t.timestamp.set("repeaterType",e))}},{key:"handleRepeaterValueChange",value:function(e){var t=this.props;(0,t.onChange)(t.timestamp.set("repeaterValue",e.target.value))}},{key:"handleRepeaterUnitChange",value:function(e){var t=this.props;(0,t.onChange)(t.timestamp.set("repeaterUnit",e))}},{key:"handleAddDelay",value:function(){var e=this.props;(0,e.onChange)(e.timestamp.set("delayType","-").set("delayValue",1).set("delayUnit","h"))}},{key:"handleRemoveDelay",value:function(){var e=this.props;(0,e.onChange)(e.timestamp.set("delayType",null).set("delayValue",null).set("delayUnit",null))}},{key:"handleDelayTypeChange",value:function(e){var t=this.props;(0,t.onChange)(t.timestamp.set("delayType",e))}},{key:"handleDelayValueChange",value:function(e){var t=this.props;(0,t.onChange)(t.timestamp.set("delayValue",e.target.value))}},{key:"handleDelayUnitChange",value:function(e){var t=this.props;(0,t.onChange)(t.timestamp.set("delayUnit",e))}},{key:"renderTimeField",value:function(e,t,n,a){var r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];return c.a.createElement("div",{className:"timestamp-editor__field-container timestamp-editor__field-container--inline"},c.a.createElement("div",{className:"timestamp-editor__field-title"},e),c.a.createElement("div",{className:"timestamp-editor__field"},n?c.a.createElement(s.Fragment,null,c.a.createElement("input",{type:"time",className:"timestamp-editor__time-input",value:"".concat(n.padStart(2,"0"),":").concat(a.padStart(2,"0")),onChange:this.handleTimeChange(t)}),r&&c.a.createElement("i",{className:"fas fa-times fa-lg timestamp-editor__icon timestamp-editor__icon--remove",onClick:this.handleRemoveTime(t)})):c.a.createElement("i",{className:"fas fa-plus timestamp-editor__icon timestamp-editor__icon--add",onClick:this.handleAddTime(t)})))}},{key:"renderRepeater",value:function(){var e=this.props.timestamp.toJS(),t=e.repeaterType,n=e.repeaterValue,a=e.repeaterUnit;return c.a.createElement("div",{className:"timestamp-editor__field-container"},c.a.createElement("div",{className:"timestamp-editor__field-title"},"Repeater"),c.a.createElement("div",{className:"timestamp-editor__field timestamp-editor__field--delay-repeater"},t?c.a.createElement(s.Fragment,null,c.a.createElement("div",{className:"timestamp-editor__delay-repeater-type"},c.a.createElement(Ci,{buttons:["+","++",".+"],selectedButton:t||"+",onSelect:this.handleRepeaterTypeChange})),c.a.createElement("input",{type:"number",min:"1",className:"textfield delay-repeater-value-input",value:n||1,onChange:this.handleRepeaterValueChange}),c.a.createElement("div",null,c.a.createElement(Ci,{buttons:"hdwmy".split(""),selectedButton:a||"h",onSelect:this.handleRepeaterUnitChange})),c.a.createElement("i",{className:"fas fa-times fa-lg timestamp-editor__icon timestamp-editor__icon--remove",onClick:this.handleRemoveRepeater})):c.a.createElement("i",{className:"fas fa-plus timestamp-editor__icon timestamp-editor__icon--add",onClick:this.handleAddRepeater})))}},{key:"renderDelay",value:function(){var e=this.props.timestamp.toJS(),t=e.delayType,n=e.delayValue,a=e.delayUnit;return c.a.createElement("div",{className:"timestamp-editor__field-container"},c.a.createElement("div",{className:"timestamp-editor__field-title"},"Delay"),c.a.createElement("div",{className:"timestamp-editor__field"},t?c.a.createElement(s.Fragment,null,c.a.createElement("div",{className:"timestamp-editor__delay-repeater-type"},c.a.createElement(Ci,{buttons:["-","--"],selectedButton:t||"-",onSelect:this.handleDelayTypeChange})),c.a.createElement("input",{type:"number",min:"1",className:"textfield delay-repeater-value-input",value:n||1,onChange:this.handleDelayValueChange}),c.a.createElement("div",null,c.a.createElement(Ci,{buttons:"hdwmy".split(""),selectedButton:a||"h",onSelect:this.handleDelayUnitChange})),c.a.createElement("i",{className:"fas fa-times fa-lg timestamp-editor__icon timestamp-editor__icon--remove",onClick:this.handleRemoveDelay})):c.a.createElement("i",{className:"fas fa-plus timestamp-editor__icon timestamp-editor__icon--add",onClick:this.handleAddDelay})))}},{key:"render",value:function(){var e=this,t=this.props,n=t.timestamp,a=t.planningItemIndex,r=n.toJS(),i=r.isActive,o=r.year,s=r.month,l=r.day,u=r.startHour,d=r.startMinute,h=r.endHour,p=r.endMinute;return c.a.createElement("div",null,c.a.createElement("div",{className:"timestamp-editor__render"},de(n)),c.a.createElement("div",{className:"timestamp-editor__date-time-fields-container"},c.a.createElement("div",{className:"timestamp-editor__field-container timestamp-editor__field-container--inline"},c.a.createElement("div",{className:"timestamp-editor__field-title"},"Active"),c.a.createElement("div",{className:"timestamp-editor__field"},c.a.createElement(Ei,{isEnabled:i,onToggle:this.handleActiveToggle}))),c.a.createElement("div",{className:"timestamp-editor__field-container timestamp-editor__field-container--inline"},c.a.createElement("div",{className:"timestamp-editor__field-title"},"Date"),c.a.createElement("div",{className:"timestamp-editor__field"},c.a.createElement("input",{"data-testid":"timestamp-selector",type:"date",className:"timestamp-editor__date-input",onChange:function(t){return e.handleDateChange(t,a)},onFocus:function(e){return e.nativeEvent.target.defaultValue=""},value:"".concat(o,"-").concat(s,"-").concat(l)}))),this.renderTimeField("Start time","start",u,d,!h),!!u&&this.renderTimeField("End time","end",h,p)),this.renderRepeater(),this.renderDelay())}}]),t}(s.PureComponent),Oi=Object(y.b)((function(e){return{selectedHeaderId:e.org.present.get("selectedHeaderId")}}),(function(e){return{org:Object(v.b)(r,e)}}))(Si),Di=function(e){function t(e){var n;return Object(h.a)(this,t),n=Object(m.a)(this,Object(g.a)(t).call(this,e)),X.a.bindAll(Object(f.a)(n),["handleAddEndTimestamp","handleRemoveEndTimestamp"]),n}return Object(b.a)(t,e),Object(p.a)(t,[{key:"handleChange",value:function(e){var t=this;return function(n){return t.props.onChange(t.props.timestamp.set(e,n))}}},{key:"handleAddEndTimestamp",value:function(){var e=this.props.timestamp,t=Object($.a)(new Date,"yyyy MM dd eee").split(" "),n=Object(d.a)(t,4),a=n[0],r=n[1],i=n[2],o=n[3];this.props.onChange(e.set("secondTimestamp",Object(q.Map)({year:a,month:r,day:i,dayName:o,isActive:e.getIn(["firstTimestamp","isActive"])})))}},{key:"handleRemoveEndTimestamp",value:function(){this.props.onChange(this.props.timestamp.set("secondTimestamp",null))}},{key:"render",value:function(){var e=this.props,t=e.timestamp,n=e.onClose,a=e.singleTimestampOnly,r=e.planningItemIndex;return c.a.createElement(_i,{onClose:n},c.a.createElement("h2",{className:"timestamp-editor__title"},"Edit timestamp"),c.a.createElement(Oi,{timestamp:t.get("firstTimestamp"),planningItemIndex:r,onClose:n,onChange:this.handleChange("firstTimestamp")}),!a&&(t.get("secondTimestamp")?c.a.createElement(s.Fragment,null,c.a.createElement("div",{className:"timestamp-editor__separator"},c.a.createElement("div",{className:"timestamp-editor__separator__margin-line"}),"to",c.a.createElement("div",{className:"timestamp-editor__separator__margin-line"})),c.a.createElement(Oi,{timestamp:t.get("secondTimestamp"),onChange:this.handleChange("secondTimestamp")}),c.a.createElement("div",{className:"timestamp-editor__button-container"},c.a.createElement("button",{className:"btn timestamp-editor__add-new-button",onClick:this.handleRemoveEndTimestamp},"Remove end timestamp"))):c.a.createElement("div",{className:"timestamp-editor__button-container"},c.a.createElement("button",{className:"btn timestamp-editor__add-new-button",onClick:this.handleAddEndTimestamp},"Add end timestamp"))),c.a.createElement("br",null))}}]),t}(s.PureComponent),Ai=(n(468),function(e){function t(e){var n;return Object(h.a)(this,t),n=Object(m.a)(this,Object(g.a)(t).call(this,e)),X.a.bindAll(Object(f.a)(n),["handleAddNewItem"]),n}return Object(b.a)(t,e),Object(p.a)(t,[{key:"componentDidUpdate",value:function(e){var t=e.propertyListItems,n=this.props.propertyListItems;t.size===n.size-1&&""===n.last().get("property")&&this.lastTextfield&&this.lastTextfield.focus()}},{key:"handlePropertyChange",value:function(e){var t=this;return function(n){var a=t.props.propertyListItems.findIndex((function(t){return t.get("id")===e}));t.props.onChange(t.props.propertyListItems.setIn([a,"property"],n.target.value))}}},{key:"handleValueChange",value:function(e){var t=this;return function(n){var a=t.props,r=a.propertyListItems,i=a.onChange,o=r.findIndex((function(t){return t.get("id")===e}));i(r.setIn([o,"value"],Object(q.fromJS)(Bn(n.target.value))))}}},{key:"handleRemoveItem",value:function(e){var t=this;return function(){return t.props.onChange(t.props.propertyListItems.filter((function(t){return t.get("id")!==e})))}}},{key:"handleAddNewItem",value:function(){this.props.onChange(this.props.propertyListItems.push(Object(q.fromJS)({property:"",value:"",id:Te()})))}},{key:"render",value:function(){var e=this,t=this.props,n=t.onClose,a=t.propertyListItems;return c.a.createElement(_i,{onClose:n},c.a.createElement("h2",{className:"drawer-modal__title"},"Edit property list"),0===a.size?c.a.createElement("div",{className:"no-items-message"},"There are no items in this property list.",c.a.createElement("br",null),c.a.createElement("br",null),"Click the ",c.a.createElement("i",{className:"fas fa-plus"})," button to add a new one."):c.a.createElement(gr.c,{droppableId:"property-list-editor-droppable",type:"PROPERTY-LIST"},(function(t,n){return c.a.createElement("div",Object.assign({className:"property-list-editor__items-container",ref:t.innerRef},t.droppableProps),c.a.createElement(s.Fragment,null,a.map((function(t,n){return c.a.createElement(gr.b,{draggableId:"property-list-item--".concat(n),index:n,key:t.get("id")},(function(n,a){return c.a.createElement("div",Object.assign({className:Ar()("property-list-editor__item-container",{"property-list-editor__item-container--dragging":a.isDragging}),ref:n.innerRef},n.draggableProps),c.a.createElement("div",{className:"item__textfields-container"},c.a.createElement("input",{type:"text",className:"textfield item-container__textfield",value:t.get("property"),onChange:e.handlePropertyChange(t.get("id")),ref:function(t){return e.lastTextfield=t}}),c.a.createElement("input",{type:"text",className:"textfield item-container__textfield",value:ve(t.get("value")),onChange:e.handleValueChange(t.get("id"))})),c.a.createElement("div",{className:"item-container__actions-container"},c.a.createElement("i",{className:"fas fa-times fa-lg",onClick:e.handleRemoveItem(t.get("id"))}),c.a.createElement("i",Object.assign({className:"fas fa-bars fa-lg item-container__drag-handle drag-handle"},n.dragHandleProps))))}))})),t.placeholder))})),c.a.createElement("div",{className:"property-list-editor__add-new-container"},c.a.createElement("button",{className:"fas fa-plus fa-lg btn btn--circle",onClick:this.handleAddNewItem})))}}]),t}(s.PureComponent)),Ni=(n(469),n(470),n(144)),Pi=n(488),Li=n(496),ji=n(489),Mi=n(490),Ri=n(491),xi=function(e){function t(){return Object(h.a)(this,t),Object(m.a)(this,Object(g.a)(t).apply(this,arguments))}return Object(b.a)(t,e),Object(p.a)(t,[{key:"handleHeaderClick",value:function(e){var t=this;return function(){return t.props.onHeaderClick(e)}}},{key:"render",value:function(){var e=this,t=this.props,n=t.date,a=t.headers,r=t.todoKeywordSets,i=t.dateDisplayType,o=t.onToggleDateDisplayType,l=t.agendaDefaultDeadlineDelayValue,u=t.agendaDefaultDeadlineDelayUnit,h=Object(Ni.a)(n),p=Object(Pi.a)(n),m=this.getPlanningItemsAndHeaders({headers:a,todoKeywordSets:r,date:n,agendaDefaultDeadlineDelayValue:l,agendaDefaultDeadlineDelayUnit:u,dateStart:h,dateEnd:p});return c.a.createElement("div",{className:"agenda-day__container"},c.a.createElement("div",{className:"agenda-day__title"},Object(Li.a)(n)&&c.a.createElement("div",{className:"agenda-day__today-indicator"}),c.a.createElement("div",{className:"agenda-day__title__day-name"},Object($.a)(n,"eeee")),c.a.createElement("div",{className:"agenda-day__title__date"},Object($.a)(n,"MMMM do, yyyy"))),c.a.createElement("div",{className:"agenda-day__headers-container"},m.map((function(t){var n=Object(d.a)(t,2),a=n[0],r=n[1],l=me(a.get("timestamp")),u=!!r.getIn(["titleLine","todoKeyword"]),h=Ar()("agenda-day__header-planning-date",{"agenda-day__header-planning-date--overdue":u&&Object(ji.a)(l)});return c.a.createElement("div",{key:a.get("id"),className:"agenda-day__header-container"},c.a.createElement("div",{className:"agenda-day__header__planning-item-container"},c.a.createElement("div",{className:"agenda-day__header-planning-type"},a.get("type")),c.a.createElement("div",{className:h,onClick:o},"absolute"===i?Object($.a)(l,"MM/dd"):"".concat(Object(ki.a)(l)," ago"),!!a.getIn(["timestamp","startHour"])&&c.a.createElement(s.Fragment,null,c.a.createElement("br",null),Object($.a)(l,"h:mma")))),c.a.createElement("div",{className:"agenda-day__header__header-container"},c.a.createElement(Zr,{header:r,color:"black",hasContent:!1,isSelected:!1,shouldDisableActions:!0,shouldDisableExplicitWidth:!0,onClick:e.handleHeaderClick(r.get("id"))})))}))))}},{key:"getPlanningItemsAndHeaders",value:function(e){var t=e.headers,n=e.todoKeywordSets,a=e.date,r=e.agendaDefaultDeadlineDelayValue,i=e.agendaDefaultDeadlineDelayUnit,o=e.dateStart,s=e.dateEnd;return t.flatMap((function(e){return e.get("planningItems").filter((function(t){var c=t.get("timestamp");if(!c.get("isActive"))return!1;var l=me(c);if(!!e.getIn(["titleLine","todoKeyword"])&&function(e,t){return He(e,t).get("completedKeywords").includes(t)}(n,e.getIn(["titleLine","todoKeyword"])))return!1;if("DEADLINE"===t.get("type")){if(Object(Li.a)(a)){if(Object(le.a)(l,new Date))return!0;var u=c.get("delayType")?[c.get("delayValue"),c.get("delayUnit")]:[r,i],h=Object(d.a)(u,2),p=function(e,t,n){return{h:Object(re.a)(e,t),d:Object(ie.a)(e,t),w:Object(oe.a)(e,t),m:Object(se.a)(e,t),y:Object(ce.a)(e,t)}[n]}(l,h[0],h[1]);return Object(Be.a)(a,p)||Object(Mi.a)(a,p)}return Object(Ri.a)(l,{start:o,end:s})}if("SCHEDULED"===t.get("type")){var m=l;if(c.get("delayType")){var g=e.get("propertyListItems").some((function(e){return"LAST_REPEAT"===e.get("property")}));"--"!==c.get("delayType")||g||(m=ge(l,c.get("delayValue"),c.get("delayUnit")))}return!(!Object(Li.a)(a)||!Object(Be.a)(a,m))||Object(Ri.a)(m,{start:o,end:s})}return!1})).map((function(t){return[t,e]}))})).sortBy((function(e){var t=Object(d.a)(e,2),n=t[0],a=(t[1],n.get("timestamp").toJS()),r=a.startHour;return[r?0:1,r,a.startMinute,a.endHour,a.endMinute,a.month,a.day]}))}}]),t}(s.PureComponent),Hi=n(492),Fi=n(493),Bi=n(220),Ui=function(e){function t(e){var n;return Object(h.a)(this,t),n=Object(m.a)(this,Object(g.a)(t).call(this,e)),X.a.bindAll(Object(f.a)(n),["handleTimeframeTypeChange","handleNextDateClick","handlePreviousDateClick","handleHeaderClick","handleToggleDateDisplayType"]),n.state={selectedDate:new Date,timeframeType:"Week",dateDisplayType:"absolute"},n}return Object(b.a)(t,e),Object(p.a)(t,[{key:"handleTimeframeTypeChange",value:function(e){this.setState({timeframeType:e})}},{key:"handleNextDateClick",value:function(){var e=this.state,t=e.selectedDate;switch(e.timeframeType){case"Day":this.setState({selectedDate:Object(ee.a)(t,1)});break;case"Week":this.setState({selectedDate:Object(te.a)(t,1)});break;case"Month":this.setState({selectedDate:Object(ne.a)(t,1)});break;default:return""}}},{key:"handleHeaderClick",value:function(e){this.props.onClose(),this.props.org.selectHeaderAndOpenParents(e)}},{key:"handlePreviousDateClick",value:function(){var e=this.state,t=e.selectedDate;switch(e.timeframeType){case"Day":this.setState({selectedDate:Object(ie.a)(t,1)});break;case"Week":this.setState({selectedDate:Object(oe.a)(t,1)});break;case"Month":this.setState({selectedDate:Object(se.a)(t,1)});break;default:return""}}},{key:"handleToggleDateDisplayType",value:function(){var e=this.state.dateDisplayType;this.setState({dateDisplayType:"absolute"===e?"relative":"absolute"})}},{key:"calculateTimeframeHeader",value:function(){var e=this.state,t=e.selectedDate;switch(e.timeframeType){case"Day":return Object($.a)(t,"MMMM do");case"Week":var n=Object(Hi.a)(t),a=Object(te.a)(n,1);return"".concat(Object($.a)(n,"MMM do")," - ").concat(Object($.a)(a,"MMM do")," (W").concat(Object($.a)(n,"w"),")");case"Month":return Object($.a)(t,"MMMM");default:return""}}},{key:"render",value:function(){var e=this,t=this.props,n=t.onClose,a=t.headers,r=t.todoKeywordSets,i=t.agendaDefaultDeadlineDelayValue,o=t.agendaDefaultDeadlineDelayUnit,s=this.state,l=s.timeframeType,u=s.selectedDate,d=s.dateDisplayType,h=[];switch(l){case"Day":h=[u];break;case"Week":var p=Object(Hi.a)(u);h=X.a.range(7).map((function(e){return Object(ee.a)(p,e)}));break;case"Month":var m=Object(Fi.a)(u);h=X.a.range(Object(Bi.a)(u)).map((function(e){return Object(ee.a)(m,e)}))}return c.a.createElement(_i,{onClose:n},c.a.createElement("h2",{className:"agenda__title"},"Agenda"),c.a.createElement("div",{className:"agenda__tab-container"},c.a.createElement(Ci,{buttons:["Day","Week","Month"],selectedButton:l,onSelect:this.handleTimeframeTypeChange,useEqualWidthTabs:!0})),c.a.createElement("div",{className:"agenda__timeframe-header-container"},c.a.createElement("i",{className:"fas fa-chevron-left fa-lg",onClick:this.handlePreviousDateClick}),c.a.createElement("div",{className:"agenda__timeframe-header"},this.calculateTimeframeHeader()),c.a.createElement("i",{className:"fas fa-chevron-right fa-lg",onClick:this.handleNextDateClick})),c.a.createElement("div",{className:"agenda__days-container"},h.map((function(t){return c.a.createElement(xi,{key:Object($.a)(t,"yyyy MM dd"),date:t,headers:a,onHeaderClick:e.handleHeaderClick,todoKeywordSets:r,dateDisplayType:d,onToggleDateDisplayType:e.handleToggleDateDisplayType,agendaDefaultDeadlineDelayValue:i,agendaDefaultDeadlineDelayUnit:o})}))),c.a.createElement("br",null))}}]),t}(s.PureComponent),Vi=Object(y.b)((function(e){return{todoKeywordSets:e.org.present.get("todoKeywordSets"),agendaDefaultDeadlineDelayValue:e.base.get("agendaDefaultDeadlineDelayValue")||5,agendaDefaultDeadlineDelayUnit:e.base.get("agendaDefaultDeadlineDelayUnit")||"d"}}),(function(e){return{org:Object(v.b)(r,e)}}))(Ui),Wi=[["Select next header","selectNextVisibleHeader","ctrl+down"],["Select previous header","selectPreviousVisibleHeader","ctrl+up"],["Toggle header opened","toggleHeaderOpened","tab"],["Advance todo state","advanceTodo","alt+t"],["Edit title","editTitle","ctrl+h"],["Edit description","editDescription","ctrl+d"],["Exit edit mode","exitEditMode","alt+enter"],["Add header","addHeader","ctrl+enter"],["Remove header","removeHeader","backspace"],["Move header up","moveHeaderUp","alt+up"],["Move header down","moveHeaderDown","alt+down"],["Move header left","moveHeaderLeft","alt+shift+left"],["Move header right","moveHeaderRight","alt+shift+right"],["Undo","undo","ctrl+/"]],Gi=function(e){return Wi.map((function(t){var n=Object(d.a)(t,3),a=n[0],r=(n[1],n[2]);return[a,e.get(a,r)]}))},Ki=function(e){function t(e){var n;return Object(h.a)(this,t),n=Object(m.a)(this,Object(g.a)(t).call(this,e)),X.a.bindAll(Object(f.a)(n),["handleSelectNextVisibleHeaderHotKey","handleSelectPreviousVisibleHeaderHotKey","handleToggleHeaderOpenedHotKey","handleAdvanceTodoHotKey","handleEditTitleHotKey","handleEditDescriptionHotKey","handleExitEditModeHotKey","handleAddHeaderHotKey","handleRemoveHeaderHotKey","handleMoveHeaderUpHotKey","handleMoveHeaderDownHotKey","handleMoveHeaderLeftHotKey","handleMoveHeaderRightHotKey","handleUndoHotKey","handleContainerRef","handleCapture","handlePopupClose","handleSyncConfirmationPull","handleSyncConfirmationPush","handleSyncConfirmationCancel","handleTagsChange","handlePropertyListItemsChange"]),n.state={hasUncaughtError:!1},n}return Object(b.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.staticFile,n=e.path,a=e.loadedPath;t?(this.props.base.loadStaticFile(t),"changelog"===t&&this.props.base.setHasUnseenChangelog(!1),setTimeout((function(){return document.querySelector("html").scrollTop=0}),0)):X.a.isEmpty(n)||n===a||this.props.syncBackend.downloadFile(n)}},{key:"componentWillUnmount",value:function(){this.props.staticFile?this.props.base.unloadStaticFile():this.props.org.stopDisplayingFile()}},{key:"componentDidUpdate",value:function(){var e=this.props,t=e.headers;e.pendingCapture&&t&&t.size>0&&this.props.org.insertPendingCapture()}},{key:"componentDidCatch",value:function(e){this.setState({hasUncaughtError:!0})}},{key:"handleSelectNextVisibleHeaderHotKey",value:function(){this.props.org.selectNextVisibleHeader()}},{key:"handleSelectPreviousVisibleHeaderHotKey",value:function(){this.props.org.selectPreviousVisibleHeader()}},{key:"handleToggleHeaderOpenedHotKey",value:function(){var e=this.props.selectedHeaderId;e&&this.props.org.toggleHeaderOpened(e)}},{key:"handleAdvanceTodoHotKey",value:function(){this.props.org.advanceTodoState()}},{key:"handleEditTitleHotKey",value:function(){this.props.org.enterEditMode("title")}},{key:"handleEditDescriptionHotKey",value:function(){this.props.org.openHeader(this.props.selectedHeaderId),this.props.org.enterEditMode("description")}},{key:"handleExitEditModeHotKey",value:function(){this.props.org.exitEditMode(),this.container.focus()}},{key:"handleAddHeaderHotKey",value:function(){this.props.org.addHeaderAndEdit(this.props.selectedHeaderId)}},{key:"handleRemoveHeaderHotKey",value:function(){var e=this.props.selectedHeaderId;this.props.org.selectNextSiblingHeader(e),this.props.org.removeHeader(e)}},{key:"handleMoveHeaderUpHotKey",value:function(){this.props.org.moveHeaderUp(this.props.selectedHeaderId)}},{key:"handleMoveHeaderDownHotKey",value:function(){this.props.org.moveHeaderDown(this.props.selectedHeaderId)}},{key:"handleMoveHeaderLeftHotKey",value:function(){this.props.org.moveHeaderLeft(this.props.selectedHeaderId)}},{key:"handleMoveHeaderRightHotKey",value:function(){this.props.org.moveHeaderRight(this.props.selectedHeaderId)}},{key:"handleUndoHotKey",value:function(){this.props.undo.undo()}},{key:"handleContainerRef",value:function(e){this.container=e,this.container&&this.container.focus()}},{key:"handleCapture",value:function(e,t,n){this.props.org.insertCapture(e,t,n)}},{key:"handlePopupClose",value:function(){this.props.base.closePopup()}},{key:"handleSyncConfirmationPull",value:function(){this.props.org.sync({forceAction:"pull"}),this.props.base.closePopup()}},{key:"handleSyncConfirmationPush",value:function(){this.props.org.sync({forceAction:"push"}),this.props.base.closePopup()}},{key:"handleSyncConfirmationCancel",value:function(){this.props.base.closePopup()}},{key:"handleTagsChange",value:function(e){this.props.org.setHeaderTags(this.props.selectedHeaderId,e)}},{key:"handlePropertyListItemsChange",value:function(e){this.props.org.updatePropertyListItems(this.props.activePopupData.get("headerId"),e)}},{key:"handleTimestampChange",value:function(e){var t=this;return e.get("timestampId")?function(n){return t.props.org.updateTimestampWithId(e.get("timestampId"),n)}:void 0!==e.get("logEntryIndex")?function(n){return t.props.org.updateLogEntryTime(e.get("headerId"),e.get("logEntryIndex"),e.get("entryType"),n.get("firstTimestamp"))}:function(n){return t.props.org.updatePlanningItemTimestamp(e.get("headerId"),e.get("planningItemIndex"),n.get("firstTimestamp"))}}},{key:"renderActivePopup",value:function(){var e=this.props,t=e.activePopupType,n=e.activePopupData,a=e.captureTemplates,r=e.headers,i=e.selectedHeader;switch(t){case"sync-confirmation":return c.a.createElement(wi,{lastServerModifiedAt:n.get("lastServerModifiedAt"),onPull:this.handleSyncConfirmationPull,onPush:this.handleSyncConfirmationPush,onCancel:this.handleSyncConfirmationCancel});case"capture":return c.a.createElement(Ti,{template:a.find((function(e){return e.get("id")===n.get("templateId")})),headers:r,onCapture:this.handleCapture,onClose:this.handlePopupClose});case"tags-editor":return i?c.a.createElement(Ii,{header:i,allTags:Object(q.OrderedSet)(r.flatMap((function(e){return e.getIn(["titleLine","tags"])}))).sort(),onClose:this.handlePopupClose,onChange:this.handleTagsChange}):null;case"timestamp-editor":var o=null;return o=n.get("timestampId")?function(e,t){return e.map((function(e){return xe(e.getIn(["titleLine","title"]),t)||xe(e.get("description"),t)||e.get("propertyListItems").map((function(e){return xe(e.get("value"),t)})).filter((function(e){return!!e})).first()})).find((function(e){return!!e}))}(r,n.get("timestampId")):void 0!==n.get("logEntryIndex")?Object(q.fromJS)({firstTimestamp:we(r,n.get("headerId")).getIn(["logBookEntries",n.get("logEntryIndex"),n.get("entryType")])}):Object(q.fromJS)({firstTimestamp:we(r,n.get("headerId")).getIn(["planningItems",n.get("planningItemIndex"),"timestamp"])}),c.a.createElement(Di,{timestamp:o,planningItemIndex:n.get("planningItemIndex"),singleTimestampOnly:!n.get("timestampId"),onClose:this.handlePopupClose,onChange:this.handleTimestampChange(n)});case"property-list-editor":return c.a.createElement(Ai,{onClose:this.handlePopupClose,onChange:this.handlePropertyListItemsChange,propertyListItems:we(r,n.get("headerId")).get("propertyListItems")});case"agenda":return c.a.createElement(Vi,{onClose:this.handlePopupClose,headers:r});default:return null}}},{key:"render",value:function(){var e=this.props,t=e.headers,n=e.shouldDisableDirtyIndicator,a=e.shouldDisableSyncButtons,r=e.shouldDisableActions,i=e.isDirty,o=e.parsingErrorMessage,l=e.path,u=e.staticFile,h=e.customKeybindings,p=e.inEditMode,m=e.orgFileErrorMessage;if(!l&&!u)return c.a.createElement(Or.b,{to:"/files"});if(this.state.hasUncaughtError)return c.a.createElement("div",{className:"error-message-container"},"Uh oh, you ran into a bug!",c.a.createElement("br",null),c.a.createElement("br",null),"This was probably the result of an error in attempting to parse your org file. It'd be super helpful if you could"," ",c.a.createElement("a",{href:"https://github.com/200ok-ch/organice/issues/new",target:"_blank",rel:"noopener noreferrer"},"create an issue")," ","(and include the org file if possible!)");if(m)return c.a.createElement("div",{className:"error-message-container"},m);if(!t)return c.a.createElement("div",null);var g=X.a.fromPairs(function(e){return Wi.map((function(t){var n=Object(d.a)(t,3),a=n[0],r=n[1],i=n[2];return[r,e.get(a,i)]}))}(h)),f=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(n){t&&p||t&&["TEXTAREA","INPUT"].includes(document.activeElement.nodeName)||(n.preventDefault(),e(n))}},b={selectNextVisibleHeader:f(this.handleSelectNextVisibleHeaderHotKey),selectPreviousVisibleHeader:f(this.handleSelectPreviousVisibleHeaderHotKey),toggleHeaderOpened:f(this.handleToggleHeaderOpenedHotKey,!0),advanceTodo:f(this.handleAdvanceTodoHotKey),editTitle:f(this.handleEditTitleHotKey),editDescription:f(this.handleEditDescriptionHotKey),exitEditMode:f(this.handleExitEditModeHotKey),addHeader:f(this.handleAddHeaderHotKey),removeHeader:f(this.handleRemoveHeaderHotKey,!0),moveHeaderUp:f(this.handleMoveHeaderUpHotKey),moveHeaderDown:f(this.handleMoveHeaderDownHotKey),moveHeaderLeft:f(this.handleMoveHeaderLeftHotKey),moveHeaderRight:f(this.handleMoveHeaderRightHotKey),undo:f(this.handleUndoHotKey)};return c.a.createElement(Br.HotKeys,{keyMap:g,handlers:b},c.a.createElement("div",{className:"org-file-container",tabIndex:"-1",ref:this.handleContainerRef},0===t.size?c.a.createElement("div",{className:"org-file__parsing-error-message"},c.a.createElement("h3",null,"Couldn't parse file"),o?c.a.createElement(s.Fragment,null,o):c.a.createElement(s.Fragment,null,"If you think this is a bug, please"," ",c.a.createElement("a",{href:"https://github.com/200ok-ch/organice/issues/new",target:"_blank",rel:"noopener noreferrer"},"create an issue")," ","and include the org file if possible!")):c.a.createElement(li,{shouldDisableActions:r}),i&&!n&&c.a.createElement("div",{className:"dirty-indicator"},"Unpushed changes"),!r&&c.a.createElement(pi,{shouldDisableSyncButtons:a,staticFile:u}),this.renderActivePopup()))}}]),t}(s.PureComponent),zi=Object(y.b)((function(e,t){var n=e.org.present.get("headers"),a=e.org.present.get("selectedHeaderId"),r=e.base.get("activePopup");return{headers:n,selectedHeaderId:a,isDirty:e.org.present.get("isDirty"),loadedPath:e.org.present.get("path"),selectedHeader:n&&n.find((function(e){return e.get("id")===a})),customKeybindings:e.base.get("customKeybindings"),inEditMode:!!e.org.present.get("editMode"),activePopupType:r?r.get("type"):null,activePopupData:r?r.get("data"):null,captureTemplates:e.capture.get("captureTemplates").concat(Fe),pendingCapture:e.org.present.get("pendingCapture"),orgFileErrorMessage:e.org.present.get("orgFileErrorMessage")}}),(function(e){return{base:Object(v.b)(a,e),syncBackend:Object(v.b)(o,e),org:Object(v.b)(r,e),undo:Object(v.b)(_.ActionCreators,e),capture:Object(v.b)(i,e)}}))(Ki),Yi=(n(471),Object(Or.h)(Object(y.b)((function(e,t){return{fontSize:e.base.get("fontSize")||"Regular",bulletStyle:e.base.get("bulletStyle")||"Classic",shouldTapTodoToAdvance:e.base.get("shouldTapTodoToAdvance"),agendaDefaultDeadlineDelayValue:e.base.get("agendaDefaultDeadlineDelayValue")||5,agendaDefaultDeadlineDelayUnit:e.base.get("agendaDefaultDeadlineDelayUnit")||"d",shouldStoreSettingsInSyncBackend:e.base.get("shouldStoreSettingsInSyncBackend"),shouldLiveSync:e.base.get("shouldLiveSync"),shouldSyncOnBecomingVisibile:e.base.get("shouldSyncOnBecomingVisibile"),hasUnseenChangelog:e.base.get("hasUnseenChangelog")}}),(function(e){return{syncBackend:Object(v.b)(o,e),base:Object(v.b)(a,e)}}))((function(e){var t=e.fontSize,n=e.bulletStyle,a=e.shouldTapTodoToAdvance,r=e.shouldStoreSettingsInSyncBackend,i=e.shouldLiveSync,o=e.shouldSyncOnBecomingVisibile,s=e.agendaDefaultDeadlineDelayValue,l=e.agendaDefaultDeadlineDelayUnit,u=e.hasUnseenChangelog,d=e.syncBackend,h=e.base;return c.a.createElement("div",{className:"settings-container"},c.a.createElement("div",{className:"setting-container"},c.a.createElement("div",{className:"setting-label"},"Font size"),c.a.createElement(Ci,{buttons:["Regular","Large"],selectedButton:t,onSelect:function(e){return h.setFontSize(e)}})),c.a.createElement("div",{className:"setting-container"},c.a.createElement("div",{className:"setting-label"},"Bullet style"),c.a.createElement(Ci,{buttons:["Classic","Fancy"],selectedButton:n,onSelect:function(e){return h.setBulletStyle(e)}})),c.a.createElement("div",{className:"setting-container"},c.a.createElement("div",{className:"setting-label"},"Tap TODO to advance state"),c.a.createElement(Ei,{isEnabled:a,onToggle:function(){return h.setShouldTapTodoToAdvance(!a)}})),c.a.createElement("div",{className:"setting-container"},c.a.createElement("div",{className:"setting-label"},"Live sync",c.a.createElement("div",{className:"setting-label__description"},"If enabled, changes are automatically pushed to the sync backend as you make them.")),c.a.createElement(Ei,{isEnabled:i,onToggle:function(){return h.setShouldLiveSync(!i)}})),c.a.createElement("div",{className:"setting-container"},c.a.createElement("div",{className:"setting-label"},"Sync on application becoming visible",c.a.createElement("div",{className:"setting-label__description"},"If enabled, the current org file is pulled from the sync backend when the browser tab becomes visible. This prevents you from having a stale file before starting to make changes to it.")),c.a.createElement(Ei,{isEnabled:o,onToggle:function(){return h.setShouldSyncOnBecomingVisibile(!o)}})),c.a.createElement("div",{className:"setting-container"},c.a.createElement("div",{className:"setting-label"},"Store settings in sync backend",c.a.createElement("div",{className:"setting-label__description"},"Store settings and keyboard shortcuts in a .organice-config.json file in your sync backend to sync between multiple devices.")),c.a.createElement(Ei,{isEnabled:r,onToggle:function(){return h.setShouldStoreSettingsInSyncBackend(!r)}})),c.a.createElement("div",{className:"setting-container setting-container--vertical"},c.a.createElement("div",{className:"setting-label"},"Default DEADLINE warning period"),c.a.createElement("div",{className:"default-deadline-warning-container"},c.a.createElement("input",{type:"number",min:"0",className:"textfield default-deadline-value-textfield",value:s,onChange:function(e){return h.setAgendaDefaultDeadlineDelayValue(e.target.value)}}),c.a.createElement(Ci,{buttons:"hdwmy".split(""),selectedButton:l,onSelect:function(e){return h.setAgendaDefaultDeadlineDelayUnit(e)}}))),c.a.createElement("div",{className:"settings-buttons-container"},c.a.createElement("button",{className:"btn settings-btn",onClick:function(){return h.pushModalPage("capture_templates_editor")}},"Capture templates"),c.a.createElement("button",{className:"btn settings-btn",onClick:function(){return h.pushModalPage("keyboard_shortcuts_editor")}},"Keyboard shortcuts"),c.a.createElement("hr",{className:"settings-button-separator"}),c.a.createElement("button",{className:"btn settings-btn",onClick:function(){return h.pushModalPage("changelog")}},"Changelog",u&&c.a.createElement("div",{className:"changelog-badge-container"},c.a.createElement("i",{className:"fas fa-gift"}))),c.a.createElement("button",{className:"btn settings-btn",onClick:function(){return h.pushModalPage("sample")}},"Help"),c.a.createElement("button",{className:"btn settings-btn"},c.a.createElement("a",{href:"https://github.com/200ok-ch/organice",target:"_blank",rel:"noopener noreferrer"},"Github repo ",c.a.createElement("i",{className:"fas fa-external-link-alt fa-sm"}))),c.a.createElement("hr",{className:"settings-button-separator"}),c.a.createElement("button",{className:"btn settings-btn",onClick:function(){return window.confirm("Are you sure you want to sign out?")?d.signOut():void 0}},"Sign out")))})))),Ji=(n(472),function(e){function t(e){var n;return Object(h.a)(this,t),n=Object(m.a)(this,Object(g.a)(t).call(this,e)),X.a.bindAll(Object(f.a)(n),["handleRebindClick","handleKeyPress"]),n.state={isEditMode:!1},n}return Object(b.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.rebindArea.addEventListener("blur",(function(){return e.setState({isEditMode:!1})}))}},{key:"handleRebindClick",value:function(){this.setState({isEditMode:!0}),document.addEventListener("keypress",this.handleKeyPress)}},{key:"handleKeyPress",value:function(e){this.setState({isEditMode:!1}),document.removeEventListener("keypress",this.handleKeyPress);var t=null;if(t=e.code.startsWith("Key")?e.code.substr(3).toLowerCase():e.code.startsWith("Digit")?e.code.substr(5):{Minus:"-",Equal:"=",Backspace:"backspace",Enter:"enter",Return:"return",Tab:"tab",BracketLeft:"[",BracketRight:"]",Semicolon:";",Quote:'"',Backslash:"\\",Comma:",",Period:".",Slash:"/"}[e.code]){var n=[["ctrlKey","ctrl"],["altKey","alt"],["metaKey","meta"],["shiftKey","shift"]].filter((function(t){var n=Object(d.a)(t,2),a=n[0];n[1];return e[a]})).map((function(e){var t=Object(d.a)(e,2);t[0];return t[1]})).join("+"),a="".concat(n).concat(n?"+":"").concat(t);this.props.onBindingChange(this.props.name,a)}}},{key:"symbolizeKeybinding",value:function(e){if(!e)return"";return[["ctrl","^"],["alt","\u2325"],["option","\u2325"],["command","\u2318"],["meta","\u2318"],["shift","\u21e7"],["backspace","\u232b"],["return","\u23ce"],["enter","\u23ce"],["left","\u2190"],["right","\u2192"],["up","\u2191"],["down","\u2193"]].reduce((function(e,t){var n=Object(d.a)(t,2),a=n[0],r=n[1];return e.replace(RegExp("".concat(a,"\\+?")),r)}),e)}},{key:"render",value:function(){var e=this,t=this.props,n=t.name,a=t.binding,r=this.state.isEditMode,i=Ar()("keyboard-shortcut-container__shortcut-key",{"keyboard-shortcut-container__shortcut-key--edit-mode":r});return c.a.createElement("div",{className:"keyboard-shortcut-container"},c.a.createElement("div",{className:"keyboard-shortcut-container__shortcut-name"},n),c.a.createElement("div",{className:i,onClick:this.handleRebindClick,tabIndex:"-1",ref:function(t){return e.rebindArea=t}},r?"...":this.symbolizeKeybinding(a)))}}]),t}(s.PureComponent)),Xi=(n(473),Object(Or.h)(Object(y.b)((function(e,t){return{customKeybindings:e.base.get("customKeybindings")||Object(q.Map)()}}),(function(e){return{base:Object(v.b)(a,e)}}))((function(e){var t=e.customKeybindings,n=e.base,a=function(e,a){var r=Gi(t).filter((function(e){var t=Object(d.a)(e,2);t[0];return t[1]===a}))[0];r?alert('That binding is already in use for "'.concat(r[0],'"')):n.setCustomKeybinding(e,a)};return c.a.createElement("div",{className:"keyboard-shortcuts-editor-container"},Gi(t).map((function(e){var t=Object(d.a)(e,2),n=t[0],r=t[1];return c.a.createElement(Ji,{key:n,name:n,binding:r,onBindingChange:a})})))})))),qi=(n(474),n(475),function(e){var t=e.template,n=e.index,a=e.onFieldPathUpdate,r=e.onAddNewTemplateOrgFileAvailability,i=e.onRemoveTemplateOrgFileAvailability,o=e.onAddNewTemplateHeaderPath,l=e.onRemoveTemplateHeaderPath,u=e.onDeleteTemplate,h=e.syncBackendType,p=Object(s.useState)(!!t.get("description")),m=Object(d.a)(p,2),g=m[0],f=m[1],b=function(){return f(!g)},y=function(e){return function(n){return a(t.get("id"),[e],n.target.value)}},v=function(){return a(t.get("id"),["isAvailableInAllOrgFiles"],!t.get("isAvailableInAllOrgFiles"))},E=function(){return a(t.get("id"),["shouldPrepend"],!t.get("shouldPrepend"))},_=function(){r(t.get("id"))},T=function(e){return function(){return i(t.get("id"),e)}},k=function(e){return function(n){return a(t.get("id"),["orgFilesWhereAvailable",e],n.target.value)}},w=function(){return o(t.get("id"))},I=function(e){return function(){return l(t.get("id"),e)}},C=function(e){return function(n){return a(t.get("id"),["headerPaths",e],n.target.value)}},S=function(){window.confirm('Are you sure you want to delete the "'.concat(t.get("description"),'" template?'))&&u(t.get("id"))},O=Ar()("fas fa-2x fa-caret-right capture-template-container__header__caret",{"capture-template-container__header__caret--rotated":!g});return c.a.createElement(gr.b,{draggableId:"capture-template--".concat(t.get("id")),index:n},(function(e,n){return c.a.createElement("div",Object.assign({className:Ar()("capture-template-container",{"capture-template-container--dragging":n.isDragging}),ref:e.innerRef},e.draggableProps),c.a.createElement("div",{className:"capture-template-container__header",onClick:b},c.a.createElement("i",{className:O}),c.a.createElement(hi,{iconName:t.get("iconName"),letter:t.get("letter"),onClick:function(){},style:{marginRight:20}}),c.a.createElement("span",{className:"capture-template-container__header__title"},t.get("description")),c.a.createElement("i",Object.assign({className:"fas fa-bars fa-lg capture-template-container__header__drag-handle"},e.dragHandleProps))),c.a.createElement(Vr.UnmountClosed,{isOpened:!g,springConfig:{stiffness:300}},c.a.createElement("div",{className:"capture-template-container__content"},function(e){return c.a.createElement("div",{className:"capture-template__field-container"},c.a.createElement("div",{className:"capture-template__field"},c.a.createElement("div",null,"Description:"),c.a.createElement("input",{type:"text",className:"textfield",value:e.get("description",""),onChange:y("description")})))}(t),function(e){return c.a.createElement("div",{className:"capture-template__field-container"},c.a.createElement("div",{className:"capture-template__field"},c.a.createElement("div",null,"Letter:"),c.a.createElement("input",{type:"text",className:"textfield capture-template__letter-textfield",maxLength:"1",value:e.get("letter",""),onChange:y("letter"),autoCapitalize:"none"})),c.a.createElement("div",{className:"capture-template__field__or-container"},c.a.createElement("div",{className:"capture-template__field__or-line"}),c.a.createElement("div",{className:"capture-template__field__or"},"or"),c.a.createElement("div",{className:"capture-template__field__or-line"})),c.a.createElement("div",{className:"capture-template__field"},c.a.createElement("div",null,"Icon name:"),c.a.createElement("input",{type:"text",className:"textfield",value:e.get("iconName"),onChange:y("iconName"),autoCapitalize:"none",autoCorrect:"none"})),c.a.createElement("div",{className:"capture-template__help-text"},"Instead of a letter, you can specify the name of any free Font Awesome icon (like lemon or calendar-plus) to use as the capture icon. You can search the available icons"," ",c.a.createElement("a",{href:"https://fontawesome.com/icons?d=gallery&s=solid&m=free",target:"_blank",rel:"noopener noreferrer"},"here"),"."))}(t),function(e){return c.a.createElement("div",{className:"capture-template__field-container"},c.a.createElement("div",{className:"capture-template__field"},c.a.createElement("div",null,"Available in all org files?"),c.a.createElement(Ei,{isEnabled:e.get("isAvailableInAllOrgFiles"),onToggle:v})),c.a.createElement("div",{className:"capture-template__help-text"},"You can make this capture template available in all org files, or just the ones you specify.","Dropbox"===h&&c.a.createElement(s.Fragment,null," ","Specify full paths starting from the root of your Dropbox, like"," ",c.a.createElement("code",null,"/org/todo.org")),"Google Drive"===h&&c.a.createElement(s.Fragment,null," ","Specify the file id of each file. You can find the file id in the URL of the file in organice (e.g.,"," ",c.a.createElement("code",null,"/file/","<file id>"),").")),c.a.createElement(Vr.UnmountClosed,{isOpened:!e.get("isAvailableInAllOrgFiles"),springConfig:{stiffness:300}},c.a.createElement("div",{className:"multi-textfields-container"},e.get("orgFilesWhereAvailable").map((function(e,t){return c.a.createElement("div",{key:"org-file-availability-".concat(t),className:"multi-textfield-container"},c.a.createElement("input",{type:"text",placeholder:"e.g., /org/todo.org",className:"textfield multi-textfield-field",value:e,onChange:k(t)}),c.a.createElement("button",{className:"fas fa-times fa-lg remove-multi-textfield-button",onClick:T(t)}))}))),c.a.createElement("div",{className:"add-new-multi-textfield-button-container"},c.a.createElement("button",{className:"fas fa-plus add-new-multi-textfield-button",onClick:_}))))}(t),function(e){return c.a.createElement("div",{className:"capture-template__field-container"},c.a.createElement("div",{className:"capture-template__field",style:{marginTop:7}},c.a.createElement("div",null,"Header path")),c.a.createElement("div",{className:"capture-template__help-text"},"Specify the path to the header under which the new header should be filed. One header per textfield."),c.a.createElement("div",{className:"multi-textfields-container"},e.get("headerPaths").map((function(e,t){return c.a.createElement("div",{key:"header-path-".concat(t),className:"multi-textfield-container"},c.a.createElement("input",{type:"text",placeholder:"e.g., Todos",className:"textfield multi-textfield-field",value:e,onChange:C(t)}),c.a.createElement("button",{className:"fas fa-times fa-lg remove-multi-textfield-button",onClick:I(t)}))}))),c.a.createElement("div",{className:"add-new-multi-textfield-button-container"},c.a.createElement("button",{className:"fas fa-plus add-new-multi-textfield-button",onClick:w})))}(t),function(e){return c.a.createElement("div",{className:"capture-template__field-container"},c.a.createElement("div",{className:"capture-template__field"},c.a.createElement("div",null,"Prepend?"),c.a.createElement(Ei,{isEnabled:e.get("shouldPrepend"),onToggle:E})),c.a.createElement("div",{className:"capture-template__help-text"},"By default, new captured headers are appended to the specified header path. Enable this setting to prepend them instead."))}(t),function(e){return c.a.createElement("div",{className:"capture-template__field-container"},c.a.createElement("div",{className:"capture-template__field",style:{marginTop:7}},c.a.createElement("div",null,"Template")),c.a.createElement("textarea",{className:"textarea template-textarea",rows:"3",value:e.get("template"),onChange:y("template")}),c.a.createElement("div",{className:"capture-template__help-text"},"The template for creating the capture item. You can use the following template variables that will be expanded upon capture:",c.a.createElement("ul",null,c.a.createElement("li",null,c.a.createElement("code",null,"%?")," - Place the cursor here."),c.a.createElement("li",null,c.a.createElement("code",null,"%t")," - Timestamp, date only."),c.a.createElement("li",null,c.a.createElement("code",null,"%T")," - Timestamp, with date and time."),c.a.createElement("li",null,c.a.createElement("code",null,"%u")," - Inactive timestamp, date only."),c.a.createElement("li",null,c.a.createElement("code",null,"%U")," - Inactive timestamp, with date and time."),c.a.createElement("li",null,c.a.createElement("code",null,"%","<custom variable>")," - A custom variable from a URL param capture. See"," ",c.a.createElement("a",{href:"https://github.com/200ok-ch/organice/#capture-params-and-siri-support"},"the README file")," ","for more details."))))}(t),c.a.createElement("div",{className:"capture-template__field-container capture-template__delete-button-container"},c.a.createElement("button",{className:"btn settings-btn capture-template__delete-button",onClick:S},"Delete template")))))}))}),$i=Object(y.b)((function(e,t){return{captureTemplates:e.capture.get("captureTemplates",new q.List),syncBackendType:e.syncBackend.get("client").type}}),(function(e){return{capture:Object(v.b)(i,e)}}))((function(e){var t=e.captureTemplates,n=e.syncBackendType,a=e.capture,r=function(e,t,n){return a.updateTemplateFieldPathValue(e,t,n)},i=function(e){return a.addNewTemplateOrgFileAvailability(e)},o=function(e,t){return a.removeTemplateOrgFileAvailability(e,t)},l=function(e){return a.addNewTemplateHeaderPath(e)},u=function(e,t){return a.removeTemplateHeaderPath(e,t)},d=function(e){return a.deleteTemplate(e)},h=function(e,t){return a.reorderCaptureTemplate(e,t)};return c.a.createElement("div",null,c.a.createElement(gr.c,{droppableId:"capture-templates-editor-droppable",type:"CAPTURE-TEMPLATE"},(function(e,a){return c.a.createElement("div",Object.assign({className:"capture-templates-container",ref:e.innerRef},e.droppableProps),0===t.size?c.a.createElement("div",{className:"no-capture-templates-message"},"You don't currently have any capture templates - add one by pressing the"," ",c.a.createElement("i",{className:"fas fa-plus"})," button.",c.a.createElement("br",null),c.a.createElement("br",null),"Capture templates show up in the action drawer and give you quick access to creating new headers (like org-capture)."):c.a.createElement(s.Fragment,null,t.map((function(e,t){return c.a.createElement(qi,{key:e.get("id"),index:t,template:e,syncBackendType:n,onFieldPathUpdate:r,onAddNewTemplateOrgFileAvailability:i,onRemoveTemplateOrgFileAvailability:o,onAddNewTemplateHeaderPath:l,onRemoveTemplateHeaderPath:u,onDeleteTemplate:d,onReorder:h})})),e.placeholder))})),c.a.createElement("div",{className:"new-capture-template-button-container"},c.a.createElement("button",{className:"fas fa-plus fa-lg btn btn--circle",onClick:function(){return a.addNewEmptyCaptureTemplate()}})))})),Qi=(n(476),n(229)),Zi=n.n(Qi),eo=n(230),to=n.n(eo);function no(){var e=Object(s.useState)(!1),t=Object(d.a)(e,2),n=t[0],a=t[1],r=Object(s.useState)(""),i=Object(d.a)(r,2),o=i[0],l=i[1],u=Object(s.useState)(""),h=Object(d.a)(u,2),p=h[0],m=h[1],g=Object(s.useState)(""),f=Object(d.a)(g,2),b=f[0],y=f[1];return n?c.a.createElement("div",{id:"webdavLogin"},c.a.createElement("h2",null,"WebDAV"),c.a.createElement("form",{onSubmit:function(e){e.preventDefault(),dn("authenticatedSyncService","WebDAV"),dn("webdavEndpoint",o),dn("webdavUsername",p),dn("webdavPassword",b),window.location=window.location.origin+"/"}},c.a.createElement("p",null,c.a.createElement("label",null,"Url:"),c.a.createElement("input",{type:"url",value:o,className:"textfield",onChange:function(e){l(e.target.value)}})),c.a.createElement("p",null,c.a.createElement("label",null,"Username:"),c.a.createElement("input",{type:"text",className:"textfield",value:p,onChange:function(e){m(e.target.value)}})),c.a.createElement("p",null,c.a.createElement("label",null,"Password:"),c.a.createElement("input",{type:"password",className:"textfield",value:b,onChange:function(e){y(e.target.value)}})),c.a.createElement("input",{type:"submit",value:"Sign-in"}))):c.a.createElement("div",{id:"webdavLogin",onClick:function(){a(!0)}},c.a.createElement("h2",null,"WebDAV"))}var ao=function(e){function t(e){var n;return Object(h.a)(this,t),n=Object(m.a)(this,Object(g.a)(t).call(this,e)),X.a.bindAll(Object(f.a)(n),["handleDropboxClick","handleGoogleDriveClick"]),n}return Object(b.a)(t,e),Object(p.a)(t,[{key:"handleDropboxClick",value:function(){dn("authenticatedSyncService","Dropbox");var e=new kr.Dropbox({clientId:Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_DROPBOX_CLIENT_ID,fetch:fetch}).getAuthenticationUrl(window.location.origin+"/");window.location=e}},{key:"handleGoogleDriveClick",value:function(){try{gapi.load("client:auth2",(function(){gapi.client.init({apiKey:Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_GOOGLE_DRIVE_API_KEY,clientId:Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_GOOGLE_DRIVE_CLIENT_ID,discoveryDocs:["https://www.googleapis.com/discovery/v1/apis/drive/v3/rest"],scope:"https://www.googleapis.com/auth/drive"}).then((function(){dn("authenticatedSyncService","Google Drive"),gapi.auth2.getAuthInstance().signIn({ux_mode:"redirect",redirect_uri:window.location.origin})}))}))}catch(e){return void alert("The Google Drive API client isn't available - you might be blocking it with an ad blocker")}}},{key:"render",value:function(){return c.a.createElement("div",{className:"sync-service-sign-in-container"},c.a.createElement("p",{className:"sync-service-sign-in__help-text"},"organice syncs your files with Dropbox, Google Drive and WebDAV."),c.a.createElement("p",{className:"sync-service-sign-in__help-text"},"Click to sign in with:"),c.a.createElement("div",{className:"sync-service-container",onClick:this.handleDropboxClick},c.a.createElement("img",{src:Zi.a,alt:"Dropbox logo",className:"dropbox-logo"})),c.a.createElement("div",{className:"sync-service-container",onClick:this.handleGoogleDriveClick},c.a.createElement("img",{src:to.a,alt:"Google Drive logo",className:"google-drive-logo"})),c.a.createElement("div",{className:"sync-service-container"},c.a.createElement(no,null)))}}]),t}(s.PureComponent),ro=function(e){function t(e){var n;return Object(h.a)(this,t),n=Object(m.a)(this,Object(g.a)(t).call(this,e)),X.a.bindAll(Object(f.a)(n),["renderChangelogFile","renderSampleFile","renderFileBrowser","renderFile"]),n}return Object(b.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.lastSeenChangelogHeader,n=e.isAuthenticated,a=Jn("* Changelog\n\nAll notable changes to this project will be documented in this file.\n\n** <2019-12-17 Tue>\n*** Changed\n    - Improve webdav url input\n      - Thank you [[https://github.com/dotcs][dotcs]] for your [[https://github.com/200ok-ch/organice/pull/139][PR]]!\n*** Fixed\n    - Make \"privacy policy\" sticky to the bottom of the landing page\n      - Thank you [[https://github.com/dotcs][dotcs]] for your [[https://github.com/200ok-ch/organice/pull/140][PR]]!\n\n** <2019-12-15 Sun>\n\n*** Changed\n    - UX: Move Org header actions before selected headline\n    - Thank you [[https://github.com/dotcs][dotcs]] for your [[https://github.com/200ok-ch/organice/pull/136][PR]]!\n\n*** Fixed\n    - Android PWA implementation was broken (issue [[https://github.com/200ok-ch/organice/issues/134][#134]])\n      - It required two more icon sizes\n    - Thank you [[https://github.com/dotcs][dotcs]] for your [[https://github.com/200ok-ch/organice/pull/135][PR]]!\n\n** <2019-12-10 Tue>\n\n*** Added\n\n    - *Docker Support*\n    - The CI/CD workflow now also builds a Docker container which is\n      then published to\n      https://hub.docker.com/repository/docker/twohundredok/organice\n    - Thank you [[https://github.com/dotcs][dotcs]] for your [[https://github.com/200ok-ch/organice/pull/133][PR]]!\n\n** <2019-12-08 Sun>\n\n*** Added\n\n    - As a user, when I'm on a headline with a planning item (schedule\n      or deadline), I want to be able to remove it.\n\n** <2019-11-29 Fri>\n\n*** Fixed\n\n    - Clicking the Timestamp in a TODO within the agenda toggles from\n      the date to a human readable timespan\n\n** <2019-11-27 Wed>\n\n*** Added\n\n    - Instructions on configuring Nextcloud+haproxy to allow WebDAV\n    - Documentation on how to share from Nextcloud using WebDAV\n    - Thank you [[https://github.com/runejuhl][runejuhl]] for your [[https://github.com/200ok-ch/organice/pull/122][PR]]!\n\n** <2019-11-25 Mon>\n\n*** Added\n    - Honor the 'nologrepeat' option\n      - It can be set via =#+STARTUP:= or as a property\n      - Thank you [[https://github.com/jamesnvc][@jamesnvc]] for your [[https://github.com/200ok-ch/organice/pull/119][PR]]!\n\n** <2019-11-22 Fri>\n\n*** Fixed\n\n    - Handle non-clock entries in =:LOGBOOK:= drawers\n      - Fixes [[https://github.com/200ok-ch/organice/issues/111][issue #111]], [[https://github.com/200ok-ch/organice/issues/108][issue #108]] and [[https://github.com/200ok-ch/organice/issues/110][issue #110]]\n      - Thank you [[https://github.com/jamesnvc][@jamesnvc]] for your [[https://github.com/200ok-ch/organice/pull/112][PR]]!\n\n** <2019-11-21 Thu>\n\n*** Fixed\n\n    - Safeguard against potential Dropbox SDK Bug\n      - More information in [[https://github.com/200ok-ch/organice/issues/108][issue #108]]\n\n** <2019-11-19 Tue>\n\n*** Changed\n\n    - Don't put newlines after headers with no content, add newline at EOF\n      - Thank you [[https://github.com/jamesnvc][@jamesnvc]] for your [[https://github.com/200ok-ch/organice/pull/106][PR]]!\n\n** <2019-11-14 Thu>\n\n*** Added\n\n    - *Clocking work time*\n      - Org mode allows you to clock the time you spend on specific\n        tasks in a project:\n        https://orgmode.org/manual/Clocking-Work-Time.html#Clocking-Work-Time\n      - organice is compatible with logbook clocking, now\n      - You can 'clock in' and 'clock out' to a header\n      - Thank you [[https://github.com/jamesnvc][@jamesnvc]] for your [[https://github.com/200ok-ch/organice/pull/103][PR]]!\n\n** <2019-10-31 Thu>\n\n*** Fixed\n    - Keep all in-file settings and content lines from top of file\n      - Thank you [[https://github.com/andersjohansson][@andersjohansson]] for your [[https://github.com/200ok-ch/organice/pull/90][PR]]!\n\n** <2019-10-29 Tue>\n\n*** Added\n    - Show login options as clickable links with cursor pointer\n    - Also improve wording with regards to login options\n      - Thank you [[https://github.com/rodrigomaia17][@rodrigomaia17]] for your [[https://github.com/200ok-ch/organice/pull/88][PR]]!\n\n\n** <2019-10-26 Sat>\n\n*** Added\n    - *WebDAV as a sync backend!*\n      - Thank you [[https://github.com/TristanCacqueray][@TristanCacqueray]] for your [[https://github.com/200ok-ch/organice/pull/82][PR]]!\n\n    - As a user, when I swipe a header, I want the icon to contrast\n      the background, so that better see the action taken\n      - Thank you [[https://github.com/ragone][@ragone]] for your [[https://github.com/200ok-ch/organice/pull/78][PR]]!\n\n    - As a user, when I hover a clickable element, I want my cursor to\n    change, so that I can see that it is clickable.\n      - Thank you [[https://github.com/ragone][@ragone]] for your [[https://github.com/200ok-ch/organice/pull/79][PR]]!\n\n*** Fixed\n    - Do not throw an error when clearing a planning item\n      - Thank you [[https://github.com/ragone][@ragone]] for your [[https://github.com/200ok-ch/organice/pull/81][PR]]!\n\n** <2019-10-02 Wed>\n\n*** Fixed\n\n- On iOS 13, fix the regression which made capture input fields hide\n  under the keyboard\n  - More information and screenshots in the ticket: https://github.com/200ok-ch/organice/issues/46\n  - Turns out this issue is non trivial to fix and requires specific\n    rules for every size of iPhone. I tested against the Xs and 6s. If\n    you have a different form factor and the capture template input\n    screen looks off to you, please send me a screenshot of what it\n    looks like and I'll add the dimensions for your form factor right\n    away!\n\n** <2019-09-28 Sat>\n\n*** Added\n\n- Implemented a =redo= Button next to the =undo= button\n\n** <2019-09-21 Sat>\n\n*** Fixed\n\n- Parser bug which would interpret *bold* statements in the beginning\n  of a line as a header.\n- Parser bug which would delete newlines between headers and items\n\n*** Changed\n\n- @MTrost [[https://github.com/200ok-ch/organice/pull/45][introduced]] a new testing library called [[https://testing-library.com/docs/intro][React Testing\n  Library]] which greatly simplified writing interaction tests.\n\n** <2019-09-19 Thu>\n\n*** Changed\n\n- Constraining to a max width and centering for tablets and bigger\n\n** <2019-09-15 Sun>\n\n*** Fixed\n\n- The 'Sync on application becoming visible' feature works on iOS and\n  Safari\n  - If enabled, the current org file is pulled from the sync backend\n    when the browser tab becomes visible. This prevents you from\n    having a stale file before starting to make changes to it.\n\n** <2019-09-08 Sun>\n*** Added\n\n- Documented how to use organice from a bookmarklet using the capture\n  template feature\n\n** <2019-09-06 Fri>\n*** Fixed\n\n- Removed Google Analytics tracking, because it has no place here\n\n** <2019-09-02 Mon>\n\n*** Added\n\n- Configure Google Drive for the free community version of organice at\n  https://organice.200ok.ch\n- Documented SPA routing for self-hosting\n- Wrote and publicized a Privacy Policy\n\n** <2019-08-27 Tue>\n\n*** Changed\n\n- Color scheme has been ported to the popular [[https://ethanschoonover.com/solarized/][Solarized]] (light mode)\n  - Whilst doing so, CSS variables have been introduced, so that\n    there's not a whole lot of repetition of magic rgb values going on\n  - The logo has been adapted, too\n- The landing page and settings screens have been de-cluttered\n\n** <2019-08-26 Mon>\n\n*** Added\n\n- Continuous deployment: Merging to =master= triggers a build on CI\n  and when successful, it triggers a deploy to https://org.200ok.ch\n- Add a new temporary\u2122 logo: [[file:public/organice.png][organice.png]]\n\n** <2019-08-25 Sun>\n\n*** Added\n\n- Since we want organice to be a community driven project, we have added:\n  - [[file:CODE_OF_CONDUCT.org][Code of conduct]]\n  - [[file:CONTRIBUTING.org][Contributing guidelines]]\n\n- Add [[https://circleci.com/][CircleCI]] to run the tests on every commit\n  - They are also integrated as a check for PRs with the benefit that\n    contributors get automated feedback by running the regression test\n    suite.\n\n- Add [[https://greenkeeper.io][Greenkeeper]] for automated dependency management\n\n- Add [[https://codeclimate.com][Codeclimate]] for automated maintainability analysis\n\n*** Changed\n\n- Upgraded to Node 12.9\n\n** <2019-08-12 Mon>\n\n*** Changed\n\n- The default keybindings (when used from a desktop browser) are now\n  more in line with the defaults in Emacs itself\n\n*** Fixed\n\n- The keybindings work on non-macOS operating systems\n\n** <2019-08-10 Sat>\n\n*** Added\n\n- As a user, when in a directory listing, I want the folders and files\n  to be sorted alphabetically. Furthermore, I only want to see files\n  that organice can open (that is org and org archive files).\n- Note: This is only implemented for the Dropbox back-end at this time.\n\n*** Changed\n\n- Filters files from a directory listing down to org files.\n- Sorts folders atop of files.\n- Sorts both folders and files alphabetically.\n\n\n** <2019-08-05 Mon>\n\n*** Added\n\n- When the browser tab becomes visible, pull the latest version of the\n  Org file\n  - This is rather helpful when the app is used in production. Since\n    the production build supports loading the complete application and\n    org-file from cache, it can be open for a very long time. When the\n    org-file hasn't been pulled in a \"very long time\"\u2122, then chances\n    are non-nil that the file has been changed by another client in\n    the meantime.\n  - Without this change, when the user opens the app after a while,\n    makes changes to the file and wants to sync to the back-end, there\n    might be the message \"Since you last pulled, a newer version of\n    the file has been pushed to the server.\". Now the user has two\n    conflicting versions of the same file and can only chose to keep\n    one (Which in itself is great UX and great error handling for\n    cases in which we do encounter a merge conflict, of course!).\n  - This situation is mitigated with this change. Now the user has the\n    option to enable \"Sync on application becoming visible\" which acts\n    similarly to \"Live Sync\". When the user opts to use this feature,\n    whenever the application get's pulled from the background or\n    started through the service worker, the first thing that happens\n    it that a new version of the org-file is pulled from the server.\n    It's therefore much harder for the user to create conflicts.\n\n** <2019-08-04 Sun>\n\n*** Fixed\n\n- Parser doesn't break indentation of existing files in fewer places\n- Planning Items are formatted as in Emacs Org mode\n- Properties are formatted as in Emacs Org mode\n- Tags are formatted as in Emacs Org mode\n\n\n** <2019-08-03 Sat>\n\n*** Added\n\n- Documented deployment options\n  - People have been asking for tighter access restrictions.\n  - Imo the best answer to that request is to make it as easy as\n    possible to host organice.\n  - There's myriads of good options, of course. I picked to document\n    two that will (potentially) be cost-free to the users and which\n    are very easy and quick to set up: Ftp and Heroku.\n\n*** Fixed\n\n- Tests on =master= were red\n  - Partly due to obsolete tests\n  - Partly because tests weren't updated according to changes in the code\n").getIn(["headers",0,"titleLine","rawTitle"]);n&&t&&a!==t&&this.props.base.setHasUnseenChangelog(!0),this.props.base.setLastSeenChangelogHeader(a)}},{key:"componentDidUpdate",value:function(){this.shouldPromptWhenLeaving()?window.onbeforeunload=function(){return!0}:window.onbeforeunload=void 0}},{key:"componentWillUnmount",value:function(){window.onbeforeunload=void 0}},{key:"renderChangelogFile",value:function(){return c.a.createElement(zi,{staticFile:"changelog",shouldDisableDirtyIndicator:!0,shouldDisableActions:!0,shouldDisableSyncButtons:!1,parsingErrorMessage:"The contents of changelog.org couldn't be loaded. You probably forgot to set the environment variable - see the Development section of README.org for details!"})}},{key:"renderSampleFile",value:function(){return c.a.createElement(zi,{staticFile:"sample",shouldDisableDirtyIndicator:!0,shouldDisableActionDrawer:!1,shouldDisableSyncButtons:!0,parsingErrorMessage:"The contents of sample.org couldn't be loaded. You probably forgot to set the environment variable - see the Development section of README.org for details!"})}},{key:"renderFileBrowser",value:function(e){var t=e.match.params.path,n=void 0===t?"":t;return n&&(n="/"+n),c.a.createElement(xr,{path:n})}},{key:"renderFile",value:function(e){var t=e.match.params.path;return t&&(t="/"+t),c.a.createElement(zi,{path:t,shouldDisableDirtyIndicator:!1,shouldDisableActionDrawer:!1,shouldDisableSyncButtons:!1})}},{key:"shouldPromptWhenLeaving",value:function(){return this.props.location.pathname.startsWith("/file/")&&this.props.isDirty}},{key:"render",value:function(){var e=this.props,t=e.isAuthenticated,n=e.loadingMessage,a=e.fontSize,r=e.activeModalPage,i=e.pendingCapture,o=e.location.pathname,l=!!i&&"/file".concat(i.get("capturePath")),u=l&&l!==o,d=Ar()("entry-container",{"entry-container--large-font":"Large"===a});return c.a.createElement("div",{className:d},c.a.createElement(Mr,null),c.a.createElement(Fr,{message:n}),c.a.createElement(Or.a,{when:this.shouldPromptWhenLeaving(),message:function(){return"You have unpushed changes - are you sure you want to leave this page?"}}),"changelog"===r?this.renderChangelogFile():t?["keyboard_shortcuts_editor","settings","capture_templates_editor","sample"].includes(r)?c.a.createElement(s.Fragment,null,"settings"===r&&c.a.createElement(Yi,null),"keyboard_shortcuts_editor"===r&&c.a.createElement(Xi,null),"capture_templates_editor"===r&&c.a.createElement($i,null),"sample"===r&&this.renderSampleFile()):c.a.createElement(Or.e,null,u&&c.a.createElement(Or.b,{to:l}),c.a.createElement(Or.c,{path:"/privacy-policy",exact:!0,component:Nr}),c.a.createElement(Or.c,{path:"/file/:path+",render:this.renderFile}),c.a.createElement(Or.c,{path:"/files/:path*",render:this.renderFileBrowser}),c.a.createElement(Or.b,{to:"/files"})):c.a.createElement(Or.e,null,c.a.createElement(Or.c,{path:"/privacy-policy",exact:!0,component:Nr}),c.a.createElement(Or.c,{path:"/sample",exact:!0,render:this.renderSampleFile}),c.a.createElement(Or.c,{path:"/sign_in",exact:!0,component:ao}),c.a.createElement(Or.c,{path:"/",exact:!0,component:Rr}),c.a.createElement(Or.b,{to:"/"})))}}]),t}(s.PureComponent),io=Object(Or.h)(Object(y.b)((function(e,t){return{loadingMessage:e.base.get("loadingMessage"),isAuthenticated:e.syncBackend.get("isAuthenticated"),fontSize:e.base.get("fontSize"),lastSeenChangelogHeader:e.base.get("lastSeenChangelogHeader"),activeModalPage:e.base.get("modalPageStack",Object(q.List)()).last(),pendingCapture:e.org.present.get("pendingCapture"),isDirty:e.org.present.get("isDirty")}}),(function(e){return{syncBackend:Object(v.b)(o,e),org:Object(v.b)(r,e),base:Object(v.b)(a,e)}}))(ro)),oo=function(e){function t(e){var n;Object(h.a)(this,t),n=Object(m.a)(this,Object(g.a)(t).call(this,e)),hr();var a=cn();window.initialHash=window.location.hash.substring(0);var r=pr(window.location.hash),i=hn("authenticatedSyncService",!0),o=null;if(i)switch(i){case"Dropbox":var s=r.access_token;if(s)o=wr(s),a.syncBackend=Object(q.Map)({isAuthenticated:!0,client:o}),dn("dropboxAccessToken",s),window.location.hash="";else{var c=hn("dropboxAccessToken",!0);c&&(o=wr(c),a.syncBackend=Object(q.Map)({isAuthenticated:!0,client:o}))}break;case"Google Drive":o=Ir(),a.syncBackend=Object(q.Map)({isAuthenticated:!0,client:o});break;case"WebDAV":o=Sr(hn("webdavEndpoint"),hn("webdavUsername"),hn("webdavPassword")),a.syncBackend=Object(q.Map)({isAuthenticated:!0,client:o})}var l=pr(window.location.search),u=l.captureFile,p=l.captureTemplateName,b=l.captureContent;if(u&&p){var y=u.startsWith("/")?u:"/".concat(u),v=Object(q.Map)(Object.entries(l).map((function(e){var t=Object(d.a)(e,2),n=t[0],a=t[1];return n.startsWith("captureVariable_")?[n.substring("captureVariable_".length),a]:null})).filter((function(e){return!!e})));a.org.present=a.org.present.set("pendingCapture",Object(q.Map)({capturePath:y,captureTemplateName:p,captureContent:b,customCaptureVariables:v}))}return n.store=dr(a),n.store.subscribe(un(n.store)),o?o.isSignedIn().then((function(e){e?ln(n.store.dispatch,n.store.getState):n.store.dispatch(fr())})):n.store.getState().org.present.get("pendingCapture")&&n.store.dispatch(C("You need to sign in before you can use capture templates",5e3)),X.a.bindAll(Object(f.a)(n),["handleDragEnd"]),n}return Object(b.a)(t,e),Object(p.a)(t,[{key:"handleDragEnd",value:function(e){e.destination&&("CAPTURE-TEMPLATE"===e.type?this.store.dispatch(tn(e.source.index,e.destination.index)):"TAG"===e.type?this.store.dispatch(Lt(e.source.index,e.destination.index)):"PROPERTY-LIST"===e.type&&this.store.dispatch(jt(e.source.index,e.destination.index)))}},{key:"render",value:function(){return c.a.createElement(gr.a,{onDragEnd:this.handleDragEnd},c.a.createElement(mr.a,null,c.a.createElement(y.a,{store:this.store},c.a.createElement("div",{className:"App"},c.a.createElement(io,null)))))}}]),t}(s.PureComponent),so=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function co(e){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}})).catch((function(e){console.error("Error during service worker registration:",e)}))}u.a.render(c.a.createElement(oo,null),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("",window.location).origin!==window.location.origin)return;window.addEventListener("load",(function(){var e="".concat("","/service-worker.js");so?(!function(e){fetch(e).then((function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):co(e)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")}))):co(e)}))}}()},98:function(e,t,n){e.exports=n.p+"static/media/organice.11553f69.svg"}},[[232,1,2]]]);
//# sourceMappingURL=main.b25501c7.chunk.js.map